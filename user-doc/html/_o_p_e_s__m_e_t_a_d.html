<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: OPES_METAD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_o_p_e_s__m_e_t_a_d.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">OPES_METAD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the opes <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=opes . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>On-the-fly probability enhanced sampling with metadynamics-like target distribution.</p>
<p>This On-the-fly probability enhanced sampling (<a class="el" href="_o_p_e_s.html">OPES</a>) method with metadynamics-like target distribution is described in <a class="el" href="citelist.html#CITEREF_Invernizzi2020rethinking">[58]</a>.</p>
<p>This <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> action samples target distributions defined via their marginal \(p^{\text{tg}}(\mathbf{s})\) over some collective variables (CVs), \(\mathbf{s}=\mathbf{s}(\mathbf{x})\). By default <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> targets the well-tempered distribution, \(p^{\text{WT}}(\mathbf{s})\propto [P(\mathbf{s})]^{1/\gamma}\), where \(\gamma\) is known as BIASFACTOR. Similarly to <a class="el" href="_m_e_t_a_d.html">METAD</a>, <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> optimizes the bias on-the-fly, with a given PACE. It does so by reweighting via kernel density estimation the unbiased distribution in the CV space, \(P(\mathbf{s})\). A compression algorithm is used to prevent the number of kernels from growing linearly with the simulation time. The bias at step \(n\) is </p><p class="formulaDsp">
\[ V_n(\mathbf{s}) = (1-1/\gamma)\frac{1}{\beta}\log\left(\frac{P_n(\mathbf{s})}{Z_n}+\epsilon\right)\, . \]
</p>
<p> See Ref.<a class="el" href="citelist.html#CITEREF_Invernizzi2020rethinking">[58]</a> for a complete description of the method.</p>
<p>As an intuitive picture, rather than gradually filling the metastable basins, <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> quickly tries to get a coarse idea of the full free energy surface (FES), and then slowly refines its details. It has a fast initial exploration phase, and then becomes extremely conservative and does not significantly change the shape of the deposited bias any more, reaching a regime of quasi-static bias. For this reason, it is possible to use standard umbrella sampling reweighting (see <a class="el" href="_r_e_w_e_i_g_h_t__b_i_a_s.html">REWEIGHT_BIAS</a>) to analyse the trajectory. At <a href="https://github.com/invemichele/opes/tree/master/postprocessing">this link</a> you can find some python scripts that work in a similar way to <a class="el" href="sum_hills.html">sum_hills</a>, but the preferred way to obtain a FES with OPES is via reweighting (see opes-metad). The estimated \(c(t)\) is printed for reference only, since it should converge to a fixed value as the bias converges. This \(c(t)\) should NOT be used for reweighting. Similarly, the \(Z_n\) factor is printed only for reference, and it should converge when no new region of the CV-space is explored.</p>
<p>Notice that <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> is more sensitive to degenerate CVs than <a class="el" href="_m_e_t_a_d.html">METAD</a>. If the employed CVs map different metastable basins onto the same CV-space region, then <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> will remain stuck rather than completely reshaping the bias. This can be useful to diagnose problems with your collective variable. If it is not possible to improve the set of CVs and remove this degeneracy, then you might instead consider to use <a class="el" href="_o_p_e_s__m_e_t_a_d__e_x_p_l_o_r_e.html">OPES_METAD_EXPLORE</a> or <a class="el" href="_m_e_t_a_d.html">METAD</a>. In this way you will be able to obtain an estimate of the FES, but be aware that you most likely will not reach convergence and thus this estimate will be subjected to systematic errors (see e.g. Fig.3 in <a class="el" href="citelist.html#CITEREF_Pietrucci2017review">[90]</a>). On the contrary, if your CVs are not degenerate but only suboptimal, you should converge faster by using <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> instead of <a class="el" href="_m_e_t_a_d.html">METAD</a> <a class="el" href="citelist.html#CITEREF_Invernizzi2020rethinking">[58]</a>.</p>
<p>The parameter BARRIER should be set to be at least equal to the highest free energy barrier you wish to overcome. If it is much lower than that, you will not cross the barrier, if it is much higher, convergence might take a little longer. If the system has a basin that is clearly more stable than the others, it is better to start the simulation from there.</p>
<p>By default, the kernels SIGMA is adaptive, estimated from the fluctuations over ADAPTIVE_SIGMA_STRIDE simulation steps (similar to <a class="el" href="_m_e_t_a_d.html">METAD</a> ADAPTIVE=DIFF, but contrary to that, no artifacts are introduced and the bias will converge to the correct one). However, notice that depending on the system this might not be the optimal choice for SIGMA.</p>
<p>You can target a uniform flat distribution by explicitly setting BIASFACTOR=inf. However, this should be useful only in very specific cases.</p>
<p>It is possible to take into account also of other bias potentials besides the one of <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> during the internal reweighting for \(P(\mathbf{s})\) estimation. To do so, one has to add those biases with the EXTRA_BIAS keyword, as in the example below. This allows one to define a custom target distribution by adding another bias potential equal to the desired target free energy and setting BIASFACTOR=inf (see example below). Another possible usage of EXTRA_BIAS is to make sure that <a class="el" href="_o_p_e_s__m_e_t_a_d.html">OPES_METAD</a> does not push against another fixed bias added to restrain the CVs range (e.g. <a class="el" href="_u_p_p_e_r__w_a_l_l_s.html">UPPER_WALLS</a>).</p>
<p>Through the EXCLUDED_REGION keywork, it is possible to specify a region of CV space where no kernels will be deposited. This can be useful for example for making sure the bias does not modify the transition region, thus allowing for rate calculation. See below for an example of how to use this keyword.</p>
<p>Restart can be done from a KERNELS file, but it might be not perfect (due to limited precision when printing kernels to file, or if adaptive SIGMA is used). For an exact restart you must use STATE_RFILE to read a checkpoint with all the needed info. To save such checkpoints, define a STATE_WFILE and choose how often to print them with STATE_WSTRIDE. By default this file is overwritten, but you can instead append to it using the flag STORE_STATES.</p>
<p>Multiple walkers are supported only with MPI communication, via the keyword WALKERS_MPI.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>Several examples can be found on the <a href="https://www.plumed-nest.org/browse.html">PLUMED-NEST website</a>, by searching for the OPES keyword. The opes-metad can also be useful to get started with the method.</p>
<p>The following is a minimal working example:</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1cv" onclick='showPath("eg1","eg1cv")'>cv: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg1cv">The DISTANCE action with label <b>cv</b> calculates a single scalar value</span>
<b name="eg1opes" onclick='showPath("eg1","eg1opes")'>opes: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_e_s__m_e_t_a_d.html" style="color:green">OPES_METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg1cv">cv</b> <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for kernel deposition <i></i></div></div>=200 <div class="tooltip">BARRIER<div class="right"><b>compulsory keyword </b>
the free energy barrier to be overcome. <i></i></div></div>=40 <span style="display:none;" id="eg1opes">The OPES_METAD action with label <b>opes</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">opes.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">opes.rct</td><td>estimate of c(t). log(exp(beta V)/beta, should become flat as the simulation converges. Do NOT use for reweighting</td></tr>
<tr><td width="5%%">opes.zed</td><td>estimate of Z_n. should become flat once no new CV-space region is explored</td></tr>
<tr><td width="5%%">opes.neff</td><td>effective sample size</td></tr>
<tr><td width="5%%">opes.nker</td><td>total number of compressed kernels used to represent the bias</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=200 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=* <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p>Another more articulated one:</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2phi" onclick='showPath("eg2","eg2phi")'>phi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,7,9,15 <span style="display:none;" id="eg2phi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg2psi" onclick='showPath("eg2","eg2psi")'>psi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=7,9,15,17 <span style="display:none;" id="eg2psi">The TORSION action with label <b>psi</b> calculates a single scalar value</span>
<b name="eg2opes" onclick='showPath("eg2","eg2opes")'>opes: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_e_s__m_e_t_a_d.html" style="color:green">OPES_METAD</a> ...
   <div class="tooltip">FILE<div class="right"><b>compulsory keyword ( default=KERNELS )</b>
a file in which the list of all deposited kernels is stored <i></i></div></div>=Kernels.data 
   <div class="tooltip">TEMP<div class="right"><b>compulsory keyword ( default=-1 )</b>
temperature. <i></i></div></div>=300 
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2phi">phi</b>,<b name="eg2psi">psi</b> 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for kernel deposition <i></i></div></div>=500 
   <div class="tooltip">BARRIER<div class="right"><b>compulsory keyword </b>
the free energy barrier to be overcome. <i></i></div></div>=50 
   <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword ( default=ADAPTIVE )</b>
the initial widths of the kernels. <i></i></div></div>=0.15,0.15 
   <div class="tooltip">SIGMA_MIN<div class="right">never reduce SIGMA below this value <i></i></div></div>=0.01,0.01 
   <div class="tooltip">STATE_RFILE<div class="right">read from this file the compressed kernels and all the info needed to RESTART the
simulation <i></i></div></div>=Restart.data 
   <div class="tooltip">STATE_WFILE<div class="right">write to this file the compressed kernels and all the info needed to RESTART the
simulation <i></i></div></div>=State.data 
   <div class="tooltip">STATE_WSTRIDE<div class="right">number of MD steps between writing the STATE_WFILE. <i></i></div></div>=500*100 
   <div class="tooltip">STORE_STATES<div class="right">( default=off ) append to STATE_WFILE instead of ovewriting it each time <i></i></div></div> 
   <div class="tooltip">WALKERS_MPI<div class="right">( default=off ) switch on MPI version of multiple walkers <i></i></div></div> 
   <div class="tooltip">NLIST<div class="right">( default=off ) use neighbor list for kernels summation, faster but experimental
<i></i></div></div> 
...<span style="display:none;" id="eg2opes">The OPES_METAD action with label <b>opes</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">opes.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">opes.rct</td><td>estimate of c(t). log(exp(beta V)/beta, should become flat as the simulation converges. Do NOT use for reweighting</td></tr>
<tr><td width="5%%">opes.zed</td><td>estimate of Z_n. should become flat once no new CV-space region is explored</td></tr>
<tr><td width="5%%">opes.neff</td><td>effective sample size</td></tr>
<tr><td width="5%%">opes.nker</td><td>total number of compressed kernels used to represent the bias</td></tr>
<tr><td width="5%%">opes.nlker</td><td>number of kernels in the neighbor list</td></tr>
<tr><td width="5%%">opes.nlsteps</td><td>number of steps from last neighbor list update</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">FMT<div class="right">the format that should be used to output real numbers <i></i></div></div>=%g <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=500 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=Colvar.data <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2phi">phi</b>,<b name="eg2psi">psi</b>,<b name="eg2opes">opes.*</b> <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>Next is an example of how to define a custom target distribution different from the well-tempered one. Here we chose to focus more on the transition state, that is around \(\phi=0\). Our target distribution is a Gaussian centered there, thus the target free energy we want to sample is a parabola, \(F^{\text{tg}}(\mathbf{s})=-\frac{1}{\beta} \log [p^{\text{tg}}(\mathbf{s})]\).</p>

<div style="width: 80%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg3_button" onclick='swapInput("eg3")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg3"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg3Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg3Load);
}
function eg3Load(event) {
       swapInput("eg3");
}
</script>
<div style="display:none;" id="eg3short">
<pre style="width: 97%;" class="fragment">
<b name="eg3shortphi" onclick='showPath("eg3","eg3shortphi")'>phi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,7,9,15 <span style="display:none;" id="eg3shortphi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg3shortFtgValue" onclick='showPath("eg3","eg3shortFtgValue")'>FtgValue: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3shortphi">phi</b> <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=(x/0.4)^2 <span style="display:none;" id="eg3shortFtgValue">The CUSTOM action with label <b>FtgValue</b> calculates a single scalar value</span>
<b name="eg3shortFtg" onclick='showPath("eg3","eg3shortFtg")'>Ftg: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalar/vector arguments whose values will be used as a bias on
the system <i></i></div></div>=<b name="eg3shortFtgValue">FtgValue</b> <span style="display:none;" id="eg3shortFtg">The BIASVALUE action with label <b>Ftg</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">Ftg.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">Ftg.FtgValue_bias</td><td>one or multiple instances of this quantity can be referenced elsewhere in the input file. these quantities will named with  the arguments of the bias followed by the character string _bias. These quantities tell the user how much the bias is due to each of the colvars. This particular component measures this quantity for the input CV named FtgValue</td></tr>
</table>
</span>
<b name="eg3shortopes" onclick='showPath("eg3","eg3shortopes")'>opes: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_e_s__m_e_t_a_d.html" style="color:green">OPES_METAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg3shortphi">phi</b> 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for kernel deposition <i></i></div></div>=500 
   <div class="tooltip">BARRIER<div class="right"><b>compulsory keyword </b>
the free energy barrier to be overcome. <i></i></div></div>=50 
   <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword ( default=ADAPTIVE )</b>
the initial widths of the kernels. <i></i></div></div>=0.2 
   <div class="tooltip">BIASFACTOR<div class="right">the gamma bias factor used for the well-tempered target distribution. <i></i></div></div>=inf 
   <div class="tooltip">EXTRA_BIAS<div class="right">consider also these other bias potentials for the internal reweighting. <i></i></div></div>=<b name="eg3shortFtg">Ftg.bias</b> 
...<span style="display:none;" id="eg3shortopes">The OPES_METAD action with label <b>opes</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">opes.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">opes.rct</td><td>estimate of c(t). log(exp(beta V)/beta, should become flat as the simulation converges. Do NOT use for reweighting</td></tr>
<tr><td width="5%%">opes.zed</td><td>estimate of Z_n. should become flat once no new CV-space region is explored</td></tr>
<tr><td width="5%%">opes.neff</td><td>effective sample size</td></tr>
<tr><td width="5%%">opes.nker</td><td>total number of compressed kernels used to represent the bias</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">FMT<div class="right">the format that should be used to output real numbers <i></i></div></div>=%g <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=500 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg3shortphi">phi</b>,<b name="eg3shortFtg">Ftg.bias</b>,<b name="eg3shortopes">opes.bias</b> <span style="display:none;" id="eg3short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg3long"><pre style="width: 97%;" class="fragment">
<b name="eg3longphi" onclick='showPath("eg3","eg3longphi")'>phi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,7,9,15 <span style="display:none;" id="eg3longphi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg3longFtg" onclick='showPath("eg3","eg3longFtg")'>Ftg: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_i_a_s_v_a_l_u_e.html" style="color:green">BIASVALUE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalar/vector arguments whose values will be used as a bias on
the system <i></i></div></div>=FtgValue <span style="display:none;" id="eg3longFtg">The BIASVALUE action with label <b>Ftg</b><p>Notice that in order to reweight for the unbiased \(P(\mathbf{s})\) during postprocessing, the total bias <code>Ftg.bias+opes.bias</code> must be used.</p>
<p>Finally, an example of how to use the EXCLUDED_REGION keyword. It expects a characteristic function that is different from zero in the region to be excluded. You can use <a class="el" href="_c_u_s_t_o_m.html">CUSTOM</a> and a combination of the step function to define it. With the following input no kernel is deposited in the transition state region of alanine dipeptide, defined by the interval \(\phi \in [-0.6, 0.7]\):</p>

<div style="width: 80%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg4_button" onclick='swapInput("eg4")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg4"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg4Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg4Load);
}
function eg4Load(event) {
       swapInput("eg4");
}
</script>
<div style="display:none;" id="eg4short">
<pre style="width: 97%;" class="fragment">
<b name="eg4shortphi" onclick='showPath("eg4","eg4shortphi")'>phi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,7,9,15 <span style="display:none;" id="eg4shortphi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg4shortpsi" onclick='showPath("eg4","eg4shortpsi")'>psi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=7,9,15,17 <span style="display:none;" id="eg4shortpsi">The TORSION action with label <b>psi</b> calculates a single scalar value</span>
<b name="eg4shortxx" onclick='showPath("eg4","eg4shortxx")'>xx: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg4shortphi">phi</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=step(x+0.6)-step(x-0.7) <span style="display:none;" id="eg4shortxx">The CUSTOM action with label <b>xx</b> calculates a single scalar value</span>
<b name="eg4shortopes" onclick='showPath("eg4","eg4shortopes")'>opes: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_e_s__m_e_t_a_d.html" style="color:green">OPES_METAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg4shortphi">phi</b>,<b name="eg4shortpsi">psi</b> 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for kernel deposition <i></i></div></div>=500 
   <div class="tooltip">BARRIER<div class="right"><b>compulsory keyword </b>
the free energy barrier to be overcome. <i></i></div></div>=30 
   <div class="tooltip">EXCLUDED_REGION<div class="right">kernels are not deposited when the action provided here has a nonzero value, see
example above <i></i></div></div>=<b name="eg4shortxx">xx</b> 
   <div class="tooltip">NLIST<div class="right">( default=off ) use neighbor list for kernels summation, faster but experimental
<i></i></div></div> 
...<span style="display:none;" id="eg4shortopes">The OPES_METAD action with label <b>opes</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">opes.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">opes.rct</td><td>estimate of c(t). log(exp(beta V)/beta, should become flat as the simulation converges. Do NOT use for reweighting</td></tr>
<tr><td width="5%%">opes.zed</td><td>estimate of Z_n. should become flat once no new CV-space region is explored</td></tr>
<tr><td width="5%%">opes.neff</td><td>effective sample size</td></tr>
<tr><td width="5%%">opes.nker</td><td>total number of compressed kernels used to represent the bias</td></tr>
<tr><td width="5%%">opes.nlker</td><td>number of kernels in the neighbor list</td></tr>
<tr><td width="5%%">opes.nlsteps</td><td>number of steps from last neighbor list update</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">FMT<div class="right">the format that should be used to output real numbers <i></i></div></div>=%g <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=500 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg4shortphi">phi</b>,<b name="eg4shortpsi">psi</b>,<b name="eg4shortxx">xx</b>,<b name="eg4shortopes">opes.*</b> <span style="display:none;" id="eg4short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg4long"><pre style="width: 97%;" class="fragment">
<b name="eg4longphi" onclick='showPath("eg4","eg4longphi")'>phi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,7,9,15 <span style="display:none;" id="eg4longphi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg4longpsi" onclick='showPath("eg4","eg4longpsi")'>psi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=7,9,15,17 <span style="display:none;" id="eg4longpsi">The TORSION action with label <b>psi</b> calculates a single scalar value</span>
<b name="eg4longopes" onclick='showPath("eg4","eg4longopes")'>opes: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_e_s__m_e_t_a_d.html" style="color:green">OPES_METAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg4longphi">phi</b>,<b name="eg4longpsi">psi</b> 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for kernel deposition <i></i></div></div>=500 
   <div class="tooltip">BARRIER<div class="right"><b>compulsory keyword </b>
the free energy barrier to be overcome. <i></i></div></div>=30 
   <div class="tooltip">EXCLUDED_REGION<div class="right">kernels are not deposited when the action provided here has a nonzero value, see
example above <i></i></div></div>=xx 
   <div class="tooltip">NLIST<div class="right">( default=off ) use neighbor list for kernels summation, faster but experimental
<i></i></div></div> 
...<span style="display:none;" id="eg4longopes">The OPES_METAD action with label <b>opes</b><dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> rct </b> </td><td>estimate of c(t). log(exp(beta V)/beta, should become flat as the simulation converges. Do NOT use for reweighting   </td></tr>
<tr>
<td width="15%"><b> zed </b> </td><td>estimate of Z_n. should become flat once no new CV-space region is explored   </td></tr>
<tr>
<td width="15%"><b> neff </b> </td><td>effective sample size   </td></tr>
<tr>
<td width="15%"><b> nker </b> </td><td>total number of compressed kernels used to represent the bias   </td></tr>
</table>
<p>In addition the following quantities can be calculated by employing the keywords listed below</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> work </b> </td><td width="10%"><b> CALC_WORK </b>  </td><td>total accumulated work done by the bias   </td></tr>
<tr>
<td width="5%"><b> nlker </b> </td><td width="10%"><b> NLIST </b>  </td><td>number of kernels in the neighbor list   </td></tr>
<tr>
<td width="5%"><b> nlsteps </b> </td><td width="10%"><b> NLIST </b>  </td><td>number of steps from last neighbor list update   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>( default=-1 ) temperature. If not set, it is taken from MD engine, but not all MD codes provide it   </td></tr>
<tr>
<td width="15%"><b> PACE </b> </td><td>the frequency for kernel deposition   </td></tr>
<tr>
<td width="15%"><b> SIGMA </b> </td><td>( default=ADAPTIVE ) the initial widths of the kernels. If not set, an adaptive sigma will be used with the given ADAPTIVE_SIGMA_STRIDE   </td></tr>
<tr>
<td width="15%"><b> BARRIER </b> </td><td>the free energy barrier to be overcome. It is used to set BIASFACTOR, EPSILON, and KERNEL_CUTOFF to reasonable values   </td></tr>
<tr>
<td width="15%"><b> COMPRESSION_THRESHOLD </b> </td><td>( default=1 ) merge kernels if closer than this threshold, in units of sigma   </td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>( default=KERNELS ) a file in which the list of all deposited kernels is stored   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NLIST </b> </td><td>( default=off ) use neighbor list for kernels summation, faster but experimental   </td></tr>
<tr>
<td width="15%"><b> NLIST_PACE_RESET </b> </td><td>( default=off ) force the reset of the neighbor list at each PACE. Can be useful with WALKERS_MPI   </td></tr>
<tr>
<td width="15%"><b> FIXED_SIGMA </b> </td><td>( default=off ) do not decrease sigma as the simulation proceeds. Can be added in a RESTART, to keep in check the number of compressed kernels   </td></tr>
<tr>
<td width="15%"><b> RECURSIVE_MERGE_OFF </b> </td><td>( default=off ) do not recursively attempt kernel merging when a new one is added   </td></tr>
<tr>
<td width="15%"><b> NO_ZED </b> </td><td>( default=off ) do not normalize over the explored CV space, Z_n=1   </td></tr>
<tr>
<td width="15%"><b> STORE_STATES </b> </td><td>( default=off ) append to STATE_WFILE instead of ovewriting it each time   </td></tr>
<tr>
<td width="15%"><b> CALC_WORK </b> </td><td>( default=off ) calculate the total accumulated work done by the bias since last restart   </td></tr>
<tr>
<td width="15%"><b> WALKERS_MPI </b> </td><td>( default=off ) switch on MPI version of multiple walkers   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td><p class="starttd">( default=off ) perform calculations in serial  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> ADAPTIVE_SIGMA_STRIDE </b> </td><td>number of steps for measuring adaptive sigma. Default is 10xPACE   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MIN </b> </td><td>never reduce SIGMA below this value   </td></tr>
<tr>
<td width="15%"><b> BIASFACTOR </b> </td><td>the gamma bias factor used for the well-tempered target distribution. Set to 'inf' for uniform flat target   </td></tr>
<tr>
<td width="15%"><b> EPSILON </b> </td><td>the value of the regularization constant for the probability   </td></tr>
<tr>
<td width="15%"><b> KERNEL_CUTOFF </b> </td><td>truncate kernels at this distance, in units of sigma   </td></tr>
<tr>
<td width="15%"><b> NLIST_PARAMETERS </b> </td><td>( default=3.0,0.5 ) the two cutoff parameters for the kernels neighbor list   </td></tr>
<tr>
<td width="15%"><b> FMT </b> </td><td>specify format for KERNELS file   </td></tr>
<tr>
<td width="15%"><b> STATE_RFILE </b> </td><td>read from this file the compressed kernels and all the info needed to RESTART the simulation   </td></tr>
<tr>
<td width="15%"><b> STATE_WFILE </b> </td><td>write to this file the compressed kernels and all the info needed to RESTART the simulation   </td></tr>
<tr>
<td width="15%"><b> STATE_WSTRIDE </b> </td><td>number of MD steps between writing the STATE_WFILE. Default is only on CPT events (but not all MD codes set them)   </td></tr>
<tr>
<td width="15%"><b> EXCLUDED_REGION </b> </td><td>kernels are not deposited when the action provided here has a nonzero value, see example above   </td></tr>
<tr>
<td width="15%"><b> EXTRA_BIAS </b> </td><td>consider also these other bias potentials for the internal reweighting. This can be used e.g. for sampling a custom target distribution (see example above)   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
<tr>
<td width="15%"><b> UPDATE_FROM </b> </td><td>Only update this action from this time   </td></tr>
<tr>
<td width="15%"><b> UPDATE_UNTIL </b> </td><td>Only update this action until this time   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_o_p_e_s.html">OPES (On-the-fly Probability Enhanced Sampling)</a></li><li class="navelem"><a class="el" href="_o_p_e_s_bias.html">Biases</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
