<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: FISST</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_f_i_s_s_t.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">FISST </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the fisst <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=fisst . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Compute and apply the optimal linear force on an observable to enhance sampling of conformational distributions over a range of applied forces.</p>
<p>This method is described in <a class="el" href="citelist.html#CITEREF_Hartmann-FISST-2019">[49]</a></p>
<p>If the system's Hamiltonian is given by: </p><p class="formulaDsp">
\[ H(\vec{p},\vec{q}) = \sum_{j} \frac{p_j^2}{2m_j} + U(\vec{q}), \]
</p>
<p>This bias modifies the Hamiltonian to be: </p><p class="formulaDsp">
\[ H&#39;(\vec{p},\vec{q}) = H(\vec{p},\vec{q}) - \bar{F} Q \]
</p>
<p>where for CV \(Q\), a coupling constant \({\bar{F}}\) is determined adaptively according to the FISST algorithm.</p>
<p>Specifically, </p><p class="formulaDsp">
\[ \bar{F}(Q)=\frac{ \int_{F_{min}}^{F_{max}} e^{\beta F Q(\vec{q})} \omega(F) F dF}{\int_{F_{min}}^{F_{max}} e^{\beta F Q(\vec{q})} \omega(F) dF}, \]
</p>
<p>where \(\vec{q}\) are the molecular coordinates of the system, and \(w(F)\) is a weighting function that is learned on the fly for each force by the FISST algorithm (starting from an initial weight distribution, uniform by default).</p>
<p>The target for \(w(F)=1/Z_q(F)\), where </p><p class="formulaDsp">
\[ Z_q(F) \equiv \int d\vec{q} e^{-\beta U(\vec{q}) + \beta F Q(\vec{q})}. \]
</p>
<p>FISST also computes and writes Observable Weights \(W_F(\vec{q}_t)\) for a molecular configuration at time \(t\), so that averages of other quantities \(A(\vec{q})\) can be reconstructed later at different force values (over a trajectory with \(T\) samples): </p><p class="formulaDsp">
\[ \langle A \rangle_F = \frac{1}{T} \sum_t W_F(\vec{q}_t) A(\vec{q}_t). \]
</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In the following example, an adaptive restraint is learned to bias the distance between two atoms in a system, for a force range of 0-100 pN.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-master/user-doc/html/_u_n_i_t_s.html" style="color:green">UNITS</a> <div class="tooltip">LENGTH<div class="right">the units of lengths. <i></i></div></div>=A <div class="tooltip">TIME<div class="right">the units of time. <i></i></div></div>=fs <div class="tooltip">ENERGY<div class="right">the units of energy. <i></i></div></div>=kcal/mol <span style="display:none;" id="eg1">The UNITS action with label <b></b></span>
<b name="eg1b1" onclick='showPath("eg1","eg1b1")'>b1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">ATOMS<div class="right">the numerical indexes for the set of atoms in the group. <i></i></div></div>=1 <span style="display:none;" id="eg1b1">The GROUP action with label <b>b1</b> defines a group of atoms so that they can be referred to later in the input</span>
<b name="eg1b2" onclick='showPath("eg1","eg1b2")'>b2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">ATOMS<div class="right">the numerical indexes for the set of atoms in the group. <i></i></div></div>=12 <span style="display:none;" id="eg1b2">The GROUP action with label <b>b2</b> defines a group of atoms so that they can be referred to later in the input</span>
<b name="eg1dend" onclick='showPath("eg1","eg1dend")'>dend: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=<b name="eg1b1">b1</b>,<b name="eg1b2">b2</b> <span style="display:none;" id="eg1dend">The DISTANCE action with label <b>dend</b> calculates a single scalar value</span>
<span style="color:blue">#The conversion factor is 69.4786 pN = 1 kcal/mol/Angstrom</span>
<span style="color:blue">#0 pN to 100 pN</span>
<b name="eg1f" onclick='showPath("eg1","eg1f")'>f: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_f_i_s_s_t.html" style="color:green">FISST</a> <div class="tooltip">MIN_FORCE<div class="right"><b>compulsory keyword </b>
Minimum force (per CV) to use for sampling. <i></i></div></div>=0 <div class="tooltip">MAX_FORCE<div class="right"><b>compulsory keyword </b>
Maximum force (per CV) to use for sampling. <i></i></div></div>=1.44 <div class="tooltip">PERIOD<div class="right"><b>compulsory keyword </b>
Steps corresponding to the learning rate <i></i></div></div>=100 <div class="tooltip">NINTERPOLATE<div class="right"><b>compulsory keyword </b>
Number of grid points on which to do interpolation. <i></i></div></div>=31 <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg1dend">dend</b> <div class="tooltip">OUT_RESTART<div class="right">Output file for all information needed to continue FISST simulation.If <i></i></div></div>=pull.restart.txt <div class="tooltip">OUT_OBSERVABLE<div class="right">Output file putting weights needed to compute observables at different force values.If
<i></i></div></div>=pull.observable.txt <div class="tooltip">OBSERVABLE_FREQ<div class="right">How often to write out observable weights (default=period). <i></i></div></div>=1000 <span style="display:none;" id="eg1f">The FISST action with label <b>f</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">f.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">f.force2</td><td>squared value of force from the bias.</td></tr>
<tr><td width="5%%">f.dend_fbar</td><td>For each named CV biased, there will be a corresponding output CV_fbar storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dend</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1dend">dend</b>,<b name="eg1f">f.dend_fbar</b>,<b name="eg1f">f.bias</b>,<b name="eg1f">f.force2</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=pull.colvar.txt <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1000 <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> force2 </b> </td><td>squared value of force from the bias.   </td></tr>
<tr>
<td width="15%"><b> _fbar </b> </td><td>For each named CV biased, there will be a corresponding output CV_fbar storing the current linear bias prefactor.   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> PERIOD </b> </td><td>Steps corresponding to the learning rate   </td></tr>
<tr>
<td width="15%"><b> NINTERPOLATE </b> </td><td>Number of grid points on which to do interpolation.   </td></tr>
<tr>
<td width="15%"><b> MIN_FORCE </b> </td><td>Minimum force (per CV) to use for sampling. Units: [Energy]/[CV] (can be negative).   </td></tr>
<tr>
<td width="15%"><b> MAX_FORCE </b> </td><td>Maximum force (per CV) to use for sampling.   </td></tr>
<tr>
<td width="15%"><b> CENTER </b> </td><td>( default=0 ) The CV value at which the applied bias energy will be zero   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> FREEZE </b> </td><td><p class="starttd">( default=off ) Fix bias weights at current level (only used for restarting).  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> RESET_PERIOD </b> </td><td>Reset the learning statistics every time this number of steps comes around.   </td></tr>
<tr>
<td width="15%"><b> KBT </b> </td><td>The system temperature in units of KB*T. If not provided will be taken from MD code (if available)   </td></tr>
<tr>
<td width="15%"><b> INITIAL_WEIGHT_DIST </b> </td><td>Starting distribution for the force weights (options: UNIFORM, EXP, GAUSS).   </td></tr>
<tr>
<td width="15%"><b> INITIAL_WEIGHT_RATE </b> </td><td>Rate of decay for exponential and gaussian distributions. W(F)~exp(-r |F|^d).   </td></tr>
<tr>
<td width="15%"><b> RESTART_FMT </b> </td><td>the format that should be used to output real numbers in FISST restarts.   </td></tr>
<tr>
<td width="15%"><b> OUT_RESTART </b> </td><td>Output file for all information needed to continue FISST simulation.If you have the RESTART directive set (global or for FISST), this file will be appended to.Note that the header will be printed again if appending.   </td></tr>
<tr>
<td width="15%"><b> IN_RESTART </b> </td><td>Read this file to continue an FISST simulation. If same as OUT_RESTART and you have not set the RESTART directive, the file will be backed-up and overwritten with new output.If you do have the RESTART flag set and it is the same name as OUT_RESTART, this file will be appended.   </td></tr>
<tr>
<td width="15%"><b> OUT_OBSERVABLE </b> </td><td>Output file putting weights needed to compute observables at different force values.If you have the RESTART directive set (global or for FISST), this file will be appended to. Note that the header will be printed again if appending.   </td></tr>
<tr>
<td width="15%"><b> OBSERVABLE_FREQ </b> </td><td>How often to write out observable weights (default=period).   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_f_i_s_s_t_m_o_d.html">FISST (Infinite Switch Simulated Tempering in Force)</a></li><li class="navelem"><a class="el" href="_f_i_s_s_t_m_o_d_bias.html">Biases Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
