<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: VES_LINEAR_EXPANSION</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_v_e_s__l_i_n_e_a_r__e_x_p_a_n_s_i_o_n.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">VES_LINEAR_EXPANSION </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the ves <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=ves . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Linear basis set expansion bias.</p>
<p>This VES bias action takes the bias potential to be a linear expansion in some basis set that is written as a product of one-dimensional basis functions. For example, for one CV the bias would be written as </p><p class="formulaDsp">
\[ V(s_{1};\boldsymbol{\alpha}) = \sum_{i_{1}} \alpha_{i_{1}} \, f_{i_{1}}(s_{1}), \]
</p>
<p> while for two CVs it is written as </p><p class="formulaDsp">
\[ V(s_{1},s_{2};\boldsymbol{\alpha}) = \sum_{i_{1},i_{2}} \alpha_{i_{1},i_{2}} \, f_{i_{1}}(s_{1}) \, f_{i_{2}}(s_{2}) \]
</p>
<p> where \(\boldsymbol{\alpha}\) is the set of expansion coefficients that are optimized within VES. With an appropriate choice of the basis functions it is possible to represent any generic free energy surface. The relationship between the bias and the free energy surface is given by </p><p class="formulaDsp">
\[ V(\mathbf{s}) = - F(\mathbf{s}) - \frac{1}{\beta} \log p(\mathbf{s}). \]
</p>
<p> where \(p(\mathbf{s})\) is the target distribution that is employed in the VES simulation.</p>
<dl class="section user"><dt>Basis Functions</dt><dd></dd></dl>
<p>Various one-dimensional basis functions are available in the VES code, see the complete list <a class="el" href="ves_basisf.html">here</a>. At the current moment we recommend to use Legendre polynomials (<a class="el" href="_b_f__l_e_g_e_n_d_r_e.html">BF_LEGENDRE</a>) for non-periodic CVs and Fourier basis functions (<a class="el" href="_b_f__f_o_u_r_i_e_r.html">BF_FOURIER</a>) for periodic CV (e.g. dihedral angles).</p>
<p>To use basis functions within VES_LINEAR_EXPANSION you first need to define them in the input file before the VES_LINEAR_EXPANSION action and then give their labels using the BASIS_FUNCTIONS keyword.</p>
<dl class="section user"><dt>Target Distributions</dt><dd></dd></dl>
<p>Various target distributions \(p(\mathbf{s})\) are available in the VES code, see the complete list <a class="el" href="ves_targetdist.html">here</a>.</p>
<p>To use a target distribution within VES_LINEAR_EXPANSION you first need to define it in the input file before the VES_LINEAR_EXPANSION action and then give its label using the TARGET_DISTRIBUTION keyword. The default behavior if no TARGET_DISTRIBUTION is given is to employ a uniform target distribution.</p>
<p>Some target distribution, like the well-tempered one (<a class="el" href="_t_d__w_e_l_l_t_e_m_p_e_r_e_d.html">TD_WELLTEMPERED</a>), are dynamic and need to be iteratively updated during the optimization.</p>
<dl class="section user"><dt>Optimizer</dt><dd></dd></dl>
<p>In order to optimize the coefficients you will need to use VES_LINEAR_EXPANSION in combination with an optimizer, see the list of optimizers available in the VES code <a class="el" href="ves_optimizer.html">here</a>. At the current moment we recommend to use the averaged stochastic gradient decent optimizer (<a class="el" href="_o_p_t__a_v_e_r_a_g_e_d__s_g_d.html">OPT_AVERAGED_SGD</a>).</p>
<p>The optimizer should be defined after the VES_LINEAR_EXPANSION action.</p>
<dl class="section user"><dt>Grid</dt><dd></dd></dl>
<p>Internally the code uses grids to calculate the basis set averages over the target distribution that is needed for the gradient. The same grid is also used for the output files (see next section). The size of the grid is determined by the GRID_BINS keyword. By default it has 100 grid points in each dimension, and generally this value should be sufficient.</p>
<dl class="section user"><dt>Outputting Free Energy Surfaces and Other Files</dt><dd></dd></dl>
<p>It is possible to output on-the-fly during the simulation the free energy surface estimated from the bias potential. How often this is done is specified within the <a class="el" href="ves_optimizer.html">optimizer</a> by using the FES_OUTPUT keyword. The filename is specified by the FES_FILE keyword, but by default is it fes.LABEL.data, with an added suffix indicating the iteration number (iter-#).</p>
<p>For multi-dimensional case is it possible to also output projections of the free energy surfaces. The arguments for which to do these projections is specified using the numbered PROJ_ARG keywords. For these files a suffix indicating the projection (proj-#) will be added to the filenames. You will also need to specify the frequency of the output by using the FES_PROJ_OUTPUT keyword within the optimizer.</p>
<p>It is also possible to output the bias potential itself, for this the relevant keyword is BIAS_OUTPUT within the optimizer. The filename is specified by the BIAS_FILE keyword, but by default is it bias.LABEL.data, with an added suffix indicating the iteration number (iter-#).</p>
<p>Furthermore is it possible to output the target distribution, and its projections (i.e. marginal distributions). The filenames of these files are specified with the TARGETDIST_FILE, but by default is it targetdist.LABEL.data. The logarithm of the target distribution will also be outputted to file that has the added suffix log. For static target distribution these files will be outputted in the beginning of the simulation while for dynamic ones you will need to specify the frequency of the output by using the TARGETDIST_OUTPUT and TARGETDIST_PROJ_OUTPUT keywords within the optimizer.</p>
<p>It is also possible to output free energy surfaces and bias in post processing by using the <a class="el" href="_v_e_s__o_u_t_p_u_t__f_e_s.html">VES_OUTPUT_FES</a> action. However, be aware that this action does does not support dynamic target distribution (e.g. well-tempered).</p>
<dl class="section user"><dt>Static Bias</dt><dd></dd></dl>
<p>It is also possible to use VES_LINEAR_EXPANSION as a static bias that uses previously obtained coefficients. In this case the coefficients should be read in from the coefficient file given in the COEFFS keyword.</p>
<dl class="section user"><dt>Bias Cutoff</dt><dd></dd></dl>
<p>It is possible to impose a cutoff on the bias potential using the procedure introduced in <a class="el" href="citelist.html#CITEREF_McCarty-PRL-2015">[74]</a> such that the free energy surface is only flooded up to a certain value. The bias that results from this procedure can then be used as a static bias for obtaining kinetic rates. The value of the cutoff is given by the BIAS_CUTOFF keyword. To impose the cutoff the code uses a Fermi switching function \(1/(1+e^{\lambda x})\) where the parameter \(\lambda\) controls how sharply the switchingfunction goes to zero. The default value is \(\lambda=10\) but this can be changed by using the BIAS_CUTOFF_FERMI_LAMBDA keyword.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In the following example we run a VES_LINEAR_EXPANSION for one CV using a Legendre basis functions (<a class="el" href="_b_f__l_e_g_e_n_d_r_e.html">BF_LEGENDRE</a>) and a uniform target distribution as no target distribution is specified. The coefficients are optimized using averaged stochastic gradient descent optimizer (<a class="el" href="_o_p_t__a_v_e_r_a_g_e_d__s_g_d.html">OPT_AVERAGED_SGD</a>). Within the optimizer we specify that the FES should be outputted to file every 500 coefficients iterations (the FES_OUTPUT keyword). Parameters that are very specific to the problem at hand, like the order of the basis functions, the interval on which the basis functions are defined, and the step size used in the optimizer, are left unfilled. </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-incomplete-yellow.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1bf1" onclick='showPath("eg1","eg1bf1")'>bf1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__l_e_g_e_n_d_r_e.html" style="color:green">BF_LEGENDRE</a> <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg1bf1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1b1" onclick='showPath("eg1","eg1b1")'>b1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_v_e_s__l_i_n_e_a_r__e_x_p_a_n_s_i_o_n.html" style="color:green">VES_LINEAR_EXPANSION</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=d1 
   <div class="tooltip">BASIS_FUNCTIONS<div class="right"><b>compulsory keyword </b>
the label of the one dimensional basis functions that should be used. <i></i></div></div>=<b name="eg1bf1">bf1</b> 
   <div class="tooltip">TEMP<div class="right">the system temperature - this is needed if the MD code does not pass the temperature
to PLUMED. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">GRID_BINS<div class="right">the number of bins used for the grid. <i></i></div></div>=200 
   
...<span style="display:none;" id="eg1b1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1o1" onclick='showPath("eg1","eg1o1")'>o1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_t__a_v_e_r_a_g_e_d__s_g_d.html" style="color:green">OPT_AVERAGED_SGD</a> ...
   <div class="tooltip">BIAS<div class="right"><b>compulsory keyword </b>
the label of the VES bias to be optimized <i></i></div></div>=<b name="eg1b1">b1</b> 
   <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword </b>
the frequency of updating the coefficients given in the number of MD steps. <i></i></div></div>=1000 
   
   <div class="tooltip">STEPSIZE<div class="right"><b>compulsory keyword </b>
the step size used for the optimization <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">FES_OUTPUT<div class="right">how often the FES(s) should be written out to file. <i></i></div></div>=500 
   <div class="tooltip">COEFFS_OUTPUT<div class="right"><b>compulsory keyword ( default=100 )</b>
how often the coefficients should be written to file. <i></i></div></div>=10 
...<span style="display:none;" id="eg1o1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>In the following example we employ VES_LINEAR_EXPANSION for two CVs, The first CV is periodic and therefore we employ a Fourier basis functions (<a class="el" href="_b_f__l_e_g_e_n_d_r_e.html">BF_LEGENDRE</a>) while the second CV is non-periodic so we employ a Legendre polynomials as in the previous example. For the target distribution we employ a well-tempered target distribution (<a class="el" href="_t_d__w_e_l_l_t_e_m_p_e_r_e_d.html">TD_WELLTEMPERED</a>), which is dynamic and needs to be iteratively updated with a stride that is given using the TARGETDIST_STRIDE within the optimizer.</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-incomplete-yellow.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2bf1" onclick='showPath("eg2","eg2bf1")'>bf1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__f_o_u_r_i_e_r.html" style="color:green">BF_FOURIER</a> <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg2bf1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg2bf2" onclick='showPath("eg2","eg2bf2")'>bf2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__l_e_g_e_n_d_r_e.html" style="color:green">BF_LEGENDRE</a> <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg2bf2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg2td_wt" onclick='showPath("eg2","eg2td_wt")'>td_wt: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_d__w_e_l_l_t_e_m_p_e_r_e_d.html" style="color:green">TD_WELLTEMPERED</a> <div class="tooltip">BIASFACTOR<div class="right"><b>compulsory keyword </b>
The bias factor used for the well-tempered distribution. <i></i></div></div>=10.0 <span style="display:none;" id="eg2td_wt"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg2b1" onclick='showPath("eg2","eg2b1")'>b1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_v_e_s__l_i_n_e_a_r__e_x_p_a_n_s_i_o_n.html" style="color:green">VES_LINEAR_EXPANSION</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=cv1,cv2 
   <div class="tooltip">BASIS_FUNCTIONS<div class="right"><b>compulsory keyword </b>
the label of the one dimensional basis functions that should be used. <i></i></div></div>=<b name="eg2bf1">bf1</b>,<b name="eg2bf2">bf2</b> 
   <div class="tooltip">TEMP<div class="right">the system temperature - this is needed if the MD code does not pass the temperature
to PLUMED. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">GRID_BINS<div class="right">the number of bins used for the grid. <i></i></div></div>=100 
   
   <div class="tooltip">TARGET_DISTRIBUTION<div class="right">the label of the target distribution to be used. <i></i></div></div>=<b name="eg2td_wt">td_wt</b> 
...<span style="display:none;" id="eg2b1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg2o1" onclick='showPath("eg2","eg2o1")'>o1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_t__a_v_e_r_a_g_e_d__s_g_d.html" style="color:green">OPT_AVERAGED_SGD</a> ...
   <div class="tooltip">BIAS<div class="right"><b>compulsory keyword </b>
the label of the VES bias to be optimized <i></i></div></div>=<b name="eg2b1">b1</b> 
   <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword </b>
the frequency of updating the coefficients given in the number of MD steps. <i></i></div></div>=1000 
   
   <div class="tooltip">STEPSIZE<div class="right"><b>compulsory keyword </b>
the step size used for the optimization <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">FES_OUTPUT<div class="right">how often the FES(s) should be written out to file. <i></i></div></div>=500 
   <div class="tooltip">COEFFS_OUTPUT<div class="right"><b>compulsory keyword ( default=100 )</b>
how often the coefficients should be written to file. <i></i></div></div>=10 
   <div class="tooltip">TARGETDIST_STRIDE<div class="right">stride for updating a target distribution that is iteratively updated during the
optimization. <i></i></div></div>=500 
...<span style="display:none;" id="eg2o1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>In the following example we employ a bias cutoff such that the bias only fills the free energy landscape up a certain level. In this case the target distribution is also dynamic and needs to iteratively updated.</p>

<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-incomplete-yellow.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg3bf1" onclick='showPath("eg3","eg3bf1")'>bf1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__l_e_g_e_n_d_r_e.html" style="color:green">BF_LEGENDRE</a> <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg3bf1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg3bf2" onclick='showPath("eg3","eg3bf2")'>bf2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__l_e_g_e_n_d_r_e.html" style="color:green">BF_LEGENDRE</a> <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg3bf2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg3b1" onclick='showPath("eg3","eg3b1")'>b1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_v_e_s__l_i_n_e_a_r__e_x_p_a_n_s_i_o_n.html" style="color:green">VES_LINEAR_EXPANSION</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=cv1,cv2 
   <div class="tooltip">BASIS_FUNCTIONS<div class="right"><b>compulsory keyword </b>
the label of the one dimensional basis functions that should be used. <i></i></div></div>=<b name="eg3bf1">bf1</b>,<b name="eg3bf2">bf2</b> 
   <div class="tooltip">TEMP<div class="right">the system temperature - this is needed if the MD code does not pass the temperature
to PLUMED. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">GRID_BINS<div class="right">the number of bins used for the grid. <i></i></div></div>=100 
   
   <div class="tooltip">BIAS_CUTOFF<div class="right">cutoff the bias such that it only fills the free energy surface up to certain level
F_cutoff, here you should give the value of the F_cutoff. <i></i></div></div>=20.0 
...<span style="display:none;" id="eg3b1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg3o1" onclick='showPath("eg3","eg3o1")'>o1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_o_p_t__a_v_e_r_a_g_e_d__s_g_d.html" style="color:green">OPT_AVERAGED_SGD</a> ...
   <div class="tooltip">BIAS<div class="right"><b>compulsory keyword </b>
the label of the VES bias to be optimized <i></i></div></div>=<b name="eg3b1">b1</b> 
   <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword </b>
the frequency of updating the coefficients given in the number of MD steps. <i></i></div></div>=1000 
   
   <div class="tooltip">STEPSIZE<div class="right"><b>compulsory keyword </b>
the step size used for the optimization <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">FES_OUTPUT<div class="right">how often the FES(s) should be written out to file. <i></i></div></div>=500 
   <div class="tooltip">COEFFS_OUTPUT<div class="right"><b>compulsory keyword ( default=100 )</b>
how often the coefficients should be written to file. <i></i></div></div>=10 
   <div class="tooltip">TARGETDIST_STRIDE<div class="right">stride for updating a target distribution that is iteratively updated during the
optimization. <i></i></div></div>=500 
...<span style="display:none;" id="eg3o1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>The optimized bias potential can then be used as a static bias for obtaining kinetics. For this you need read in the final coefficients from file (e.g. coeffs_final.data in this case) by using the COEFFS keyword (also, no optimizer should be defined in the input) </p>
<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-incomplete-yellow.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg4bf1" onclick='showPath("eg4","eg4bf1")'>bf1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__l_e_g_e_n_d_r_e.html" style="color:green">BF_LEGENDRE</a> <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg4bf1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg4bf2" onclick='showPath("eg4","eg4bf2")'>bf2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__l_e_g_e_n_d_r_e.html" style="color:green">BF_LEGENDRE</a> <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> <span style="display:none;" id="eg4bf2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg4b1" onclick='showPath("eg4","eg4b1")'>b1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_v_e_s__l_i_n_e_a_r__e_x_p_a_n_s_i_o_n.html" style="color:green">VES_LINEAR_EXPANSION</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=cv1,cv2 
   <div class="tooltip">BASIS_FUNCTIONS<div class="right"><b>compulsory keyword </b>
the label of the one dimensional basis functions that should be used. <i></i></div></div>=<b name="eg4bf1">bf1</b>,<b name="eg4bf2">bf2</b> 
   <div class="tooltip">TEMP<div class="right">the system temperature - this is needed if the MD code does not pass the temperature
to PLUMED. <i></i></div></div>=<span style="background-color:yellow">__FILL__</span> 
   <div class="tooltip">GRID_BINS<div class="right">the number of bins used for the grid. <i></i></div></div>=100 
   
   <div class="tooltip">BIAS_CUTOFF<div class="right">cutoff the bias such that it only fills the free energy surface up to certain level
F_cutoff, here you should give the value of the F_cutoff. <i></i></div></div>=20.0 
   <div class="tooltip">COEFFS<div class="right">read in the coefficients from files. <i></i></div></div>=coeffs_final.data 
...<span style="display:none;" id="eg4b1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> force2 </b> </td><td>the instantaneous value of the squared force due to this bias potential.   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> BASIS_FUNCTIONS </b> </td><td>the label of the one dimensional basis functions that should be used.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td><p class="starttd">( default=off ) calculate the derivatives for these quantities numerically  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature - this is needed if the MD code does not pass the temperature to PLUMED.   </td></tr>
<tr>
<td width="15%"><b> BIAS_FILE </b> </td><td>filename of the file on which the bias should be written out. By default it is bias.LABEL.data. Note that suffixes indicating the iteration number (iter-#) are added to the filename when optimizing coefficients.   </td></tr>
<tr>
<td width="15%"><b> FES_FILE </b> </td><td>filename of the file on which the FES should be written out. By default it is fes.LABEL.data. Note that suffixes indicating the iteration number (iter-#) are added to the filename when optimizing coefficients.   </td></tr>
<tr>
<td width="15%"><b> TARGETDIST_FILE </b> </td><td>filename of the file on which the target distribution should be written out. By default it is targetdist.LABEL.data. Note that suffixes indicating the iteration number (iter-#) are added to the filename when optimizing coefficients and the target distribution is dynamic.   </td></tr>
<tr>
<td width="15%"><b> OPTIMIZATION_THRESHOLD </b> </td><td>Threshold value to turn off optimization of localized basis functions.   </td></tr>
<tr>
<td width="15%"><b> COEFFS </b> </td><td>read in the coefficients from files.   </td></tr>
<tr>
<td width="15%"><b> TARGET_DISTRIBUTION </b> </td><td>the label of the target distribution to be used.   </td></tr>
<tr>
<td width="15%"><b> BIAS_CUTOFF </b> </td><td>cutoff the bias such that it only fills the free energy surface up to certain level F_cutoff, here you should give the value of the F_cutoff.   </td></tr>
<tr>
<td width="15%"><b> BIAS_CUTOFF_FERMI_LAMBDA </b> </td><td>the lambda value used in the Fermi switching function for the bias cutoff (BIAS_CUTOFF), the default value is 10.0.   </td></tr>
<tr>
<td width="15%"><b> GRID_BINS </b> </td><td>the number of bins used for the grid. The default value is 100 bins per dimension.   </td></tr>
<tr>
<td width="15%"><b> PROJ_ARG </b> </td><td>arguments for doing projections of the FES or the target distribution.. You can use multiple instances of this keyword i.e. PROJ_ARG1, PROJ_ARG2, PROJ_ARG3...   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_v_e_s.html">Variationally Enhanced Sampling (VES code)</a></li><li class="navelem"><a class="el" href="ves_biases.html">Biases</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
