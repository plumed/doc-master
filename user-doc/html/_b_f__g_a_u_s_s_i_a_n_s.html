<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: BF_GAUSSIANS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_b_f__g_a_u_s_s_i_a_n_s.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">BF_GAUSSIANS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the ves <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=ves . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Gaussian basis functions.</p>
<dl class="section attention"><dt>Attention</dt><dd><b>These basis functions do not form orthogonal bases. We recommend using wavelets (<a class="el" href="_b_f__w_a_v_e_l_e_t_s.html">BF_WAVELETS</a>) instead that do form orthogonal bases</b>.</dd></dl>
<p>Basis functions given by Gaussian distributions with shifted centers defined on a bounded interval. See <a class="el" href="citelist.html#CITEREF_ValssonPampel_Wavelets_2022">[83]</a> for full details.</p>
<p>You need to provide the interval \([a,b]\) on which the bias is to be expanded. The ORDER keyword of the basis set \(N\) determines the number of equally sized sub-intervalls to be used. On the borders of each of these sub-intervalls the mean \(\mu\) of a Gaussian basis function is placed: </p><p class="formulaDsp">
\begin{align} \mu_i = a + (i-1) \frac{b-a}{N} \end{align}
</p>
<p>The total number of basis functions is \(N+4\) as the constant \(f_{0}(x)=1\), as well as two additional Gaussians at the Boundaries are also included.</p>
<p>The basis functions are given by </p><p class="formulaDsp">
\begin{align} f_0(x) &amp;= 1 \\ f_i(x) &amp;= \exp\left(-\frac{{\left(x-\mu_i\right)}^2}{2\sigma^2}\right) \end{align}
</p>
<p>When the Gaussians are used for a periodic CV (with the PERIODIC keyword), the sub-intervals are chosen in the same way, but only \(N+1\) functions are required to fill it (the ones at the boundary coincide and the ones outside can be omitted).</p>
<p>It is possible to specify the width \(\sigma\) (i.e. the standard deviation) of the Gaussians using the WIDTH keyword. By default it is set to the sub-intervall length. It was found that performance can be typically improved with a smaller value (around 75 % of the sub-interval length), although a too small overlap will prevent the basis set from working correctly at all.</p>
<p>The optimization procedure then adjusts the heigths of the individual Gaussians. To avoid 'blind' optimization of the basis functions outside the currently sampled area, it is often beneficial to use the OPTIMIZATION_THRESHOLD keyword of the VES_LINEAR_EXPANSION (set it to a small value, e.g. 1e-6)</p>
<p>As an example two adjacent basis functions (with the mentioned width choice of 75% of the sub-interval length) can be seen below. The full basis consists of shifted Gaussians in the full specified interval.</p>
<div class="image">
<img src="ves_basisf-gaussians.png" alt=""/>
</div>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The bias is expanded with Gaussian functions in the intervall from 0.0 to 10.0 using order 20. This results in 24 basis functions.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1bfG" onclick='showPath("eg1","eg1bfG")'>bfG: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__g_a_u_s_s_i_a_n_s.html" style="color:green">BF_GAUSSIANS</a> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=0.0 <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=10.0 <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=20 <span style="display:none;" id="eg1bfG">The BF_GAUSSIANS action with label <b>bfG</b></span>
</pre>
<p>Because it was not specified, the width of the Gaussians is by default set to the sub-intervall length, i.e. \(\sigma=0.5\). To e.g. enhance the overlap between neighbouring basis functions, it can be specified explicitely:</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2bfG" onclick='showPath("eg2","eg2bfG")'>bfG: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__g_a_u_s_s_i_a_n_s.html" style="color:green">BF_GAUSSIANS</a> <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=0.0 <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=10.0 <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=20 <div class="tooltip">WIDTH<div class="right">The width (i.e. <i></i></div></div>=0.7 <span style="display:none;" id="eg2bfG">The BF_GAUSSIANS action with label <b>bfG</b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ORDER </b> </td><td>The order of the basis function expansion.   </td></tr>
<tr>
<td width="15%"><b> MINIMUM </b> </td><td>The minimum of the interval on which the basis functions are defined.   </td></tr>
<tr>
<td width="15%"><b> MAXIMUM </b> </td><td>The maximum of the interval on which the basis functions are defined.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> DEBUG_INFO </b> </td><td>( default=off ) Print out more detailed information about the basis set. Useful for debugging.   </td></tr>
<tr>
<td width="15%"><b> PERIODIC </b> </td><td><p class="starttd">( default=off ) Use periodic version of basis set.  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> WIDTH </b> </td><td>The width (i.e. standart deviation) of the Gaussian functions. By default it is equal to the sub-intervall size.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_v_e_s.html">Variationally Enhanced Sampling (VES code)</a></li><li class="navelem"><a class="el" href="ves_basisf.html">Basis functions</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
