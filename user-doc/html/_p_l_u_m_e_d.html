<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: PLUMED</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_l_u_m_e_d.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PLUMED </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the generic <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Embed a separate PLUMED instance.</p>
<p>This command can be used to embed a separate PLUMED instance. Only required atoms will be passed to that instance, using an interface that is similar to the one used when calling PLUMED from the NAMD engine.</p>
<p>Notice that the two instances are running in the same UNIX process, so that they cannot be perfectly isolated. However, most of the features are expected to work correctly.</p>
<p>Notes:</p><ul>
<li>The <a class="el" href="_l_o_a_d.html">LOAD</a> action will not work correctly since registers will be shared among the two instances. In particular, the loaded actions will be visible to both guest and host irrespective of where they are loaded from. This can be fixed and will probably be fixed in a later version.</li>
<li><code>CHDIR</code> is not thread safe. However, in most implementations there will be a single process running PLUMED, with perhaps multiple OpenMP threads spawn in order to parallelize the calculation of individual variables. So, this is likely not a problem.</li>
<li>MPI is working correctly. However, notice that the guest PLUMED will always run with a single process. Multiple replicas should be handled correctly.</li>
</ul>
<p>As an advanced feature, one can use the option <code>KERNEL</code> to select the version of the guest PLUMED instance. In particular, an empty <code>KERNEL</code> (default) implies that the guest PLUMED instance is the same as the host one (no library is loaded). On the other hand, <code>KERNEL=/path/to/libplumedKernel.so</code> will allow specifying a library to be loaded for the guest instance. In addition to those mentioned above, this feature has limitations mostly related to clashes in the symbols defined in the different instances of the PLUMED library. Clashes might be due by synonymous symbols from the PLUMED library or synonymous symbols from libraries linked to PLUMED, and would differ depending on the operating system you are using:</p><ul>
<li>On OSX:<ul>
<li>Symbols from the PLUMED library would clash. The only way to avoid is to load PLUMED dynamically:<ul>
<li>If you are are using PLUMED with an MD code, it should be patched with <code>--runtime</code>.</li>
<li>If you are using PLUMED driver, you should launch the <code>plumed-runtime</code> executable (contained in the <code>prefix/lib/plumed/</code> directory) and export <code>PLUMED_KERNEL</code> equal to the path of the host kernel library (as usual in runtime loading). Notice that as of PLUMED 2.10 we load kernels with RTLD_LOCAL by default.</li>
<li>Symbols from dependent libraries should not clash since, as of version 2.5, we are using two-level namespace. Problems when loading previous versions should anyway be solved using runtime mode as explained above.</li>
</ul>
</li>
</ul>
</li>
<li>On Linux, any <code>KERNEL</code> should in principle work correctly. To achieve namespace separation we are loading the guest kernel with <code>RTLD_DEEPBIND</code>. However, this might create difficult to track problems in other linked libraries.</li>
<li>On Unix systems where <code>RTLD_DEEPBIND</code> is not available kernels will not load correctly.</li>
<li><p class="startli">In general, there might be unexpected crashes. Particularly difficult are situations where different kernels were compiled with different libraries.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd></dd></dl>
</li>
</ul>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>Here an example plumed file: </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># plumed.dat</span>
<b name="eg1p" onclick='showPath("eg1","eg1p")'>p: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_p_l_u_m_e_d.html" style="color:green">PLUMED</a> <div class="tooltip">FILE<div class="right">input file for the guest PLUMED instance <i></i></div></div>=plumed2.dat <span style="display:none;" id="eg1p">The PLUMED action with label <b>p</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1p">p.bias</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p> <code>plumed2.dat</code> can be an arbitrary plumed input file, for instance </p>
<div style="width: 80%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg2_button" onclick='swapInput("eg2")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg2"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg2Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg2Load);
}
function eg2Load(event) {
       swapInput("eg2");
}
</script>
<div style="display:none;" id="eg2short">
<pre style="width: 97%;" class="fragment">
<span style="color:blue">#SETTINGS FILENAME=plumed2.dat</span>
<span style="color:blue"># plumed2.dat</span>
<b name="eg2shortd" onclick='showPath("eg2","eg2shortd")'>d: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,10 <span style="display:none;" id="eg2shortd">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_s_t_r_a_i_n_t.html" style="color:green">RESTRAINT</a> <div class="tooltip">ARG<div class="right">the values the harmonic restraint acts upon. <i></i></div></div>=<b name="eg2shortd">d</b> <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword ( default=0.0 )</b>
specifies that the restraint is harmonic and what the values of the force constants
on each of the variables are <i></i></div></div>=10 <div class="tooltip">AT<div class="right"><b>compulsory keyword </b>
the position of the restraint <i></i></div></div>=2 <span style="display:none;" id="eg2short">The RESTRAINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg2long"><pre style="width: 97%;" class="fragment">
<span style="color:blue">#SETTINGS FILENAME=plumed2.dat</span>
<span style="color:blue"># plumed2.dat</span>
<b name="eg2longd" onclick='showPath("eg2","eg2longd")'>d: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,10 <span style="display:none;" id="eg2longd">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
</pre>
</div>
<p>Now a more useful example. Imagine that you ran simulations using two different PLUMED input files. The files are long and complex and there are some clashes in the name of the variables (that is: same names are used in both files, same files are written, etc). In addition, files might have been written using different units (see <a class="el" href="_u_n_i_t_s.html">UNITS</a>`). If you want to run a single simulation with a bias potential that is the sum of the two bias potentials, you can:</p><ul>
<li>Place the two input files, as well as all the files required by plumed, in separate directories <code>directory1</code> and <code>directory2</code>.</li>
<li>Run with the following input file in the parent directory: 
<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># plumed.dat</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_l_u_m_e_d.html" style="color:green">PLUMED</a> <div class="tooltip">FILE<div class="right">input file for the guest PLUMED instance <i></i></div></div>=plumed.dat <div class="tooltip">CHDIR<div class="right">run guest in a separate directory <i></i></div></div>=directory1 <span style="display:none;" id="eg3"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_l_u_m_e_d.html" style="color:green">PLUMED</a> <div class="tooltip">FILE<div class="right">input file for the guest PLUMED instance <i></i></div></div>=plumed.dat <div class="tooltip">CHDIR<div class="right">run guest in a separate directory <i></i></div></div>=directory2 <span style="display:none;" id="eg3"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
</li>
</ul>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> STRIDE </b> </td><td>( default=1 ) stride different from 1 are not supported yet   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NOREPLICAS </b> </td><td><p class="starttd">( default=off ) run multiple replicas as isolated ones, without letting them know that the host has multiple replicas  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>input file for the guest PLUMED instance   </td></tr>
<tr>
<td width="15%"><b> KERNEL </b> </td><td>kernel to be used for the guest PLUMED instance (USE WITH CAUTION!)   </td></tr>
<tr>
<td width="15%"><b> LOG </b> </td><td>log file for the guest PLUMED instance. By default the host log is used   </td></tr>
<tr>
<td width="15%"><b> CHDIR </b> </td><td>run guest in a separate directory   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_miscellaneous.html">Miscellaneous</a></li><li class="navelem"><a class="el" href="embed.html">Embed a separate PLUMED instance</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
