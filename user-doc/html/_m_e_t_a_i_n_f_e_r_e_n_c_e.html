<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: METAINFERENCE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_m_e_t_a_i_n_f_e_r_e_n_c_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">METAINFERENCE </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the isdb <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculates the Metainference energy for a set of experimental data.</p>
<p>Metainference <a class="el" href="citelist.html#CITEREF_Bonomi:2016ip">[21]</a> is a Bayesian framework to model heterogeneous systems by integrating prior information with noisy, ensemble-averaged data. Metainference models a system and quantifies the level of noise in the data by considering a set of replicas of the system.</p>
<p>Calculated experimental data are given in input as ARG while reference experimental values can be given either from fixed components of other actions using PARARG or as numbers using PARAMETERS. The default behavior is that of averaging the data over the available replicas, if this is not wanted the keyword NOENSEMBLE prevent this averaging.</p>
<p>Metadynamics Metainference <a class="el" href="citelist.html#CITEREF_Bonomi:2016ge">[22]</a> or more in general biased Metainference requires the knowledge of biasing potential in order to calculate the weighted average. In this case the value of the bias can be provided as the last argument in ARG and adding the keyword REWEIGHT. To avoid the noise resulting from the instantaneous value of the bias the weight of each replica can be averaged over a give time using the keyword AVERAGING.</p>
<p>The data can be averaged by using multiple replicas and weighted for a bias if present. The functional form of Metainference can be chosen among four variants selected with NOISE=GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC which correspond to modelling the noise for the arguments as a single gaussian common to all the data points, a gaussian per data point, a single long-tailed gaussian common to all the data points, a log-tailed gaussian per data point or using two distinct noises as for the most general formulation of Metainference. In this latter case the noise of the replica-averaging is gaussian (one per data point) and the noise for the comparison with the experimental data can chosen using the keyword LIKELIHOOD between gaussian or log-normal (one per data point), furthermore the evolution of the estimated average over an infinite number of replicas is driven by DFTILDE.</p>
<p>As for Metainference theory there are two sigma values: SIGMA_MEAN0 represent the error of calculating an average quantity using a finite set of replica and should be set as small as possible following the guidelines for replica-averaged simulations in the framework of the Maximum Entropy Principle. Alternatively, this can be obtained automatically using the internal sigma mean optimization as introduced in <a class="el" href="citelist.html#CITEREF_Lohr:2017gc">[70]</a> (OPTSIGMAMEAN=SEM), in this second case sigma_mean is estimated from the maximum standard error of the mean either over the simulation or over a defined time using the keyword AVERAGING. SIGMA_BIAS is an uncertainty parameter, sampled by a MC algorithm in the bounded interval defined by SIGMA_MIN and SIGMA_MAX. The initial value is set at SIGMA0. The MC move is a random displacement of maximum value equal to DSIGMA. If the number of data point is too large and the acceptance rate drops it is possible to make the MC move over mutually exclusive, random subset of size MC_CHUNKSIZE and run more than one move setting MC_STEPS in such a way that MC_CHUNKSIZE*MC_STEPS will cover all the data points.</p>
<p>Calculated and experimental data can be compared modulo a scaling factor and/or an offset using SCALEDATA and/or ADDOFFSET, the sampling is obtained by a MC algorithm either using a flat or a gaussian prior setting it with SCALE_PRIOR or OFFSET_PRIOR.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In the following example we calculate a set of <a class="el" href="_r_d_c.html">RDC</a>, take the replica-average of them and comparing them with a set of experimental values. RDCs are compared with the experimental data but for a multiplication factor SCALE that is also sampled by MC on-the-fly</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1rdc" onclick='showPath("eg1","eg1rdc")'>rdc: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_d_c.html" style="color:green">RDC</a> ...
   
   <div class="tooltip">SCALE<div class="right"><b>compulsory keyword ( default=1. )</b>
Add the scaling factor to take into account concentration and other effects. <i></i></div></div>=0.0001 
   <div class="tooltip">GYROM<div class="right"><b>compulsory keyword ( default=1. )</b>
Add the product of the gyromagnetic constants for the bond. <i></i></div></div>=-72.5388 
   <div class="tooltip">ATOMS1<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=22,23 
   <div class="tooltip">ATOMS2<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=25,27 
   <div class="tooltip">ATOMS3<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=29,31 
   <div class="tooltip">ATOMS4<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=33,34 
...<span style="display:none;" id="eg1rdc">The RDC action with label <b>rdc</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">rdc.rdc-0</td><td>the calculated # RDC  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">rdc.rdc-1</td><td>the calculated # RDC  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">rdc.rdc-2</td><td>the calculated # RDC  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">rdc.rdc-3</td><td>the calculated # RDC  This is the 3th of these quantities</td></tr>
</table>
</span>
<b name="eg1spe" onclick='showPath("eg1","eg1spe")'>spe: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_i_n_f_e_r_e_n_c_e.html" style="color:green">METAINFERENCE</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg1rdc">rdc.*</b> 
   <div class="tooltip">NOISETYPE<div class="right"><b>compulsory keyword ( default=MGAUSS )</b>
functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC) <i></i></div></div>=MGAUSS 
   <div class="tooltip">PARAMETERS<div class="right">reference values for the experimental data <i></i></div></div>=1.9190,2.9190,3.9190,4.9190 
   <div class="tooltip">SCALEDATA<div class="right">( default=off ) Set to TRUE if you want to sample a scaling factor common to all
values and replicas <i></i></div></div> <div class="tooltip">SCALE0<div class="right"><b> could not find this keyword </b><i></i></div></div>=1 <div class="tooltip">SCALE_MIN<div class="right">minimum value of the scaling factor <i></i></div></div>=0.1 <div class="tooltip">SCALE_MAX<div class="right">maximum value of the scaling factor <i></i></div></div>=3 <div class="tooltip">DSCALE<div class="right">maximum MC move of the scaling factor <i></i></div></div>=0.01 
   <div class="tooltip">SIGMA0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.01 <div class="tooltip">SIGMA_MIN<div class="right"><b>compulsory keyword ( default=0.0 )</b>
minimum value of the uncertainty parameter <i></i></div></div>=0.00001 <div class="tooltip">SIGMA_MAX<div class="right"><b>compulsory keyword ( default=10. )</b>
maximum value of the uncertainty parameter <i></i></div></div>=3 <div class="tooltip">DSIGMA<div class="right">maximum MC move of the uncertainty parameter <i></i></div></div>=0.01 
   <div class="tooltip">SIGMA_MEAN0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.001 
   
...<span style="display:none;" id="eg1spe">The METAINFERENCE action with label <b>spe</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">spe.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">spe.neff</td><td>effective number of replicas</td></tr>
<tr><td width="5%%">spe.scale</td><td>scale parameter</td></tr>
<tr><td width="5%%">spe.acceptScale</td><td>MC acceptance for scale value</td></tr>
<tr><td width="5%%">spe.acceptSigma</td><td>MC acceptance for sigma values</td></tr>
<tr><td width="5%%">spe.sigmaMean-0</td><td>uncertainty in the mean estimate  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">spe.sigma-0</td><td>uncertainty parameter  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">spe.sigmaMean-1</td><td>uncertainty in the mean estimate  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">spe.sigma-1</td><td>uncertainty parameter  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">spe.sigmaMean-2</td><td>uncertainty in the mean estimate  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">spe.sigma-2</td><td>uncertainty parameter  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">spe.sigmaMean-3</td><td>uncertainty in the mean estimate  This is the 3th of these quantities</td></tr>
<tr><td width="5%%">spe.sigma-3</td><td>uncertainty parameter  This is the 3th of these quantities</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1spe">spe.bias</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=BIAS <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p>in the following example instead of using one uncertainty parameter per data point we use a single uncertainty value in a long-tailed gaussian to take into account for outliers, furthermore the data are weighted for the bias applied to other variables of the system.</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2rdc" onclick='showPath("eg2","eg2rdc")'>rdc: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_d_c.html" style="color:green">RDC</a> ...
   
   <div class="tooltip">SCALE<div class="right"><b>compulsory keyword ( default=1. )</b>
Add the scaling factor to take into account concentration and other effects. <i></i></div></div>=0.0001 
   <div class="tooltip">GYROM<div class="right"><b>compulsory keyword ( default=1. )</b>
Add the product of the gyromagnetic constants for the bond. <i></i></div></div>=-72.5388 
   <div class="tooltip">ATOMS1<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=22,23 
   <div class="tooltip">ATOMS2<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=25,27 
   <div class="tooltip">ATOMS3<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=29,31 
   <div class="tooltip">ATOMS4<div class="right">the couple of atoms involved in each of the bonds for which you wish to calculate
the RDC. <i></i></div></div>=33,34 
...<span style="display:none;" id="eg2rdc">The RDC action with label <b>rdc</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">rdc.rdc-0</td><td>the calculated # RDC  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">rdc.rdc-1</td><td>the calculated # RDC  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">rdc.rdc-2</td><td>the calculated # RDC  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">rdc.rdc-3</td><td>the calculated # RDC  This is the 3th of these quantities</td></tr>
</table>
</span>
<b name="eg2cv1" onclick='showPath("eg2","eg2cv1")'>cv1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=1,2,3,4 <span style="display:none;" id="eg2cv1">The TORSION action with label <b>cv1</b> calculates a single scalar value</span>
<b name="eg2cv2" onclick='showPath("eg2","eg2cv2")'>cv2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=2,3,4,5 <span style="display:none;" id="eg2cv2">The TORSION action with label <b>cv2</b> calculates a single scalar value</span>
<b name="eg2mm" onclick='showPath("eg2","eg2mm")'>mm: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2cv1">cv1</b>,<b name="eg2cv2">cv2</b> <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=0.5 <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.3,0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=200 <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics and use this bias factor. <i></i></div></div>=8 <div class="tooltip">WALKERS_MPI<div class="right">( default=off ) Switch on MPI version of multiple walkers - not compatible with WALKERS_*
options other than WALKERS_DIR <i></i></div></div> <span style="display:none;" id="eg2mm">The METAD action with label <b>mm</b> calculates a single scalar value</span>
<b name="eg2spe" onclick='showPath("eg2","eg2spe")'>spe: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_i_n_f_e_r_e_n_c_e.html" style="color:green">METAINFERENCE</a> ...
   <span style="color:blue">#SETTINGS NREPLICAS=2 </span>
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2rdc">rdc.*</b>,<b name="eg2mm">mm.bias</b> 
   <div class="tooltip">REWEIGHT<div class="right">( default=off ) simple REWEIGHT using the latest ARG as energy <i></i></div></div> 
   <div class="tooltip">NOISETYPE<div class="right"><b>compulsory keyword ( default=MGAUSS )</b>
functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC) <i></i></div></div>=OUTLIERS 
   <div class="tooltip">PARAMETERS<div class="right">reference values for the experimental data <i></i></div></div>=1.9190,2.9190,3.9190,4.9190 
   <div class="tooltip">SCALEDATA<div class="right">( default=off ) Set to TRUE if you want to sample a scaling factor common to all
values and replicas <i></i></div></div> <div class="tooltip">SCALE0<div class="right"><b> could not find this keyword </b><i></i></div></div>=1 <div class="tooltip">SCALE_MIN<div class="right">minimum value of the scaling factor <i></i></div></div>=0.1 <div class="tooltip">SCALE_MAX<div class="right">maximum value of the scaling factor <i></i></div></div>=3 <div class="tooltip">DSCALE<div class="right">maximum MC move of the scaling factor <i></i></div></div>=0.01 
   <div class="tooltip">SIGMA0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.01 <div class="tooltip">SIGMA_MIN<div class="right"><b>compulsory keyword ( default=0.0 )</b>
minimum value of the uncertainty parameter <i></i></div></div>=0.00001 <div class="tooltip">SIGMA_MAX<div class="right"><b>compulsory keyword ( default=10. )</b>
maximum value of the uncertainty parameter <i></i></div></div>=3 <div class="tooltip">DSIGMA<div class="right">maximum MC move of the uncertainty parameter <i></i></div></div>=0.01 
   <div class="tooltip">SIGMA_MEAN0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.001 
   
...<span style="display:none;" id="eg2spe">The METAINFERENCE action with label <b>spe</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">spe.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">spe.biasDer</td><td>derivatives with respect to the bias</td></tr>
<tr><td width="5%%">spe.weight</td><td>weights of the weighted average</td></tr>
<tr><td width="5%%">spe.neff</td><td>effective number of replicas</td></tr>
<tr><td width="5%%">spe.scale</td><td>scale parameter</td></tr>
<tr><td width="5%%">spe.acceptScale</td><td>MC acceptance for scale value</td></tr>
<tr><td width="5%%">spe.acceptSigma</td><td>MC acceptance for sigma values</td></tr>
<tr><td width="5%%">spe.sigmaMean</td><td>uncertainty in the mean estimate</td></tr>
<tr><td width="5%%">spe.sigma</td><td>uncertainty parameter</td></tr>
</table>
</span>
</pre>
<p>(See also <a class="el" href="_r_d_c.html">RDC</a>, <a class="el" href="_p_b_m_e_t_a_d.html">PBMETAD</a>).</p>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> sigma </b> </td><td>uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> sigmaMean </b> </td><td>uncertainty in the mean estimate   </td></tr>
<tr>
<td width="15%"><b> neff </b> </td><td>effective number of replicas   </td></tr>
<tr>
<td width="15%"><b> acceptSigma </b> </td><td>MC acceptance for sigma values   </td></tr>
</table>
<p>In addition the following quantities can be calculated by employing the keywords listed below</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> acceptScale </b> </td><td width="10%"><b> SCALEDATA </b>  </td><td>MC acceptance for scale value   </td></tr>
<tr>
<td width="5%"><b> acceptFT </b> </td><td width="10%"><b> GENERIC </b>  </td><td>MC acceptance for general metainference f tilde value   </td></tr>
<tr>
<td width="5%"><b> weight </b> </td><td width="10%"><b> REWEIGHT </b>  </td><td>weights of the weighted average   </td></tr>
<tr>
<td width="5%"><b> biasDer </b> </td><td width="10%"><b> REWEIGHT </b>  </td><td>derivatives with respect to the bias   </td></tr>
<tr>
<td width="5%"><b> scale </b> </td><td width="10%"><b> SCALEDATA </b>  </td><td>scale parameter   </td></tr>
<tr>
<td width="5%"><b> offset </b> </td><td width="10%"><b> ADDOFFSET </b>  </td><td>offset parameter   </td></tr>
<tr>
<td width="5%"><b> ftilde </b> </td><td width="10%"><b> GENERIC </b>  </td><td>ensemble average estimator   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> NOISETYPE </b> </td><td>( default=MGAUSS ) functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC)   </td></tr>
<tr>
<td width="15%"><b> LIKELIHOOD </b> </td><td>( default=GAUSS ) the likelihood for the GENERIC metainference model, GAUSS or LOGN   </td></tr>
<tr>
<td width="15%"><b> DFTILDE </b> </td><td>( default=0.1 ) fraction of sigma_mean used to evolve ftilde   </td></tr>
<tr>
<td width="15%"><b> SCALE0 </b> </td><td>( default=1.0 ) initial value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> SCALE_PRIOR </b> </td><td>( default=FLAT ) either FLAT or GAUSSIAN   </td></tr>
<tr>
<td width="15%"><b> OFFSET0 </b> </td><td>( default=0.0 ) initial value of the offset   </td></tr>
<tr>
<td width="15%"><b> OFFSET_PRIOR </b> </td><td>( default=FLAT ) either FLAT or GAUSSIAN   </td></tr>
<tr>
<td width="15%"><b> SIGMA0 </b> </td><td>( default=1.0 ) initial value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MIN </b> </td><td>( default=0.0 ) minimum value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MAX </b> </td><td>( default=10. ) maximum value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> OPTSIGMAMEAN </b> </td><td>( default=NONE ) Set to NONE/SEM to manually set sigma mean, or to estimate it on the fly   </td></tr>
<tr>
<td width="15%"><b> WRITE_STRIDE </b> </td><td>( default=10000 ) write the status to a file every N steps, this can be used for restart/continuation   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOENSEMBLE </b> </td><td>( default=off ) don't perform any replica-averaging   </td></tr>
<tr>
<td width="15%"><b> REWEIGHT </b> </td><td>( default=off ) simple REWEIGHT using the latest ARG as energy   </td></tr>
<tr>
<td width="15%"><b> SCALEDATA </b> </td><td>( default=off ) Set to TRUE if you want to sample a scaling factor common to all values and replicas   </td></tr>
<tr>
<td width="15%"><b> ADDOFFSET </b> </td><td><p class="starttd">( default=off ) Set to TRUE if you want to sample an offset common to all values and replicas  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> PARARG </b> </td><td>reference values for the experimental data, these can be provided as arguments without derivatives   </td></tr>
<tr>
<td width="15%"><b> PARAMETERS </b> </td><td>reference values for the experimental data   </td></tr>
<tr>
<td width="15%"><b> AVERAGING </b> </td><td>Stride for calculation of averaged weights and sigma_mean   </td></tr>
<tr>
<td width="15%"><b> SCALE_MIN </b> </td><td>minimum value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> SCALE_MAX </b> </td><td>maximum value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> DSCALE </b> </td><td>maximum MC move of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> OFFSET_MIN </b> </td><td>minimum value of the offset   </td></tr>
<tr>
<td width="15%"><b> OFFSET_MAX </b> </td><td>maximum value of the offset   </td></tr>
<tr>
<td width="15%"><b> DOFFSET </b> </td><td>maximum MC move of the offset   </td></tr>
<tr>
<td width="15%"><b> REGRES_ZERO </b> </td><td>stride for regression with zero offset   </td></tr>
<tr>
<td width="15%"><b> DSIGMA </b> </td><td>maximum MC move of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MEAN0 </b> </td><td>starting value for the uncertainty in the mean estimate   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MAX_STEPS </b> </td><td>Number of steps used to optimise SIGMA_MAX, before that the SIGMA_MAX value is used   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature - this is only needed if code doesn't pass the temperature to plumed   </td></tr>
<tr>
<td width="15%"><b> MC_STEPS </b> </td><td>number of MC steps   </td></tr>
<tr>
<td width="15%"><b> MC_CHUNKSIZE </b> </td><td>MC chunksize   </td></tr>
<tr>
<td width="15%"><b> STATUS_FILE </b> </td><td>write a file with all the data useful for restart/continuation of Metainference   </td></tr>
<tr>
<td width="15%"><b> SELECTOR </b> </td><td>name of selector   </td></tr>
<tr>
<td width="15%"><b> NSELECT </b> </td><td>range of values for selector [0, N-1]   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_i_s_d_b.html">PLUMED-ISDB</a></li><li class="navelem"><a class="el" href="_i_s_d_b_bias.html">Biases Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
