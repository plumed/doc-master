<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: REWEIGHT_TEMP_PRESS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">REWEIGHT_TEMP_PRESS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the bias <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculate weights for ensemble averages at temperatures and/or pressures different than those used in your original simulation.</p>
<p>We can use our knowledge of the probability distribution in the canonical (N \(\mathcal{V}\)T) or the isothermal-isobaric ensemble (NPT) to reweight the data contained in trajectories and obtain ensemble averages at different temperatures and/or pressures.</p>
<p>Consider the ensemble average of an observable \(O(\mathbf{R},\mathcal{V})\) that depends on the atomic coordinates \(\mathbf{R}\) and the volume \(\mathcal{V}\). This observable is in practice any collective variable (CV) calculated by Plumed. The ensemble average of the observable in an ensemble \( \xi&#39; \) can be calculated from a simulation performed in an ensemble \( \xi \) using: </p><p class="formulaDsp">
\[ \langle O(\mathbf{R},\mathcal{V}) \rangle_{\xi&#39;} = \frac{\langle O(\mathbf{R},\mathcal{V}) w(\mathbf{R},\mathcal{V}) \rangle_{\xi}} {\langle w(\mathbf{R},\mathcal{V}) \rangle_{\xi}} \]
</p>
<p> where \(\langle \cdot \rangle_{\xi}\) and \(\langle \cdot \rangle_{\xi&#39;}\) are mean values in the simulated and targeted ensemble, respectively, \( E(\mathbf{R}) \) is the potential energy of the system, and \( w (\mathbf{R},\mathcal{V}) \) are the appropriate weights to take from \( \xi \) to \( \xi&#39; \). This action calculates the weights \( w (\mathbf{R},\mathcal{V}) \) and handles 4 different cases:</p><ol type="1">
<li>Change of temperature from T to T' at constant volume. That is to say, from a simulation performed in the N \(\mathcal{V}\)T (canonical) ensemble, obtain an ensemble average in the N \(\mathcal{V}\)T' ensemble. The weights in this case are \( w(\mathbf{R},\mathcal{V}) = e^{(\beta-\beta&#39;)E(\mathbf{R})} \) with \( \beta \) and \( \beta&#39; \) the inverse temperatures.</li>
<li>Change of temperature from T to T' at constant pressure. That is to say, from a simulation performed in the NPT (isothermal-isobaric) ensemble, obtain an ensemble average in the NPT' ensemble. The weights in this case are \( w(\mathbf{R},\mathcal{V}) = e^{(\beta-\beta&#39;)(E(\mathbf{R}) + P\mathcal{V}) } \).</li>
<li>Change of pressure from P to P' at constant temperature. That is to say, from a simulation performed in the NPT (isothermal-isobaric) ensemble, obtain an ensemble average in the NP'T ensemble. The weights in this case are \( w(\mathbf{R},\mathcal{V}) = e^{\beta (P - P&#39;) \mathcal{V}} \).</li>
<li>Change of temperature and pressure from T,P to T',P'. That is to say, from a simulation performed in the NPT (isothermal-isobaric) ensemble, obtain an ensemble average in the NP'T' ensemble. The weights in this case are \( w(\mathbf{R},\mathcal{V}) = e^{(\beta-\beta&#39;)E(\mathbf{R}) + (\beta P - \beta&#39; P&#39;) \mathcal{V}} \).</li>
</ol>
<p>These weights can be used in any action that computes ensemble averages. For example this action can be used in tandem with <a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a> or <a class="el" href="_a_v_e_r_a_g_e.html">AVERAGE</a>.</p>
<p>The above equation is often impractical since the overlap between the distributions of energy and volume at different temperatures and pressures is only significant for neighboring temperatures and pressures. For this reason an unbiased simulation is of little use to reweight at different temperatures and/or pressures. A successful approach has been altering the probability of observing a configuration in order to increase this overlap <a class="el" href="citelist.html#CITEREF_wanglandau">[111]</a>. This is done through a bias potential \( V(\mathbf{s}) \) where \( \mathbf{s} \) is a set of CVs, that often is the energy (and possibly the volume). In order to calculate ensemble averages, also the effect of this bias must be taken into account. The ensemble average of the observable in the ensemble \( \xi&#39; \) can be calculated from a biased simulation performed in the ensemble \(\xi\) with bias \( V(\mathbf{s}) \) using: </p><p class="formulaDsp">
\[ \langle O(\mathbf{R},\mathcal{V}) \rangle_{\xi&#39;} = \frac{\langle O(\mathbf{R},\mathcal{V}) w (\mathbf{R},\mathcal{V}) e^{\beta V(\mathbf{s})} \rangle_{\xi,V}} {\langle w (\mathbf{R},\mathcal{V}) e^{\beta V(\mathbf{s})} \rangle_{\xi,V}} \]
</p>
<p> where \(\langle \cdot \rangle_{\xi,V}\) is a mean value in the biased ensemble with static bias \( V(\mathbf{s}) \). Therefore in order to reweight the trajectory at different temperatures and/or pressures one must use the weights calculated by this action \( w (\mathbf{R},\mathcal{V}) \) together with the weights of <a class="el" href="_r_e_w_e_i_g_h_t__b_i_a_s.html">REWEIGHT_BIAS</a> (see the examples below).</p>
<p>The bias potential \( V(\mathbf{s}) \) can be constructed with <a class="el" href="_m_e_t_a_d.html">METAD</a> using <a class="el" href="_e_n_e_r_g_y.html">ENERGY</a> as a CV <a class="el" href="citelist.html#CITEREF_mich+04prl">[75]</a>. More specialized tools are available, for instance using bespoke target distributions such as <a class="el" href="_t_d__m_u_l_t_i_c_a_n_o_n_i_c_a_l.html">TD_MULTICANONICAL</a> and <a class="el" href="_t_d__m_u_l_t_i_t_h_e_r_m_a_l__m_u_l_t_i_b_a_r_i_c.html">TD_MULTITHERMAL_MULTIBARIC</a> <a class="el" href="citelist.html#CITEREF_Piaggi-PRL-2019">[86]</a> <a class="el" href="citelist.html#CITEREF_Piaggi-JCP-2019">[87]</a> within <a class="el" href="_v_e_s.html">Variationally Enhanced Sampling (VES code)</a>. In the latter algorithms the interval of temperatures and pressures in which the trajectory can be reweighted is chosen explicitly.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>We consider the 4 cases described above.</p>
<p>The following input can be used to postprocess a molecular dynamics trajectory of a system of 1000 particles run at 500 K and constant volume using a static bias potential.</p>

<div style="width: 80%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg1_button" onclick='swapInput("eg1")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg1"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg1Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg1Load);
}
function eg1Load(event) {
       swapInput("eg1");
}
</script>
<div style="display:none;" id="eg1short">
<pre style="width: 97%;" class="fragment">
<b name="eg1shortenergy" onclick='showPath("eg1","eg1shortenergy")'>energy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg1shortenergy">energy</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg1shortenergy">The READ action with label <b>energy</b> calculates a single scalar value</span>
<b name="eg1shortdistance" onclick='showPath("eg1","eg1shortdistance")'>distance: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg1shortdistance">distance</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg1shortdistance">The READ action with label <b>distance</b> calculates a single scalar value</span>
<b name="eg1shortmybias" onclick='showPath("eg1","eg1shortmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg1shortmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg1shortmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift energy (to avoid numerical issues)</span>
<b name="eg1shortrenergy" onclick='showPath("eg1","eg1shortrenergy")'>renergy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg1shortenergy">energy</b> <div class="tooltip">PARAMETERS<div class="right"><b>compulsory keyword ( default=0.0 )</b>
the parameters of the arguments in your function <i></i></div></div>=-13250 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg1shortrenergy">The COMBINE action with label <b>renergy</b> calculates a single scalar value</span>
<span style="color:blue"># Weights</span>
<b name="eg1shortbias_weights" onclick='showPath("eg1","eg1shortbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg1shortmybias">mybias.bias</b> <span style="display:none;" id="eg1shortbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg1shorttemp_press_weights" onclick='showPath("eg1","eg1shorttemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">REWEIGHT_TEMP<div class="right">Reweighting temperature <i></i></div></div>=300 <div class="tooltip">ENERGY<div class="right">Energy <i></i></div></div>=<b name="eg1shortrenergy">renergy</b> <span style="display:none;" id="eg1shorttemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the distance at 300 K</span>
<b name="eg1shortavg_dist" onclick='showPath("eg1","eg1shortavg_dist")'>avg_dist: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_a_v_e_r_a_g_e.html" style="color:green">AVERAGE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the quantity that is being averaged <i></i></div></div>=<b name="eg1shortdistance">distance</b> <div class="tooltip">LOGWEIGHTS<div class="right">the logarithm of the quantity to use as the weights when calculating averages <i></i></div></div>=<b name="eg1shortbias_weights">bias_weights</b>,<b name="eg1shorttemp_press_weights">temp_press_weights</b> <span style="display:none;" id="eg1shortavg_dist">The AVERAGE action with label <b>avg_dist</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1shortavg_dist">avg_dist</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR_REWEIGHT <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <span style="display:none;" id="eg1short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg1long"><pre style="width: 97%;" class="fragment">
<b name="eg1longenergy" onclick='showPath("eg1","eg1longenergy")'>energy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg1longenergy">energy</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg1longenergy">The READ action with label <b>energy</b> calculates a single scalar value</span>
<b name="eg1longdistance" onclick='showPath("eg1","eg1longdistance")'>distance: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg1longdistance">distance</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg1longdistance">The READ action with label <b>distance</b> calculates a single scalar value</span>
<b name="eg1longmybias" onclick='showPath("eg1","eg1longmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg1longmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg1longmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift energy (to avoid numerical issues)</span>
<span style="color:blue"># Weights</span>
<b name="eg1longbias_weights" onclick='showPath("eg1","eg1longbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg1longmybias">mybias.bias</b> <span style="display:none;" id="eg1longbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg1longtemp_press_weights" onclick='showPath("eg1","eg1longtemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">REWEIGHT_TEMP<div class="right">Reweighting temperature <i></i></div></div>=300 <div class="tooltip">ENERGY<div class="right">Energy <i></i></div></div>=renergy <span style="display:none;" id="eg1longtemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b><p>Clearly, in performing the analysis above we would read from the potential energy, a distance, and the value of the bias potential from a COLVAR file like the one shown below. We would then be able to calculate the ensemble average of the distance at 300 K.</p>
<pre class="fragment">#! FIELDS time energy volume mybias.bias distance
 10000.000000 -13133.769283 7.488921 63.740530 0.10293
 10001.000000 -13200.239722 7.116548 36.691988 0.16253
 10002.000000 -13165.108850 7.202273 44.408815 0.17625
</pre><p>The next three inputs can be used to postprocess a molecular dynamics trajectory of a system of 1000 particles run at 500 K and 1 bar using a static bias potential.</p>
<p>We read from a file COLVAR the potential energy, the volume, and the value of the bias potential and calculate the ensemble average of the (particle) density at 300 K and 1 bar (the simulation temperature was 500 K).</p>

<div style="width: 80%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg2_button" onclick='swapInput("eg2")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg2"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg2Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg2Load);
}
function eg2Load(event) {
       swapInput("eg2");
}
</script>
<div style="display:none;" id="eg2short">
<pre style="width: 97%;" class="fragment">
<b name="eg2shortenergy" onclick='showPath("eg2","eg2shortenergy")'>energy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg2shortenergy">energy</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg2shortenergy">The READ action with label <b>energy</b> calculates a single scalar value</span>
<b name="eg2shortvolume" onclick='showPath("eg2","eg2shortvolume")'>volume: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg2shortvolume">volume</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg2shortvolume">The READ action with label <b>volume</b> calculates a single scalar value</span>
<b name="eg2shortmybias" onclick='showPath("eg2","eg2shortmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg2shortmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg2shortmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift energy and volume (to avoid numerical issues)</span>
<b name="eg2shortrvol" onclick='showPath("eg2","eg2shortrvol")'>rvol: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg2shortvolume">volume</b> <div class="tooltip">PARAMETERS<div class="right"><b>compulsory keyword ( default=0.0 )</b>
the parameters of the arguments in your function <i></i></div></div>=7.8 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg2shortrvol">The COMBINE action with label <b>rvol</b> calculates a single scalar value</span>
<b name="eg2shortrenergy" onclick='showPath("eg2","eg2shortrenergy")'>renergy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg2shortenergy">energy</b> <div class="tooltip">PARAMETERS<div class="right"><b>compulsory keyword ( default=0.0 )</b>
the parameters of the arguments in your function <i></i></div></div>=-13250 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg2shortrenergy">The COMBINE action with label <b>renergy</b> calculates a single scalar value</span>
<span style="color:blue"># Weights</span>
<b name="eg2shortbias_weights" onclick='showPath("eg2","eg2shortbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg2shortmybias">mybias.bias</b> <span style="display:none;" id="eg2shortbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg2shorttemp_press_weights" onclick='showPath("eg2","eg2shorttemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">REWEIGHT_TEMP<div class="right">Reweighting temperature <i></i></div></div>=300 <div class="tooltip">PRESSURE<div class="right">The system pressure <i></i></div></div>=0.06022140857 <div class="tooltip">ENERGY<div class="right">Energy <i></i></div></div>=<b name="eg2shortrenergy">renergy</b> <div class="tooltip">VOLUME<div class="right">Volume <i></i></div></div>=<b name="eg2shortrvol">rvol</b> <span style="display:none;" id="eg2shorttemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the volume at 300 K</span>
<b name="eg2shortavg_vol" onclick='showPath("eg2","eg2shortavg_vol")'>avg_vol: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_a_v_e_r_a_g_e.html" style="color:green">AVERAGE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the quantity that is being averaged <i></i></div></div>=<b name="eg2shortvolume">volume</b> <div class="tooltip">LOGWEIGHTS<div class="right">the logarithm of the quantity to use as the weights when calculating averages <i></i></div></div>=<b name="eg2shortbias_weights">bias_weights</b>,<b name="eg2shorttemp_press_weights">temp_press_weights</b> <span style="display:none;" id="eg2shortavg_vol">The AVERAGE action with label <b>avg_vol</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the density at 300 K</span>
<b name="eg2shortavg_density" onclick='showPath("eg2","eg2shortavg_density")'>avg_density: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg2shortavg_vol">avg_vol</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=1000/x <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg2shortavg_density">The CUSTOM action with label <b>avg_density</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2shortavg_density">avg_density</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR_REWEIGHT <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <span style="display:none;" id="eg2short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg2long"><pre style="width: 97%;" class="fragment">
<b name="eg2longenergy" onclick='showPath("eg2","eg2longenergy")'>energy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg2longenergy">energy</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg2longenergy">The READ action with label <b>energy</b> calculates a single scalar value</span>
<b name="eg2longvolume" onclick='showPath("eg2","eg2longvolume")'>volume: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg2longvolume">volume</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg2longvolume">The READ action with label <b>volume</b> calculates a single scalar value</span>
<b name="eg2longmybias" onclick='showPath("eg2","eg2longmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg2longmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg2longmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift energy and volume (to avoid numerical issues)</span>
<span style="color:blue"># Weights</span>
<b name="eg2longbias_weights" onclick='showPath("eg2","eg2longbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg2longmybias">mybias.bias</b> <span style="display:none;" id="eg2longbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg2longtemp_press_weights" onclick='showPath("eg2","eg2longtemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">REWEIGHT_TEMP<div class="right">Reweighting temperature <i></i></div></div>=300 <div class="tooltip">PRESSURE<div class="right">The system pressure <i></i></div></div>=0.06022140857 <div class="tooltip">ENERGY<div class="right">Energy <i></i></div></div>=renergy <div class="tooltip">VOLUME<div class="right">Volume <i></i></div></div>=rvol <span style="display:none;" id="eg2longtemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b><p>In the next example we calculate the ensemble average of the (particle) density at 500 K and 300 MPa (the simulation pressure was 1 bar).</p>

<div style="width: 80%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg3_button" onclick='swapInput("eg3")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg3"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg3Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg3Load);
}
function eg3Load(event) {
       swapInput("eg3");
}
</script>
<div style="display:none;" id="eg3short">
<pre style="width: 97%;" class="fragment">
<b name="eg3shortvolume" onclick='showPath("eg3","eg3shortvolume")'>volume: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg3shortvolume">volume</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg3shortvolume">The READ action with label <b>volume</b> calculates a single scalar value</span>
<b name="eg3shortmybias" onclick='showPath("eg3","eg3shortmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg3shortmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg3shortmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift volume (to avoid numerical issues)</span>
<b name="eg3shortrvol" onclick='showPath("eg3","eg3shortrvol")'>rvol: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3shortvolume">volume</b> <div class="tooltip">PARAMETERS<div class="right"><b>compulsory keyword ( default=0.0 )</b>
the parameters of the arguments in your function <i></i></div></div>=7.8 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3shortrvol">The COMBINE action with label <b>rvol</b> calculates a single scalar value</span>
<span style="color:blue"># Weights</span>
<b name="eg3shortbias_weights" onclick='showPath("eg3","eg3shortbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg3shortmybias">mybias.bias</b> <span style="display:none;" id="eg3shortbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg3shorttemp_press_weights" onclick='showPath("eg3","eg3shorttemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">PRESSURE<div class="right">The system pressure <i></i></div></div>=0.06022140857 <div class="tooltip">REWEIGHT_PRESSURE<div class="right">Reweighting pressure <i></i></div></div>=180.66422571 <div class="tooltip">VOLUME<div class="right">Volume <i></i></div></div>=<b name="eg3shortvolume">volume</b> <span style="display:none;" id="eg3shorttemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the volume at 300 K and 300 MPa</span>
<b name="eg3shortavg_vol" onclick='showPath("eg3","eg3shortavg_vol")'>avg_vol: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_a_v_e_r_a_g_e.html" style="color:green">AVERAGE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the quantity that is being averaged <i></i></div></div>=<b name="eg3shortvolume">volume</b> <div class="tooltip">LOGWEIGHTS<div class="right">the logarithm of the quantity to use as the weights when calculating averages <i></i></div></div>=<b name="eg3shortbias_weights">bias_weights</b>,<b name="eg3shorttemp_press_weights">temp_press_weights</b> <span style="display:none;" id="eg3shortavg_vol">The AVERAGE action with label <b>avg_vol</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the density at 300 K and 300 MPa</span>
<b name="eg3shortavg_density" onclick='showPath("eg3","eg3shortavg_density")'>avg_density: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3shortavg_vol">avg_vol</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=1000/x <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3shortavg_density">The CUSTOM action with label <b>avg_density</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg3shortavg_density">avg_density</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR_REWEIGHT <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <span style="display:none;" id="eg3short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg3long"><pre style="width: 97%;" class="fragment">
<b name="eg3longvolume" onclick='showPath("eg3","eg3longvolume")'>volume: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg3longvolume">volume</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg3longvolume">The READ action with label <b>volume</b> calculates a single scalar value</span>
<b name="eg3longmybias" onclick='showPath("eg3","eg3longmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg3longmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg3longmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift volume (to avoid numerical issues)</span>
<span style="color:blue"># Weights</span>
<b name="eg3longbias_weights" onclick='showPath("eg3","eg3longbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg3longmybias">mybias.bias</b> <span style="display:none;" id="eg3longbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg3longtemp_press_weights" onclick='showPath("eg3","eg3longtemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">PRESSURE<div class="right">The system pressure <i></i></div></div>=0.06022140857 <div class="tooltip">REWEIGHT_PRESSURE<div class="right">Reweighting pressure <i></i></div></div>=180.66422571 <div class="tooltip">VOLUME<div class="right">Volume <i></i></div></div>=<b name="eg3longvolume">volume</b> <span style="display:none;" id="eg3longtemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the volume at 300 K and 300 MPa</span>
<b name="eg3longavg_vol_wsum" onclick='showPath("eg3","eg3longavg_vol_wsum")'>avg_vol_wsum: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3longbias_weights">bias_weights</b>,<b name="eg3longtemp_press_weights">temp_press_weights</b> <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3longavg_vol_wsum">The COMBINE action with label <b>avg_vol_wsum</b> calculates a single scalar value</span>
<b name="eg3longavg_vol_weight" onclick='showPath("eg3","eg3longavg_vol_weight")'>avg_vol_weight: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3longavg_vol_wsum">avg_vol_wsum</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=exp(x) <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3longavg_vol_weight">The CUSTOM action with label <b>avg_vol_weight</b> calculates a single scalar value</span>
<b name="eg3longavg_vol_denom" onclick='showPath("eg3","eg3longavg_vol_denom")'>avg_vol_denom: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_a_c_c_u_m_u_l_a_t_e.html" style="color:green">ACCUMULATE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the label of the argument that is being added to on each timestep <i></i></div></div>=<b name="eg3longavg_vol_weight">avg_vol_weight</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=1 <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=0 <span style="display:none;" id="eg3longavg_vol_denom">The ACCUMULATE action with label <b>avg_vol_denom</b> calculates a single scalar value</span>
<b name="eg3longavg_vol_prod" onclick='showPath("eg3","eg3longavg_vol_prod")'>avg_vol_prod: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3longvolume">volume</b>,<b name="eg3longavg_vol_weight">avg_vol_weight</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=x*y <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3longavg_vol_prod">The CUSTOM action with label <b>avg_vol_prod</b> calculates a single scalar value</span>
<b name="eg3longavg_vol_numer" onclick='showPath("eg3","eg3longavg_vol_numer")'>avg_vol_numer: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_a_c_c_u_m_u_l_a_t_e.html" style="color:green">ACCUMULATE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the label of the argument that is being added to on each timestep <i></i></div></div>=<b name="eg3longavg_vol_prod">avg_vol_prod</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the data should be collected and added to the quantity being
averaged <i></i></div></div>=1 <div class="tooltip">CLEAR<div class="right"><b>compulsory keyword ( default=0 )</b>
the frequency with which to clear all the accumulated data. <i></i></div></div>=0 <span style="display:none;" id="eg3longavg_vol_numer">The ACCUMULATE action with label <b>avg_vol_numer</b> calculates a single scalar value</span>
<b name="eg3longavg_vol" onclick='showPath("eg3","eg3longavg_vol")'>avg_vol: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3longavg_vol_numer">avg_vol_numer</b>,<b name="eg3longavg_vol_denom">avg_vol_denom</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=x/y <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3longavg_vol">The CUSTOM action with label <b>avg_vol</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the density at 300 K and 300 MPa</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=avg_density <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR_REWEIGHT <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <span style="display:none;" id="eg3long">The PRINT action with label <b></b><p>In this final example we calculate the ensemble average of the (particle) density at 300 K and 300 MPa (the simulation temperature and pressure were 500 K and 1 bar).</p>

<div style="width: 80%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg4_button" onclick='swapInput("eg4")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg4"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg4Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg4Load);
}
function eg4Load(event) {
       swapInput("eg4");
}
</script>
<div style="display:none;" id="eg4short">
<pre style="width: 97%;" class="fragment">
<b name="eg4shortenergy" onclick='showPath("eg4","eg4shortenergy")'>energy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg4shortenergy">energy</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg4shortenergy">The READ action with label <b>energy</b> calculates a single scalar value</span>
<b name="eg4shortvolume" onclick='showPath("eg4","eg4shortvolume")'>volume: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg4shortvolume">volume</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg4shortvolume">The READ action with label <b>volume</b> calculates a single scalar value</span>
<b name="eg4shortmybias" onclick='showPath("eg4","eg4shortmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg4shortmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg4shortmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift energy and volume (to avoid numerical issues)</span>
<b name="eg4shortrvol" onclick='showPath("eg4","eg4shortrvol")'>rvol: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg4shortvolume">volume</b> <div class="tooltip">PARAMETERS<div class="right"><b>compulsory keyword ( default=0.0 )</b>
the parameters of the arguments in your function <i></i></div></div>=7.8 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg4shortrvol">The COMBINE action with label <b>rvol</b> calculates a single scalar value</span>
<b name="eg4shortrenergy" onclick='showPath("eg4","eg4shortrenergy")'>renergy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg4shortenergy">energy</b> <div class="tooltip">PARAMETERS<div class="right"><b>compulsory keyword ( default=0.0 )</b>
the parameters of the arguments in your function <i></i></div></div>=-13250 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg4shortrenergy">The COMBINE action with label <b>renergy</b> calculates a single scalar value</span>
<span style="color:blue"># Weights</span>
<b name="eg4shortbias_weights" onclick='showPath("eg4","eg4shortbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg4shortmybias">mybias.bias</b> <span style="display:none;" id="eg4shortbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg4shorttemp_press_weights" onclick='showPath("eg4","eg4shorttemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">REWEIGHT_TEMP<div class="right">Reweighting temperature <i></i></div></div>=300 <div class="tooltip">PRESSURE<div class="right">The system pressure <i></i></div></div>=0.06022140857 <div class="tooltip">REWEIGHT_PRESSURE<div class="right">Reweighting pressure <i></i></div></div>=180.66422571 <div class="tooltip">ENERGY<div class="right">Energy <i></i></div></div>=<b name="eg4shortrenergy">renergy</b> <div class="tooltip">VOLUME<div class="right">Volume <i></i></div></div>=<b name="eg4shortrvol">rvol</b> <span style="display:none;" id="eg4shorttemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the volume at 300 K and 300 MPa</span>
<b name="eg4shortavg_vol" onclick='showPath("eg4","eg4shortavg_vol")'>avg_vol: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_a_v_e_r_a_g_e.html" style="color:green">AVERAGE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the quantity that is being averaged <i></i></div></div>=<b name="eg4shortvolume">volume</b> <div class="tooltip">LOGWEIGHTS<div class="right">the logarithm of the quantity to use as the weights when calculating averages <i></i></div></div>=<b name="eg4shortbias_weights">bias_weights</b>,<b name="eg4shorttemp_press_weights">temp_press_weights</b> <span style="display:none;" id="eg4shortavg_vol">The AVERAGE action with label <b>avg_vol</b> calculates a single scalar value</span>
<span style="color:blue"># Ensemble average of the density at 300 K and 300 MPa</span>
<b name="eg4shortavg_density" onclick='showPath("eg4","eg4shortavg_density")'>avg_density: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_u_s_t_o_m.html" style="color:green">CUSTOM</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg4shortavg_vol">avg_vol</b> <div class="tooltip">FUNC<div class="right"><b>compulsory keyword </b>
the function you wish to evaluate <i></i></div></div>=1000/x <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg4shortavg_density">The CUSTOM action with label <b>avg_density</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg4shortavg_density">avg_density</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR_REWEIGHT <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=1 <span style="display:none;" id="eg4short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg4long"><pre style="width: 97%;" class="fragment">
<b name="eg4longenergy" onclick='showPath("eg4","eg4longenergy")'>energy: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg4longenergy">energy</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg4longenergy">The READ action with label <b>energy</b> calculates a single scalar value</span>
<b name="eg4longvolume" onclick='showPath("eg4","eg4longvolume")'>volume: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg4longvolume">volume</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg4longvolume">The READ action with label <b>volume</b> calculates a single scalar value</span>
<b name="eg4longmybias" onclick='showPath("eg4","eg4longmybias")'>mybias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_a_d.html" style="color:green">READ</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
the name of the file from which to read these quantities <i></i></div></div>=COLVAR <div class="tooltip">VALUES<div class="right"><b>compulsory keyword </b>
the values to read from the file <i></i></div></div>=<b name="eg4longmybias">mybias.bias</b> <div class="tooltip">IGNORE_TIME<div class="right">( default=off ) ignore the time in the colvar file. <i></i></div></div> <span style="display:none;" id="eg4longmybias">The READ action with label <b>mybias</b> calculates a single scalar value</span>
<span style="color:blue"># Shift energy and volume (to avoid numerical issues)</span>
<span style="color:blue"># Weights</span>
<b name="eg4longbias_weights" onclick='showPath("eg4","eg4longbias_weights")'>bias_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__b_i_a_s.html" style="color:green">REWEIGHT_BIAS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">ARG<div class="right"><b>compulsory keyword ( default=*.bias )</b>
the biases that must be taken into account when reweighting <i></i></div></div>=<b name="eg4longmybias">mybias.bias</b> <span style="display:none;" id="eg4longbias_weights">The REWEIGHT_BIAS action with label <b>bias_weights</b> calculates a single scalar value</span>
<b name="eg4longtemp_press_weights" onclick='showPath("eg4","eg4longtemp_press_weights")'>temp_press_weights: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__t_e_m_p__p_r_e_s_s.html" style="color:green">REWEIGHT_TEMP_PRESS</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=500 <div class="tooltip">REWEIGHT_TEMP<div class="right">Reweighting temperature <i></i></div></div>=300 <div class="tooltip">PRESSURE<div class="right">The system pressure <i></i></div></div>=0.06022140857 <div class="tooltip">REWEIGHT_PRESSURE<div class="right">Reweighting pressure <i></i></div></div>=180.66422571 <div class="tooltip">ENERGY<div class="right">Energy <i></i></div></div>=renergy <div class="tooltip">VOLUME<div class="right">Volume <i></i></div></div>=rvol <span style="display:none;" id="eg4longtemp_press_weights">The REWEIGHT_TEMP_PRESS action with label <b>temp_press_weights</b><dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>This action calculates the logarithm of a weight for reweighting</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> .#!value </b> </td><td>the weight to use for this frame to determine its contribution at a different temperature/pressure   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature. This is not required if your MD code passes this quantity to PLUMED   </td></tr>
<tr>
<td width="15%"><b> ENERGY </b> </td><td>Energy   </td></tr>
<tr>
<td width="15%"><b> VOLUME </b> </td><td>Volume   </td></tr>
<tr>
<td width="15%"><b> REWEIGHT_PRESSURE </b> </td><td>Reweighting pressure   </td></tr>
<tr>
<td width="15%"><b> PRESSURE </b> </td><td>The system pressure   </td></tr>
<tr>
<td width="15%"><b> REWEIGHT_TEMP </b> </td><td>Reweighting temperature   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_analysis.html">Analysis</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
