<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: FUNNEL_PS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_f_u_n_n_e_l__p_s.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">FUNNEL_PS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the funnel <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=funnel . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>FUNNEL_PS implements the Funnel-Metadynamics (FM) technique in PLUMED 2.</p>
<p>Please read the FM <a class="el" href="citelist.html#CITEREF_limongelli2013funnel">[69]</a> <a class="el" href="citelist.html#CITEREF_raniolo2020ligand">[96]</a> papers to better understand the notions hereby reported.</p>
<p>This colvar evaluates the position of a ligand of interest with respect to a given line, built from the two points A and B, and should be used together with the <a class="el" href="_f_u_n_n_e_l.html">FUNNEL</a> bias. The constructed line represents the axis of the funnel-shape restraint potential, which should be placed so as to include the portion of a macromolecule (i.e., protein, DNA, etc.) that should be explored. Since it is important that the position of the line is updated based on the motion of the macromolecule during the simulation, this colvar incorporates an alignment method. The latter uses the TYPE=OPTIMAL option to remove motions due to rotation and translation of the macromolecule with respect to a reference structure, which is provided by the user. In order to accomplish the task, an optimal alignment matrix is calculated using the Kearsley <a class="el" href="citelist.html#CITEREF_kearsley">[62]</a> algorithm. The reference structure should be given as a pdb file, containing only the atoms of the macromolecule or a selection of them (e.g., the protein CA atoms of secondary structures). In contrast to the methods reported in the <a class="el" href="dists.html">Distances from reference configurations</a>, the values reported in the occupancy and beta-factor columns of the pdb file are not important since they will be overwritten and replaced by the value 1.00 during the procedure. It is important to understand that all atoms in the file will be used for the alignment, even if they display 0.00 in the occupancy column.</p>
<p>The ligand can be represented by one single atom or the center of mass (COM) of a group of atoms that should be provided by the user.</p>
<p>By default FUNNEL_PS is computed taking into account periodic boundary conditions. Since PLUMED 2.5, molecules are rebuilt using a procedure that is equivalent to that done in <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a>. We note that this action is local to this colvar, thus it does not modify the coordinates stored in PLUMED. Moreover, FUNNEL_PS requires an ANCHOR atom to be specified in order to facilitate the reconstruction of periodic boundary conditions. This atom should be the closest macromolecule's atom to the ligand and it should reduce the risk of ligand "warping" in the simulation box. Nevertheless, we highly recommend to add to the PLUMED input file a custom line of <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a>, in order to be sure of reconstructing the ligand together with the macromolecule (please look the examples). In this case, the user can use the NOPBC flag to turn off the internal periodic boundary condition reconstruction.</p>
<p>FUNNEL_PS is divided in two components (fps.lp and fps.ld) which evaluate the projection of the ligand along the funnel line and the distance from it, respectively. The values attributed to these two components are then used together with the potential file created by the <a class="el" href="_f_u_n_n_e_l.html">FUNNEL</a> bias to define if the ligand is within or not in the funnel-shape restraint potential. In the latter case, the potential will force the ligand to enter within the funnel boundaries.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input tells plumed to print the FUNNEL_PS components for the COM of a ligand. The inputs are a reference structure, which is the structure used for the alignment, the COM of the molecule we want to track, and 2 points in the Cartesian space (i.e., x, y, and z) to draw the line representing the funnel axis. </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1lig" onclick='showPath("eg1","eg1lig")'>lig: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m.html" style="color:green">COM</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=2446,2447,2448,2449,2451 <span style="display:none;" id="eg1lig"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1fps" onclick='showPath("eg1","eg1fps")'>fps: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_f_u_n_n_e_l__p_s.html" style="color:green">FUNNEL_PS</a> <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing the structure you would like to align. <i></i></div></div>=protein.pdb <div class="tooltip">LIGAND<div class="right">This MUST be a single atom, normally the COM of the ligand. <i></i></div></div>=<b name="eg1lig">lig</b> <div class="tooltip">POINTS<div class="right"><b>compulsory keyword </b>
6 values defining x, y, and z of the 2 points used to construct the line. <i></i></div></div>=5.3478,-0.7278,2.4746,7.3785,6.7364,-9.3624 <span style="display:none;" id="eg1fps"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1fps">fps.lp</b>,<b name="eg1fps">fps.ld</b> <span style="display:none;" id="eg1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>It is recommended to add a line to force the reconstruction of the periodic boundary conditions. In the following example, <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> was added to make sure that the ligand was reconstructed together with the protein. The list contains all the atoms reported in the start.pdb file followed by the ANCHOR atom and the ligand. All atoms should be contained in the same entity and the correct order. </p>
<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-master/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=54,75,212,228,239,258,311,328,348,372,383,402,421,463,487,503,519,657,674,690,714,897,914,934,953,964 <span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-master/user-doc/html/974_,985_,1007_,1018_,1037_,1247_,1264_,1283_,1302_,1324_,1689_,1708_,1727_,1738_,1962_,1984_,1994_,2312_,2329_,2349_,2467_,2490_,2500_,2517_,2524_,2536_,.html" style="color:green">974,985,1007,1018,1037,1247,1264,1283,1302,1324,1689,1708,1727,1738,1962,1984,1994,2312,2329,2349,2467,2490,2500,2517,2524,2536,</a> <span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-master/user-doc/html/2547_,2554_,2569_,2575_,2591_,2607_,2635_,2657_,2676_,2693_,2700_,2719_,2735_,2746_,2770_,2777_,2788_,2795_,2805_,2815_,2832_,2854_,2868_,2898_,2904_,.html" style="color:green">2547,2554,2569,2575,2591,2607,2635,2657,2676,2693,2700,2719,2735,2746,2770,2777,2788,2795,2805,2815,2832,2854,2868,2898,2904,</a> <span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-master/user-doc/html/2911_,2927_,2948_,2962_,2472_,3221_,3224_,3225_,3228_,3229_,3231_,3233_,3235_,3237.html" style="color:green">2911,2927,2948,2962,2472,3221,3224,3225,3228,3229,3231,3233,3235,3237</a> <span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg2lig" onclick='showPath("eg2","eg2lig")'>lig: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m.html" style="color:green">COM</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=3221,3224,3225,3228,3229,3231,3233,3235,3237 <span style="display:none;" id="eg2lig"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg2fps" onclick='showPath("eg2","eg2fps")'>fps: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_f_u_n_n_e_l__p_s.html" style="color:green">FUNNEL_PS</a> <div class="tooltip">LIGAND<div class="right">This MUST be a single atom, normally the COM of the ligand. <i></i></div></div>=<b name="eg2lig">lig</b> <div class="tooltip">REFERENCE<div class="right"><b>compulsory keyword </b>
a file in pdb format containing the structure you would like to align. <i></i></div></div>=start.pdb <div class="tooltip">ANCHOR<div class="right">Closest protein atom to the ligand, picked to avoid pbc problems during the simulation.
<i></i></div></div>=2472 <div class="tooltip">POINTS<div class="right"><b>compulsory keyword </b>
6 values defining x, y, and z of the 2 points used to construct the line. <i></i></div></div>=4.724,5.369,4.069,4.597,5.721,4.343 <span style="display:none;" id="eg2fps"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2fps">fps.lp</b>,<b name="eg2fps">fps.ld</b> <span style="display:none;" id="eg2"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> lp </b> </td><td>the position along the funnel line   </td></tr>
<tr>
<td width="15%"><b> ld </b> </td><td>the distance from the funnel line   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> LIGAND </b> </td><td>This MUST be a single atom, normally the COM of the ligand. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
<tr>
<td width="15%"><b> ANCHOR </b> </td><td>Closest protein atom to the ligand, picked to avoid pbc problems during the simulation. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> REFERENCE </b> </td><td>a file in pdb format containing the structure you would like to align.   </td></tr>
<tr>
<td width="15%"><b> POINTS </b> </td><td>6 values defining x, y, and z of the 2 points used to construct the line. The order should be A_x,A_y,A_z,B_x,B_y,B_z.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SQUARED-ROOT </b> </td><td><p class="starttd">( default=off ) Used to initialize the creation of the alignment variable  </p>
<p class="endtd"></p>
</td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_f_u_n_n_e_l_m_o_d.html">Funnel-Metadynamics (FM)</a></li><li class="navelem"><a class="el" href="funnel_cv.html">CV documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
