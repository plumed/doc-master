<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: TD_GAUSSIAN</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_t_d__g_a_u_s_s_i_a_n.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">TD_GAUSSIAN </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the ves <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=ves . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Target distribution given by a sum of Gaussian kernels (static).</p>
<p>Employ a target distribution that is given by a sum of multivariate Gaussian (or normal) distributions, defined as </p><p class="formulaDsp">
\[ p(\mathbf{s}) = \sum_{i} \, w_{i} \, N(\mathbf{s};\mathbf{\mu}_{i},\mathbf{\Sigma}_{i}) \]
</p>
<p> where \(\mathbf{\mu}_{i}=(\mu_{1,i},\mu_{2,i},\ldots,\mu_{d,i})\) and \(\mathbf{\Sigma}_{i}\) are the center and the covariance matrix for the \(i\)-th Gaussian. The weights \(w_{i}\) are normalized to 1, \(\sum_{i}w_{i}=1\).</p>
<p>By default the Gaussian distributions are considered as separable into independent one-dimensional Gaussian distributions. In other words, the covariance matrix is taken as diagonal \(\mathbf{\Sigma}_{i}=(\sigma^2_{1,i},\sigma^2_{2,i},\ldots,\sigma^{2}_{d,i})\). The Gaussian distribution is then written as </p><p class="formulaDsp">
\[ N(\mathbf{s};\mathbf{\mu}_{i},\mathbf{\sigma}_{i}) = \prod^{d}_{k} \, \frac{1}{\sqrt{2\pi\sigma^2_{d,i}}} \, \exp\left( -\frac{(s_{d}-\mu_{d,i})^2}{2\sigma^2_{d,i}} \right) \]
</p>
<p> where \(\mathbf{\sigma}_{i}=(\sigma_{1,i},\sigma_{2,i},\ldots,\sigma_{d,i})\) is the standard deviation. In this case you need to specify the centers \(\mathbf{\mu}_{i}\) using the numbered CENTER keywords and the standard deviations \(\mathbf{\sigma}_{i}\) using the numbered SIGMA keywords.</p>
<p>For two arguments it is possible to employ <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution">bivariate Gaussian kernels</a> with correlation between arguments, defined as </p><p class="formulaDsp">
\[ N(\mathbf{s};\mathbf{\mu}_{i},\mathbf{\sigma}_{i},\rho_i) = \frac{1}{2 \pi \sigma_{1,i} \sigma_{2,i} \sqrt{1-\rho_i^2}} \, \exp\left( -\frac{1}{2(1-\rho_i^2)} \left[ \frac{(s_{1}-\mu_{1,i})^2}{\sigma_{1,i}^2}+ \frac{(s_{2}-\mu_{2,i})^2}{\sigma_{2,i}^2}- \frac{2 \rho_i (s_{1}-\mu_{1,i})(s_{2}-\mu_{2,i})}{\sigma_{1,i}\sigma_{2,i}} \right] \right) \]
</p>
<p> where \(\rho_i\) is the correlation between \(s_{1}\) and \(s_{2}\) that goes from -1 to 1. In this case the covariance matrix is given as </p><p class="formulaDsp">
\[ \mathbf{\Sigma}= \left[ \begin{array}{cc} \sigma^2_{1,i} &amp; \rho_i \sigma_{1,i} \sigma_{2,i} \\ \rho_i \sigma_{1,i} \sigma_{2,i} &amp; \sigma^2_{2,i} \end{array} \right] \]
</p>
<p> The correlation \(\rho\) is given using the numbered CORRELATION keywords. A value of \(\rho=0\) means that the arguments are considered as un-correlated, which is the default behavior.</p>
<p>The Gaussian distributions are always defined with the conventional normalization factor such that they are normalized to 1 over an unbounded region. However, in calculation within VES we normally consider bounded region on which the target distribution is defined. Thus, if the center of a Gaussian is close to the boundary of the region it can happen that the tails go outside the region. In that case it might be needed to use the NORMALIZE keyword to make sure that the target distribution is properly normalized to 1 over the bounded region. The code will issue a warning if that is needed.</p>
<p>For periodic CVs it is generally better to use <a class="el" href="_t_d__v_o_n_m_i_s_e_s.html">Von Mises</a> distributions instead of Gaussian kernels as these distributions properly account for the periodicity of the CVs.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>One single Gaussian kernel in one-dimension. </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1td" onclick='showPath("eg1","eg1td")'>td: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_d__g_a_u_s_s_i_a_n.html" style="color:green">TD_GAUSSIAN</a> <div class="tooltip">CENTER1<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=-1.5 <div class="tooltip">SIGMA1<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.8 <span style="display:none;" id="eg1td">The TD_GAUSSIAN action with label <b>td</b></span>
</pre>
<p>Sum of three Gaussian kernels in two-dimensions with equal weights as no weights are given. </p>
<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2td" onclick='showPath("eg2","eg2td")'>td: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_d__g_a_u_s_s_i_a_n.html" style="color:green">TD_GAUSSIAN</a> ...
   <div class="tooltip">CENTER1<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=-1.5,+1.5 <div class="tooltip">SIGMA1<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.8,0.3 
   <div class="tooltip">CENTER2<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=+1.5,-1.5 <div class="tooltip">SIGMA2<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.3,0.8 
   <div class="tooltip">CENTER3<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=+1.5,+1.5 <div class="tooltip">SIGMA3<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.4,0.4 
   
...<span style="display:none;" id="eg2td">The TD_GAUSSIAN action with label <b>td</b></span>
</pre>
<p>Sum of three Gaussian kernels in two-dimensions which are weighted unequally. Note that weights are automatically normalized to 1 so that WEIGHTS=1.0,2.0,1.0 is equal to specifying WEIGHTS=0.25,0.50,0.25. </p>
<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg3td" onclick='showPath("eg3","eg3td")'>td: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_d__g_a_u_s_s_i_a_n.html" style="color:green">TD_GAUSSIAN</a> ...
   <div class="tooltip">CENTER1<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=-1.5,+1.5 <div class="tooltip">SIGMA1<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.8,0.3 
   <div class="tooltip">CENTER2<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=+1.5,-1.5 <div class="tooltip">SIGMA2<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.3,0.8 
   <div class="tooltip">CENTER3<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=+1.5,+1.5 <div class="tooltip">SIGMA3<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.4,0.4 
   <div class="tooltip">WEIGHTS<div class="right">The weights of the Gaussian distributions. <i></i></div></div>=1.0,2.0,1.0 
   
...<span style="display:none;" id="eg3td">The TD_GAUSSIAN action with label <b>td</b></span>
</pre>
<p>Sum of two bivariate Gaussian kernels where there is correlation of \(\rho_{2}=0.75\) between the two arguments for the second Gaussian. </p>
<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg4td" onclick='showPath("eg4","eg4td")'>td: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_d__g_a_u_s_s_i_a_n.html" style="color:green">TD_GAUSSIAN</a> ...
   <div class="tooltip">CENTER1<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=-1.5,+1.5 <div class="tooltip">SIGMA1<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.8,0.3 
   <div class="tooltip">CENTER2<div class="right">The centers of the Gaussian distributions.. <i></i></div></div>=+1.5,-1.5 <div class="tooltip">SIGMA2<div class="right">The standard deviations of the Gaussian distributions.. <i></i></div></div>=0.3,0.8 <div class="tooltip">CORRELATION2<div class="right">The correlation for two-dimensional bivariate Gaussian distributions. <i></i></div></div>=0.75 
   
...<span style="display:none;" id="eg4td">The TD_GAUSSIAN action with label <b>td</b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SHIFT_TO_ZERO </b> </td><td>( default=off ) Shift the minimum value of the target distribution to zero. This can for example be used to avoid negative values in the target distribution. If this option is active the distribution will be automatically normalized.   </td></tr>
<tr>
<td width="15%"><b> NORMALIZE </b> </td><td><p class="starttd">( default=off ) Renormalized the target distribution over the intervals on which it is defined to make sure that it is properly normalized to 1. In most cases this should not be needed as the target distributions should be normalized. The code will issue a warning (but still run) if this is needed for some reason.  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> CENTER </b> </td><td>The centers of the Gaussian distributions.. You can use multiple instances of this keyword i.e. CENTER1, CENTER2, CENTER3...   </td></tr>
<tr>
<td width="15%"><b> SIGMA </b> </td><td>The standard deviations of the Gaussian distributions.. You can use multiple instances of this keyword i.e. SIGMA1, SIGMA2, SIGMA3...   </td></tr>
<tr>
<td width="15%"><b> CORRELATION </b> </td><td>The correlation for two-dimensional bivariate Gaussian distributions. Only works for two arguments. The value should be between -1 and 1. If no value is given the Gaussian kernels is considered as un-correlated (i.e. value of 0.0).. You can use multiple instances of this keyword i.e. CORRELATION1, CORRELATION2, CORRELATION3...   </td></tr>
<tr>
<td width="15%"><b> WEIGHTS </b> </td><td>The weights of the Gaussian distributions. Have to be as many as the number of centers given with the numbered CENTER keywords. If no weights are given the distributions are weighted equally. The weights are automatically normalized to 1.   </td></tr>
<tr>
<td width="15%"><b> WELLTEMPERED_FACTOR </b> </td><td>Broaden the target distribution such that it is taken as [p(s)]^(1/gamma) where gamma is the well tempered factor given here. If this option is active the distribution will be automatically normalized.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_v_e_s.html">Variationally Enhanced Sampling (VES code)</a></li><li class="navelem"><a class="el" href="ves_targetdist.html">Target Distributions</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
