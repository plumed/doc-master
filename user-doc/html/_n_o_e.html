<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: NOE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_n_o_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">NOE </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the isdb <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculates NOE intensities as sums of 1/r^6, also averaging over multiple equivalent atoms or ambiguous NOE.</p>
<p>Each NOE is defined by two groups containing the same number of atoms, distances are calculated in pairs, transformed in 1/r^6, summed and saved as components.</p>
<p class="formulaDsp">
\[ NOE() = (\frac{1}{N_{eq}}\sum_j^{N_{eq}} (\frac{1}{r_j^6})) \]
</p>
<p>NOE can be used to calculate a Metainference score over one or more replicas using the intrinsic implementation of <a class="el" href="_m_e_t_a_i_n_f_e_r_e_n_c_e.html">METAINFERENCE</a> that is activated by DOSCORE.</p>
<dl class="section user"><dt>Examples</dt><dd>In the following examples three noes are defined, the first is calculated based on the distances of atom 1-2 and 3-2; the second is defined by the distance 5-7 and the third by the distances 4-15,4-16,8-15,8-16. <a class="el" href="_m_e_t_a_i_n_f_e_r_e_n_c_e.html">METAINFERENCE</a> is activated using DOSCORE.</dd></dl>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1noes" onclick='showPath("eg1","eg1noes")'>noes: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_n_o_e.html" style="color:green">NOE</a> ...
   <div class="tooltip">GROUPA1<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=1,3 <div class="tooltip">GROUPB1<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=2,2 <div class="tooltip">NOEDIST1<div class="right">Add an experimental value for each NOE.. <i></i></div></div>=0.6 
   <div class="tooltip">GROUPA2<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=5 <div class="tooltip">GROUPB2<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=7 <div class="tooltip">NOEDIST2<div class="right">Add an experimental value for each NOE.. <i></i></div></div>=0.6 
   <div class="tooltip">GROUPA3<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=4,4,8,8 <div class="tooltip">GROUPB3<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=15,16,15,16 <div class="tooltip">NOEDIST3<div class="right">Add an experimental value for each NOE.. <i></i></div></div>=0.6 
   <div class="tooltip">DOSCORE<div class="right">( default=off ) activate metainference <i></i></div></div> 
   <div class="tooltip">SIGMA_MEAN0<div class="right"><b> could not find this keyword </b><i></i></div></div>=1 
   
...<span style="display:none;" id="eg1noes">The NOE action with label <b>noes</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">noes.noe-0</td><td>the # NOE  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">noes.noe-1</td><td>the # NOE  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">noes.noe-2</td><td>the # NOE  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">noes.exp-0</td><td>the # NOE experimental distance  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">noes.exp-1</td><td>the # NOE experimental distance  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">noes.exp-2</td><td>the # NOE experimental distance  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">noes.score</td><td>the Metainference score</td></tr>
<tr><td width="5%%">noes.neff</td><td>effective number of replicas</td></tr>
<tr><td width="5%%">noes.acceptSigma</td><td>MC acceptance for sigma values</td></tr>
<tr><td width="5%%">noes.sigmaMean-0</td><td>uncertainty in the mean estimate  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">noes.sigma-0</td><td>uncertainty parameter  This is the 0th of these quantities</td></tr>
<tr><td width="5%%">noes.sigmaMean-1</td><td>uncertainty in the mean estimate  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">noes.sigma-1</td><td>uncertainty parameter  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">noes.sigmaMean-2</td><td>uncertainty in the mean estimate  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">noes.sigma-2</td><td>uncertainty parameter  This is the 2th of these quantities</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1noes">noes.*</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> score </b> </td><td>the Metainference score   </td></tr>
<tr>
<td width="15%"><b> sigma </b> </td><td>uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> sigmaMean </b> </td><td>uncertainty in the mean estimate   </td></tr>
<tr>
<td width="15%"><b> neff </b> </td><td>effective number of replicas   </td></tr>
<tr>
<td width="15%"><b> acceptSigma </b> </td><td>MC acceptance for sigma values   </td></tr>
<tr>
<td width="15%"><b> noe </b> </td><td>the # NOE   </td></tr>
</table>
<p>In addition the following quantities can be calculated by employing the keywords listed below</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> acceptScale </b> </td><td width="10%"><b> SCALEDATA </b>  </td><td>MC acceptance for scale value   </td></tr>
<tr>
<td width="5%"><b> acceptFT </b> </td><td width="10%"><b> GENERIC </b>  </td><td>MC acceptance for general metainference f tilde value   </td></tr>
<tr>
<td width="5%"><b> weight </b> </td><td width="10%"><b> REWEIGHT </b>  </td><td>weights of the weighted average   </td></tr>
<tr>
<td width="5%"><b> biasDer </b> </td><td width="10%"><b> REWEIGHT </b>  </td><td>derivatives with respect to the bias   </td></tr>
<tr>
<td width="5%"><b> scale </b> </td><td width="10%"><b> SCALEDATA </b>  </td><td>scale parameter   </td></tr>
<tr>
<td width="5%"><b> offset </b> </td><td width="10%"><b> ADDOFFSET </b>  </td><td>offset parameter   </td></tr>
<tr>
<td width="5%"><b> ftilde </b> </td><td width="10%"><b> GENERIC </b>  </td><td>ensemble average estimator   </td></tr>
<tr>
<td width="5%"><b> exp </b> </td><td width="10%"><b> NOEDIST </b>  </td><td>the # NOE experimental distance   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> GROUPA </b> </td><td>the atoms involved in each of the contacts you wish to calculate. Keywords like GROUPA1, GROUPA2, GROUPA3,... should be listed and one contact will be calculated for each ATOM keyword you specify.. You can use multiple instances of this keyword i.e. GROUPA1, GROUPA2, GROUPA3...   </td></tr>
<tr>
<td width="15%"><b> GROUPB </b> </td><td>the atoms involved in each of the contacts you wish to calculate. Keywords like GROUPB1, GROUPB2, GROUPB3,... should be listed and one contact will be calculated for each ATOM keyword you specify.. You can use multiple instances of this keyword i.e. GROUPB1, GROUPB2, GROUPB3...   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NOISETYPE </b> </td><td>( default=MGAUSS ) functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC)   </td></tr>
<tr>
<td width="15%"><b> LIKELIHOOD </b> </td><td>( default=GAUSS ) the likelihood for the GENERIC metainference model, GAUSS or LOGN   </td></tr>
<tr>
<td width="15%"><b> DFTILDE </b> </td><td>( default=0.1 ) fraction of sigma_mean used to evolve ftilde   </td></tr>
<tr>
<td width="15%"><b> SCALE0 </b> </td><td>( default=1.0 ) initial value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> SCALE_PRIOR </b> </td><td>( default=FLAT ) either FLAT or GAUSSIAN   </td></tr>
<tr>
<td width="15%"><b> OFFSET0 </b> </td><td>( default=0.0 ) initial value of the offset   </td></tr>
<tr>
<td width="15%"><b> OFFSET_PRIOR </b> </td><td>( default=FLAT ) either FLAT or GAUSSIAN   </td></tr>
<tr>
<td width="15%"><b> SIGMA0 </b> </td><td>( default=1.0 ) initial value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MIN </b> </td><td>( default=0.0 ) minimum value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MAX </b> </td><td>( default=10. ) maximum value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> OPTSIGMAMEAN </b> </td><td>( default=NONE ) Set to NONE/SEM to manually set sigma mean, or to estimate it on the fly   </td></tr>
<tr>
<td width="15%"><b> WRITE_STRIDE </b> </td><td>( default=10000 ) write the status to a file every N steps, this can be used for restart/continuation   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> DOSCORE </b> </td><td>( default=off ) activate metainference   </td></tr>
<tr>
<td width="15%"><b> NOENSEMBLE </b> </td><td>( default=off ) don't perform any replica-averaging   </td></tr>
<tr>
<td width="15%"><b> REWEIGHT </b> </td><td>( default=off ) simple REWEIGHT using the ARG as energy   </td></tr>
<tr>
<td width="15%"><b> SCALEDATA </b> </td><td>( default=off ) Set to TRUE if you want to sample a scaling factor common to all values and replicas   </td></tr>
<tr>
<td width="15%"><b> ADDOFFSET </b> </td><td>( default=off ) Set to TRUE if you want to sample an offset common to all values and replicas   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td><p class="starttd">( default=off ) ignore the periodic boundary conditions when calculating distances  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the values from which the function is calculated   </td></tr>
<tr>
<td width="15%"><b> AVERAGING </b> </td><td>Stride for calculation of averaged weights and sigma_mean   </td></tr>
<tr>
<td width="15%"><b> SCALE_MIN </b> </td><td>minimum value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> SCALE_MAX </b> </td><td>maximum value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> DSCALE </b> </td><td>maximum MC move of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> OFFSET_MIN </b> </td><td>minimum value of the offset   </td></tr>
<tr>
<td width="15%"><b> OFFSET_MAX </b> </td><td>maximum value of the offset   </td></tr>
<tr>
<td width="15%"><b> DOFFSET </b> </td><td>maximum MC move of the offset   </td></tr>
<tr>
<td width="15%"><b> REGRES_ZERO </b> </td><td>stride for regression with zero offset   </td></tr>
<tr>
<td width="15%"><b> DSIGMA </b> </td><td>maximum MC move of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MEAN0 </b> </td><td>starting value for the uncertainty in the mean estimate   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MAX_STEPS </b> </td><td>Number of steps used to optimise SIGMA_MAX, before that the SIGMA_MAX value is used   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature - this is only needed if code doesn't pass the temperature to plumed   </td></tr>
<tr>
<td width="15%"><b> MC_STEPS </b> </td><td>number of MC steps   </td></tr>
<tr>
<td width="15%"><b> MC_CHUNKSIZE </b> </td><td>MC chunksize   </td></tr>
<tr>
<td width="15%"><b> STATUS_FILE </b> </td><td>write a file with all the data useful for restart/continuation of Metainference   </td></tr>
<tr>
<td width="15%"><b> SELECTOR </b> </td><td>name of selector   </td></tr>
<tr>
<td width="15%"><b> NSELECT </b> </td><td>range of values for selector [0, N-1]   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
<tr>
<td width="15%"><b> NOEDIST </b> </td><td>Add an experimental value for each NOE.. You can use multiple instances of this keyword i.e. NOEDIST1, NOEDIST2, NOEDIST3...   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_i_s_d_b.html">PLUMED-ISDB</a></li><li class="navelem"><a class="el" href="_i_s_d_b_colvar.html">CVs Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
