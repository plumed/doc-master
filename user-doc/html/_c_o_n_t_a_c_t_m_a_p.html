<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: CONTACTMAP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_c_o_n_t_a_c_t_m_a_p.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">CONTACTMAP </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the colvar <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculate the distances between a number of pairs of atoms and transform each distance by a switching function.</p>
<p>The transformed distance can be compared with a reference value in order to calculate the squared distance between two contact maps. Each distance can also be weighted for a given value. CONTACTMAP can be used together with <a class="el" href="_f_u_n_c_p_a_t_h_m_s_d.html">FUNCPATHMSD</a> to define a path in the contactmap space.</p>
<p>The individual contact map distances related to each contact can be accessed as components named <code>cm.contact-1</code>, <code>cm.contact-2</code>, etc, assuming that the label of the CONTACTMAP is <code>cm</code>.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following example calculates switching functions based on the distances between atoms 1 and 2, 3 and 4 and 4 and 5. The values of these three switching functions are then output to a file named colvar.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1f1" onclick='showPath("eg1","eg1f1")'>f1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_n_t_a_c_t_m_a_p.html" style="color:green">CONTACTMAP</a> <div class="tooltip">ATOMS1<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=1,2 <div class="tooltip">ATOMS2<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=3,4 <div class="tooltip">ATOMS3<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=4,5 <div class="tooltip">ATOMS4<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=5,6 <div class="tooltip">SWITCH<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={RATIONAL R_0=1.5}  <span style="display:none;" id="eg1f1">The CONTACTMAP action with label <b>f1</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">f1.contact-1</td><td>By not using SUM or CMDIST each contact will be stored in a component  This is the 1th of these quantities</td></tr>
<tr><td width="5%%">f1.contact-2</td><td>By not using SUM or CMDIST each contact will be stored in a component  This is the 2th of these quantities</td></tr>
<tr><td width="5%%">f1.contact-3</td><td>By not using SUM or CMDIST each contact will be stored in a component  This is the 3th of these quantities</td></tr>
<tr><td width="5%%">f1.contact-4</td><td>By not using SUM or CMDIST each contact will be stored in a component  This is the 4th of these quantities</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1f1">f1.*</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p>The following example calculates the difference of the current contact map with respect to a reference provided. In this case REFERENCE is the fraction of contact that is formed (i.e. the distance between two atoms transformed with the SWITCH), while R_0 is the contact distance. WEIGHT gives the relative weight of each contact to the final distance measure.</p>

<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2cmap" onclick='showPath("eg2","eg2cmap")'>cmap: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_n_t_a_c_t_m_a_p.html" style="color:green">CONTACTMAP</a> ...
   <div class="tooltip">ATOMS1<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=1,2 <div class="tooltip">REFERENCE1<div class="right">A reference value for a given contact, by default is 0.0 <i></i></div></div>=0.1 <div class="tooltip">WEIGHT1<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.5 
   <div class="tooltip">ATOMS2<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=3,4 <div class="tooltip">REFERENCE2<div class="right">A reference value for a given contact, by default is 0.0 <i></i></div></div>=0.5 <div class="tooltip">WEIGHT2<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=1.0 
   <div class="tooltip">ATOMS3<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=4,5 <div class="tooltip">REFERENCE3<div class="right">A reference value for a given contact, by default is 0.0 <i></i></div></div>=0.25 <div class="tooltip">WEIGHT3<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=1.0 
   <div class="tooltip">ATOMS4<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=5,6 <div class="tooltip">REFERENCE4<div class="right">A reference value for a given contact, by default is 0.0 <i></i></div></div>=0.0 <div class="tooltip">WEIGHT4<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.5 
   <div class="tooltip">SWITCH<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={RATIONAL R_0=1.5}  
   
   <div class="tooltip">CMDIST<div class="right">( default=off ) calculate the distance with respect to the provided reference contact
map <i></i></div></div> 
...<span style="display:none;" id="eg2cmap">The CONTACTMAP action with label <b>cmap</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2cmap">cmap</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>The next example calculates calculates fraction of native contacts (Q) for Trp-cage mini-protein. R_0 is the distance at which the switch function is guaranteed to be 1.0 – it doesn't really matter for Q and should be something very small, like 1 A. REF is the reference distance for the contact, e.g. the distance from a crystal structure. LAMBDA is the tolerance for the distance – if set to 1.0, the contact would have to have exactly the reference value to be formed; instead for lambda values of 1.5–1.8 are usually used to allow some slack. BETA is the softness of the switch function, default is 50nm. WEIGHT is the 1/(number of contacts) giving equal weight to each contact.</p>
<p>When using native contact Q switch function, please cite <a class="el" href="citelist.html#CITEREF_best2013">[14]</a></p>

<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># The full (much-longer) example available in regtest/basic/rt72/</span>
<b name="eg3cmap" onclick='showPath("eg3","eg3cmap")'>cmap: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_n_t_a_c_t_m_a_p.html" style="color:green">CONTACTMAP</a> ...
   <div class="tooltip">ATOMS1<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=1,67 <div class="tooltip">SWITCH1<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={Q R_0=0.01 BETA=50.0 LAMBDA=1.5 REF=0.4059}  <div class="tooltip">WEIGHT1<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.003597 
   <div class="tooltip">ATOMS2<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=1,68 <div class="tooltip">SWITCH2<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={Q R_0=0.01 BETA=50.0 LAMBDA=1.5 REF=0.4039}  <div class="tooltip">WEIGHT2<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.003597 
   <div class="tooltip">ATOMS3<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=1,69 <div class="tooltip">SWITCH3<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={Q R_0=0.01 BETA=50.0 LAMBDA=1.5 REF=0.3215}  <div class="tooltip">WEIGHT3<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.003597 
   <div class="tooltip">ATOMS4<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=5,61 <div class="tooltip">SWITCH4<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={Q R_0=0.01 BETA=50.0 LAMBDA=1.5 REF=0.4277}  <div class="tooltip">WEIGHT4<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.003597 
   <div class="tooltip">ATOMS5<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=5,67 <div class="tooltip">SWITCH5<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={Q R_0=0.01 BETA=50.0 LAMBDA=1.5 REF=0.3851}  <div class="tooltip">WEIGHT5<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.003597 
   <div class="tooltip">ATOMS6<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=5,68 <div class="tooltip">SWITCH6<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={Q R_0=0.01 BETA=50.0 LAMBDA=1.5 REF=0.3811}  <div class="tooltip">WEIGHT6<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.003597 
   <div class="tooltip">ATOMS7<div class="right">the atoms involved in each of the contacts you wish to calculate. <i></i></div></div>=5,69 <div class="tooltip">SWITCH7<div class="right"><b>compulsory keyword </b>
The switching functions to use for each of the contacts in your map. <i></i></div></div>={Q R_0=0.01 BETA=50.0 LAMBDA=1.5 REF=0.3133}  <div class="tooltip">WEIGHT7<div class="right">A weight value for a given contact, by default is 1.0 <i></i></div></div>=0.003597 
   
   <div class="tooltip">SUM<div class="right">( default=off ) calculate the sum of all the contacts in the input <i></i></div></div> 
...<span style="display:none;" id="eg3cmap">The CONTACTMAP action with label <b>cmap</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg3cmap">cmap</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvar <span style="display:none;" id="eg3">The PRINT action with label <b></b></span>
</pre>
<p> (See also <a class="el" href="switchingfunction.html">switchingfunction</a>)</p>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> contact </b> </td><td>By not using SUM or CMDIST each contact will be stored in a component   </td></tr>
<tr>
<td width="15%"><b> .#!value </b> </td><td>the sum of all the switching function on all the distances   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ATOMS </b> </td><td>the atoms involved in each of the contacts you wish to calculate. Keywords like ATOMS1, ATOMS2, ATOMS3,... should be listed and one contact will be calculated for each ATOM keyword you specify.. You can use multiple instances of this keyword i.e. ATOMS1, ATOMS2, ATOMS3...   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SWITCH </b> </td><td>The switching functions to use for each of the contacts in your map. You can either specify a global switching function using SWITCH or one switching function for each contact. Details of the various switching functions you can use are provided on <a class="el" href="switchingfunction.html">switchingfunction</a>.. You can use multiple instances of this keyword i.e. SWITCH1, SWITCH2, SWITCH3...   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SUM </b> </td><td>( default=off ) calculate the sum of all the contacts in the input   </td></tr>
<tr>
<td width="15%"><b> CMDIST </b> </td><td>( default=off ) calculate the distance with respect to the provided reference contact map   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td><p class="starttd">( default=off ) Perform the calculation in serial - for debug purpose  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> REFERENCE </b> </td><td>A reference value for a given contact, by default is 0.0 You can either specify a global reference value using REFERENCE or one reference value for each contact.. You can use multiple instances of this keyword i.e. REFERENCE1, REFERENCE2, REFERENCE3...   </td></tr>
<tr>
<td width="15%"><b> WEIGHT </b> </td><td>A weight value for a given contact, by default is 1.0 You can either specify a global weight value using WEIGHT or one weight value for each contact.. You can use multiple instances of this keyword i.e. WEIGHT1, WEIGHT2, WEIGHT3...   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="_colvar.html">CV Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
