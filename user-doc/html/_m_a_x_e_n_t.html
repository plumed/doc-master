<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: MAXENT</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_m_a_x_e_n_t.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">MAXENT </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the bias <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Add a linear biasing potential on one or more variables that satisfies a maximum entropy principle.</p>
<p>Add a linear biasing potential on one or more variables \(f_{i}\left(\boldsymbol{x}\right)\) satisfying the maximum entropy principle as proposed in Ref. <a class="el" href="citelist.html#CITEREF_cesari2016maxent">[3]</a> .</p>
<dl class="section warning"><dt>Warning</dt><dd>Notice that syntax is still under revision and might change</dd></dl>
<p>The resulting biasing potential is given by: </p><p class="formulaDsp">
\[ V_{BIAS}(\boldsymbol{x},t)=K_{B}T\sum_{i=1}^{\#arguments}f_{i}(\boldsymbol{x},t)\lambda_{i}(t) \]
</p>
<p> Lagrangian multipliers \( \lambda_{i}\) are updated, every PACE steps, according to the following update rule: </p><p class="formulaDsp">
\[ \lambda_{i}=\lambda_{i}+\frac{k_{i}}{1+\frac{t}{\tau_{i}}}\left(f_{exp,i}+\xi_{i}\lambda_{i}-f_{i}(\boldsymbol{x})\right) \]
</p>
<p> \(k\) set the initial value of the learning rate and its units are \([observable]^{-2}ps^{-1}\). This can be set with the keyword KAPPA. The number of components for any KAPPA vector must be equal to the number of arguments of the action.</p>
<p>Variable \( \xi_{i}(\lambda) \) is related to the chosen prior to model experimental errors. If a GAUSSIAN prior is used then: </p><p class="formulaDsp">
\[ \xi_{i}(\lambda)=-\lambda_{i}\sigma^{2} \]
</p>
<p> where \( \sigma \) is the typical expected error on the observable \( f_i\). For a LAPLACE prior: </p><p class="formulaDsp">
\[ \xi_{i}(\lambda)=-\frac{\lambda_{i}\sigma^{2}}{1-\frac{\lambda^{2}\sigma^{2}}{2}} \]
</p>
<p> The value of \( \xi(\lambda,t)\) is written in output as a component named: argument name followed by the string _error. Setting \( \sigma =0\) is equivalent to enforce a pure Maximum Entropy restraint without any noise modelling. This method can be also used to enforce inequality restraint as shown in following examples.</p>
<p>Notice that a similar method is available as <a class="el" href="_e_d_s.html">EDS</a>, although with different features and using a different optimization algorithm.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input tells plumed to restrain the distance between atoms 7 and 15 and the distance between atoms 2 and 19, at different equilibrium values, and to print the energy of the restraint. Lagrangian multiplier will be printed on a file called restraint.LAGMULT with a stride set by the variable PACE to 200ps. Moreover plumed will compute the average of each Lagrangian multiplier in the window [TSTART,TEND] and use that to continue the simulations with fixed Lagrangian multipliers. </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1d1" onclick='showPath("eg1","eg1d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=7,15 <span style="display:none;" id="eg1d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg1d2" onclick='showPath("eg1","eg1d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,19 <span style="display:none;" id="eg1d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg1restraint" onclick='showPath("eg1","eg1restraint")'>restraint: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_a_x_e_n_t.html" style="color:green">MAXENT</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg1d1">d1</b>,<b name="eg1d2">d2</b> 
   <div class="tooltip">TYPE<div class="right"><b>compulsory keyword </b>
specify the restraint type. <i></i></div></div>=EQUAL 
   <div class="tooltip">AT<div class="right"><b>compulsory keyword </b>
the position of the restraint <i></i></div></div>=0.2,0.5 
   <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword ( default=0.0 )</b>
specifies the initial value for the learning rate <i></i></div></div>=35000.0,35000.0 
   <div class="tooltip">TAU<div class="right"><b>compulsory keyword </b>
Specify the dumping time for the learning rate. <i></i></div></div>=0.02,0.02 
   <div class="tooltip">PACE<div class="right">the frequency for Lagrangian multipliers update <i></i></div></div>=200 
   <div class="tooltip">TSTART<div class="right">time from where to start averaging the Lagrangian multiplier. <i></i></div></div>=100 
   <div class="tooltip">TEND<div class="right">time in ps where to stop to compute the average of Lagrangian multiplier. <i></i></div></div>=500 
   
...<span style="display:none;" id="eg1restraint">The MAXENT action with label <b>restraint</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">restraint.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">restraint.force2</td><td>the instantaneous value of the squared force due to this bias potential</td></tr>
<tr><td width="5%%">restraint.work</td><td>the instantaneous value of the work done by the biasing force</td></tr>
<tr><td width="5%%">restraint.d1_coupling</td><td>Instantaneous values of Lagrangian multipliers. They are also written by default in a separate output file. This particular component measures this quantity for the input CV named d1</td></tr>
<tr><td width="5%%">restraint.d1_work</td><td>the instantaneous value of the work done by the biasing force for each argument. These quantities will named with the arguments of the bias followed by the character string _work. This particular component measures this quantity for the input CV named d1</td></tr>
<tr><td width="5%%">restraint.d1_error</td><td>Instantaneous values of the discrepancy between the observable and the restraint center This particular component measures this quantity for the input CV named d1</td></tr>
<tr><td width="5%%">restraint.d2_coupling</td><td>Instantaneous values of Lagrangian multipliers. They are also written by default in a separate output file. This particular component measures this quantity for the input CV named d2</td></tr>
<tr><td width="5%%">restraint.d2_work</td><td>the instantaneous value of the work done by the biasing force for each argument. These quantities will named with the arguments of the bias followed by the character string _work. This particular component measures this quantity for the input CV named d2</td></tr>
<tr><td width="5%%">restraint.d2_error</td><td>Instantaneous values of the discrepancy between the observable and the restraint center This particular component measures this quantity for the input CV named d2</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1restraint">restraint.bias</b> <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p> Lagrangian multipliers will be printed on a file called restraint.bias The following input tells plumed to restrain the distance between atoms 7 and 15 to be greater than 0.2 and to print the energy of the restraint </p>
<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2d" onclick='showPath("eg2","eg2d")'>d: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=7,15 <span style="display:none;" id="eg2d">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
<b name="eg2restraint" onclick='showPath("eg2","eg2restraint")'>restraint: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_a_x_e_n_t.html" style="color:green">MAXENT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2d">d</b> <div class="tooltip">TYPE<div class="right"><b>compulsory keyword </b>
specify the restraint type. <i></i></div></div>=INEQUAL&gt; <div class="tooltip">AT<div class="right"><b>compulsory keyword </b>
the position of the restraint <i></i></div></div>=0.02 <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword ( default=0.0 )</b>
specifies the initial value for the learning rate <i></i></div></div>=35000.0 <div class="tooltip">TAU<div class="right"><b>compulsory keyword </b>
Specify the dumping time for the learning rate. <i></i></div></div>=3 <span style="display:none;" id="eg2restraint">The MAXENT action with label <b>restraint</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">restraint.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">restraint.force2</td><td>the instantaneous value of the squared force due to this bias potential</td></tr>
<tr><td width="5%%">restraint.work</td><td>the instantaneous value of the work done by the biasing force</td></tr>
<tr><td width="5%%">restraint.d_coupling</td><td>Instantaneous values of Lagrangian multipliers. They are also written by default in a separate output file. This particular component measures this quantity for the input CV named d</td></tr>
<tr><td width="5%%">restraint.d_work</td><td>the instantaneous value of the work done by the biasing force for each argument. These quantities will named with the arguments of the bias followed by the character string _work. This particular component measures this quantity for the input CV named d</td></tr>
<tr><td width="5%%">restraint.d_error</td><td>Instantaneous values of the discrepancy between the observable and the restraint center This particular component measures this quantity for the input CV named d</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2restraint">restraint.bias</b> <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>(See also <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> and <a class="el" href="_p_r_i_n_t.html">PRINT</a>).</p>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> force2 </b> </td><td>the instantaneous value of the squared force due to this bias potential   </td></tr>
<tr>
<td width="15%"><b> work </b> </td><td>the instantaneous value of the work done by the biasing force   </td></tr>
<tr>
<td width="15%"><b> _work </b> </td><td>the instantaneous value of the work done by the biasing force for each argument. These quantities will named with the arguments of the bias followed by the character string _work.   </td></tr>
<tr>
<td width="15%"><b> _error </b> </td><td>Instantaneous values of the discrepancy between the observable and the restraint center   </td></tr>
<tr>
<td width="15%"><b> _coupling </b> </td><td>Instantaneous values of Lagrangian multipliers. They are also written by default in a separate output file.   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> KAPPA </b> </td><td>( default=0.0 ) specifies the initial value for the learning rate   </td></tr>
<tr>
<td width="15%"><b> TAU </b> </td><td>Specify the dumping time for the learning rate.   </td></tr>
<tr>
<td width="15%"><b> TYPE </b> </td><td>specify the restraint type. EQUAL to restrain the variable at a given equilibrium value INEQUAL&lt; to restrain the variable to be smaller than a given value INEQUAL&gt; to restrain the variable to be greater than a given value   </td></tr>
<tr>
<td width="15%"><b> AT </b> </td><td>the position of the restraint   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> REWEIGHT </b> </td><td>( default=off ) to be used with plumed driver in order to reweight a trajectory a posteriori   </td></tr>
<tr>
<td width="15%"><b> NO_BROADCAST </b> </td><td><p class="starttd">( default=off ) If active will avoid Lagrangian multipliers to be communicated to other replicas.  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> ERROR_TYPE </b> </td><td>specify the prior on the error to use.GAUSSIAN: use a Gaussian prior LAPLACE: use a Laplace prior   </td></tr>
<tr>
<td width="15%"><b> TSTART </b> </td><td>time from where to start averaging the Lagrangian multiplier. By default no average is computed, hence lambda is updated every PACE steps   </td></tr>
<tr>
<td width="15%"><b> TEND </b> </td><td>time in ps where to stop to compute the average of Lagrangian multiplier. From this time until the end of the simulation Lagrangian multipliers are kept fix to the average computed between TSTART and TEND;   </td></tr>
<tr>
<td width="15%"><b> ALPHA </b> </td><td>default=1.0; To be used with LAPLACE KEYWORD, allows to choose a prior function proportional to a Gaussian times an exponential function. ALPHA=1 correspond to the LAPLACE prior.   </td></tr>
<tr>
<td width="15%"><b> SIGMA </b> </td><td>The typical errors expected on observable   </td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>Lagrangian multipliers output file. The default name is: label name followed by the string .LAGMULT   </td></tr>
<tr>
<td width="15%"><b> LEARN_REPLICA </b> </td><td>In a multiple replica environment specify which is the reference replica. By default replica 0 will be used.   </td></tr>
<tr>
<td width="15%"><b> APPLY_WEIGHTS </b> </td><td>Vector of weights containing 1 in correspondence of each replica that will receive the Lagrangian multiplier from the current one.   </td></tr>
<tr>
<td width="15%"><b> PACE </b> </td><td>the frequency for Lagrangian multipliers update   </td></tr>
<tr>
<td width="15%"><b> PRINT_STRIDE </b> </td><td>stride of Lagrangian multipliers output file. If no STRIDE is passed they are written every time they are updated (PACE).   </td></tr>
<tr>
<td width="15%"><b> FMT </b> </td><td>specify format for Lagrangian multipliers files (useful to decrease the number of digits in regtests)   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature. This is required if you are reweighting.   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_bias.html">Bias</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
