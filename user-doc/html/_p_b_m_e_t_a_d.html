<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: PBMETAD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_b_m_e_t_a_d.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PBMETAD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the bias <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Used to performed Parallel Bias metadynamics.</p>
<p>This action activate Parallel Bias Metadynamics (PBMetaD) <a class="el" href="citelist.html#CITEREF_pbmetad">[85]</a>, a version of metadynamics <a class="el" href="citelist.html#CITEREF_metad">[64]</a> in which multiple low-dimensional bias potentials are applied in parallel. In the current implementation, these have the form of mono-dimensional metadynamics bias potentials:</p>
<p class="formulaDsp">
\[ {V(s_1,t), ..., V(s_N,t)} \]
</p>
<p>where:</p>
<p class="formulaDsp">
\[ V(s_i,t) = \sum_{ k \tau &lt; t} W_i(k \tau) \exp\left( - \frac{(s_i-s_i^{(0)}(k \tau))^2}{2\sigma_i^2} \right). \]
</p>
<p>To ensure the convergence of each mono-dimensional bias potential to the corresponding free energy, at each deposition step the Gaussian heights are multiplied by the so-called conditional term:</p>
<p class="formulaDsp">
\[ W_i(k \tau)=W_0 \frac{\exp\left( - \frac{V(s_i,k \tau)}{k_B T} \right)}{\sum_{i=1}^N \exp\left( - \frac{V(s_i,k \tau)}{k_B T} \right)} \]
</p>
<p>where \(W_0\) is the initial Gaussian height.</p>
<p>The PBMetaD bias potential is defined by:</p>
<p class="formulaDsp">
\[ V_{PB}(\vec{s},t) = -k_B T \log{\sum_{i=1}^N \exp\left( - \frac{V(s_i,t)}{k_B T} \right)}. \]
</p>
<p>Information on the Gaussian functions that build each bias potential are printed to multiple HILLS files, which are used both to restart the calculation and to reconstruct the mono-dimensional free energies as a function of the corresponding CVs. These can be reconstructed using the <a class="el" href="sum_hills.html">sum_hills</a> utility because the final bias is given by:</p>
<p class="formulaDsp">
\[ V(s_i) = -F(s_i) \]
</p>
<p>Currently, only a subset of the <a class="el" href="_m_e_t_a_d.html">METAD</a> options are available in PBMetaD.</p>
<p>The bias potentials can be stored on a grid to increase performances of long PBMetaD simulations. You should provide either the number of bins for every collective variable (GRID_BIN) or the desired grid spacing (GRID_SPACING). In case you provide both PLUMED will use the most conservative choice (highest number of bins) for each dimension. In case you do not provide any information about bin size (neither GRID_BIN nor GRID_SPACING) and if Gaussian width is fixed PLUMED will use 1/5 of the Gaussian width as grid spacing. This default choice should be reasonable for most applications.</p>
<p>Another option that is available is well-tempered metadynamics <a class="el" href="citelist.html#CITEREF_Barducci:2008">[11]</a>. In this variant of PBMetaD the heights of the Gaussian hills are scaled at each step by the additional well-tempered metadynamics term. This ensures that each bias converges more smoothly. It should be noted that, in the case of well-tempered metadynamics, in the output printed the Gaussian height is re-scaled using the bias factor. Also notice that with well-tempered metadynamics the HILLS files do not contain the bias, but the negative of the free-energy estimate. This choice has the advantage that one can restart a simulation using a different value for the \(\Delta T\). The applied bias will be scaled accordingly.</p>
<p>Note that you can use here also the flexible Gaussian approach <a class="el" href="citelist.html#CITEREF_Branduardi:2012dl">[25]</a> in which you can adapt the Gaussian to the extent of Cartesian space covered by a variable or to the space in collective variable covered in a given time. In this case the width of the deposited Gaussian potential is denoted by one value only that is a Cartesian space (ADAPTIVE=GEOM) or a time (ADAPTIVE=DIFF). Note that a specific integration technique for the deposited Gaussian kernels should be used in this case. Check the documentation for utility sum_hills.</p>
<p>With the keyword INTERVAL one changes the metadynamics algorithm setting the bias force equal to zero outside boundary <a class="el" href="citelist.html#CITEREF_baftizadeh2012protein">[10]</a>. If, for example, metadynamics is performed on a CV s and one is interested only to the free energy for s &gt; boundary, the history dependent potential is still updated according to the above equations but the metadynamics force is set to zero for s &lt; boundary. Notice that Gaussian kernels are added also if s &lt; boundary, as the tails of these Gaussian kernels influence VG in the relevant region s &gt; boundary. In this way, the force on the system in the region s &gt; boundary comes from both metadynamics and the force field, in the region s &lt; boundary only from the latter. This approach allows obtaining a history-dependent bias potential VG that fluctuates around a stable estimator, equal to the negative of the free energy far enough from the boundaries. Note that:</p><ul>
<li>It works only for one-dimensional biases;</li>
<li>It works both with and without GRID;</li>
<li>The interval limit boundary in a region where the free energy derivative is not large;</li>
<li>If in the region outside the limit boundary the system has a free energy minimum, the INTERVAL keyword should be used together with a <a class="el" href="_u_p_p_e_r__w_a_l_l_s.html">UPPER_WALLS</a> or <a class="el" href="_l_o_w_e_r__w_a_l_l_s.html">LOWER_WALLS</a> at boundary.</li>
</ul>
<p>For systems with multiple CVs that share identical properties, PBMetaD with partitioned families can be used to group them under one bias potential that each contributes to <a class="el" href="citelist.html#CITEREF_Prakash2018PF">[93]</a>. This is done with a list of PF keywords, where each PF* argument contains the list of CVs from ARG to be placed in that family. Once invoked, each CV in ARG must be placed in exactly one PF, even if it results in families containing only one CV. Additionally, in cases where each of SIGMA or GRID entry would correspond to each ARG entry, they now correspond to each PF and must be adjusted accordingly.</p>
<p>Multiple walkers <a class="el" href="citelist.html#CITEREF_multiplewalkers">[95]</a> can also be used. See below the examples.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input is for PBMetaD calculation using as collective variables the distance between atoms 3 and 5 and the distance between atoms 2 and 4. The value of the CVs and the PBMetaD bias potential are written to the COLVAR file every 100 steps. </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1d1" onclick='showPath("eg1","eg1d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg1d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg1d2" onclick='showPath("eg1","eg1d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg1d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg1pb" onclick='showPath("eg1","eg1pb")'>pb: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_p_b_m_e_t_a_d.html" style="color:green">PBMETAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg1d1">d1</b>,<b name="eg1d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.2,0.2 <div class="tooltip">HEIGHT<div class="right">the height of the Gaussian hills, one for all biases. <i></i></div></div>=0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition, one for all biases <i></i></div></div>=500 <div class="tooltip">FILE<div class="right">files in which the lists of added hills are stored, default names are assigned using
arguments if FILE is not found <i></i></div></div>=HILLS_d1,HILLS_d2 <span style="display:none;" id="eg1pb">The PBMETAD action with label <b>pb</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1d1">d1</b>,<b name="eg1d2">d2</b>,<b name="eg1pb">pb.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p> (See also <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> and <a class="el" href="_p_r_i_n_t.html">PRINT</a>).</p>
<dl class="section user"><dt></dt><dd>If you use well-tempered metadynamics, you should specify a single bias factor and initial Gaussian height. 
<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2d1" onclick='showPath("eg2","eg2d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg2d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg2d2" onclick='showPath("eg2","eg2d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg2d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg2pb" onclick='showPath("eg2","eg2pb")'>pb: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_p_b_m_e_t_a_d.html" style="color:green">PBMETAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2d1">d1</b>,<b name="eg2d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.2,0.2 <div class="tooltip">HEIGHT<div class="right">the height of the Gaussian hills, one for all biases. <i></i></div></div>=0.3 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition, one for all biases <i></i></div></div>=500 <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics with this bias factor, one for all biases. <i></i></div></div>=8 
   <div class="tooltip">FILE<div class="right">files in which the lists of added hills are stored, default names are assigned using
arguments if FILE is not found <i></i></div></div>=HILLS_d1,HILLS_d2 
...<span style="display:none;" id="eg2pb">The PBMETAD action with label <b>pb</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2d1">d1</b>,<b name="eg2d2">d2</b>,<b name="eg2pb">pb.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
</dd></dl>
<dl class="section user"><dt></dt><dd>Using partitioned families, each CV in ARG must be in exactly one family. Here, the distance between atoms 1,2 is degenerate with 2,4, but not with the distance between 3,5. Note that two SIGMA are provided to match the two PF. 
<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg3d1" onclick='showPath("eg3","eg3d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg3d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg3d2" onclick='showPath("eg3","eg3d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg3d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg3d3" onclick='showPath("eg3","eg3d3")'>d3: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg3d3">The DISTANCE action with label <b>d3</b> calculates a single scalar value</span>
<b name="eg3pb" onclick='showPath("eg3","eg3pb")'>pb: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_p_b_m_e_t_a_d.html" style="color:green">PBMETAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg3d1">d1</b>,<b name="eg3d2">d2</b>,<b name="eg3d3">d3</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.2,0.2 <div class="tooltip">HEIGHT<div class="right">the height of the Gaussian hills, one for all biases. <i></i></div></div>=0.3 
   <div class="tooltip">PF0<div class="right">specify which CVs belong in a partitioned family. <i></i></div></div>=<b name="eg3d1">d1</b> <div class="tooltip">PF1<div class="right">specify which CVs belong in a partitioned family. <i></i></div></div>=<b name="eg3d2">d2</b>,<b name="eg3d3">d3</b> 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition, one for all biases <i></i></div></div>=500 <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics with this bias factor, one for all biases. <i></i></div></div>=8 
   <div class="tooltip">FILE<div class="right">files in which the lists of added hills are stored, default names are assigned using
arguments if FILE is not found <i></i></div></div>=HILLS_d1,HILLS_d2 
...<span style="display:none;" id="eg3pb">The PBMETAD action with label <b>pb</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg3d1">d1</b>,<b name="eg3d2">d2</b>,<b name="eg3d3">d3</b>,<b name="eg3pb">pb.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg3">The PRINT action with label <b></b></span>
</pre>
</dd></dl>
<dl class="section user"><dt></dt><dd>The following input enables the MPI version of multiple-walkers. 
<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg4d1" onclick='showPath("eg4","eg4d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg4d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg4d2" onclick='showPath("eg4","eg4d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg4d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg4pb" onclick='showPath("eg4","eg4pb")'>pb: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_p_b_m_e_t_a_d.html" style="color:green">PBMETAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg4d1">d1</b>,<b name="eg4d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.2,0.2 <div class="tooltip">HEIGHT<div class="right">the height of the Gaussian hills, one for all biases. <i></i></div></div>=0.3 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition, one for all biases <i></i></div></div>=500 <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics with this bias factor, one for all biases. <i></i></div></div>=8 
   <div class="tooltip">FILE<div class="right">files in which the lists of added hills are stored, default names are assigned using
arguments if FILE is not found <i></i></div></div>=HILLS_d1,HILLS_d2 
   <div class="tooltip">WALKERS_MPI<div class="right">( default=off ) Switch on MPI version of multiple walkers - not compatible with WALKERS_*
options other than WALKERS_DIR <i></i></div></div> 
...<span style="display:none;" id="eg4pb">The PBMETAD action with label <b>pb</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg4d1">d1</b>,<b name="eg4d2">d2</b>,<b name="eg4pb">pb.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg4">The PRINT action with label <b></b></span>
</pre>
</dd></dl>
<dl class="section user"><dt></dt><dd>The disk version of multiple-walkers can be enabled by setting the number of walker used, the id of the current walker which interprets the input file, the directory where the hills containing files resides, and the frequency to read the other walkers. Here is an example 
<div style="width: 90%; float:left" id="value_details_eg5"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg5d1" onclick='showPath("eg5","eg5d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg5d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg5d2" onclick='showPath("eg5","eg5d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg5d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg5pb" onclick='showPath("eg5","eg5pb")'>pb: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_p_b_m_e_t_a_d.html" style="color:green">PBMETAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg5d1">d1</b>,<b name="eg5d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.2,0.2 <div class="tooltip">HEIGHT<div class="right">the height of the Gaussian hills, one for all biases. <i></i></div></div>=0.3 
   <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition, one for all biases <i></i></div></div>=500 <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics with this bias factor, one for all biases. <i></i></div></div>=8 
   <div class="tooltip">FILE<div class="right">files in which the lists of added hills are stored, default names are assigned using
arguments if FILE is not found <i></i></div></div>=HILLS_d1,HILLS_d2 
   <div class="tooltip">WALKERS_N<div class="right">number of walkers <i></i></div></div>=10 
   <div class="tooltip">WALKERS_ID<div class="right">walker id <i></i></div></div>=3 
   <div class="tooltip">WALKERS_DIR<div class="right">shared directory with the hills files from all the walkers <i></i></div></div>=../ 
   <div class="tooltip">WALKERS_RSTRIDE<div class="right">stride for reading hills files <i></i></div></div>=100 
...<span style="display:none;" id="eg5pb">The PBMETAD action with label <b>pb</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg5d1">d1</b>,<b name="eg5d2">d2</b>,<b name="eg5pb">pb.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg5">The PRINT action with label <b></b></span>
</pre>
 where WALKERS_N is the total number of walkers, WALKERS_ID is the id of the present walker (starting from 0 ) and the WALKERS_DIR is the directory where all the walkers are located. WALKERS_RSTRIDE is the number of step between one update and the other.</dd></dl>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> SIGMA </b> </td><td>the widths of the Gaussian hills   </td></tr>
<tr>
<td width="15%"><b> PACE </b> </td><td>the frequency for hill addition, one for all biases   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> GRID_SPARSE </b> </td><td>( default=off ) use a sparse grid to store hills   </td></tr>
<tr>
<td width="15%"><b> GRID_NOSPLINE </b> </td><td>( default=off ) don't use spline interpolation with grids   </td></tr>
<tr>
<td width="15%"><b> WALKERS_MPI </b> </td><td><p class="starttd">( default=off ) Switch on MPI version of multiple walkers - not compatible with WALKERS_* options other than WALKERS_DIR  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>files in which the lists of added hills are stored, default names are assigned using arguments if FILE is not found   </td></tr>
<tr>
<td width="15%"><b> HEIGHT </b> </td><td>the height of the Gaussian hills, one for all biases. Compulsory unless TAU, TEMP and BIASFACTOR are given   </td></tr>
<tr>
<td width="15%"><b> FMT </b> </td><td>specify format for HILLS files (useful for decrease the number of digits in regtests)   </td></tr>
<tr>
<td width="15%"><b> BIASFACTOR </b> </td><td>use well tempered metadynamics with this bias factor, one for all biases. Please note you must also specify temp   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature - this is only needed if you are doing well-tempered metadynamics   </td></tr>
<tr>
<td width="15%"><b> TAU </b> </td><td>in well tempered metadynamics, sets height to (k_B Delta T*pace*timestep)/tau   </td></tr>
<tr>
<td width="15%"><b> GRID_MIN </b> </td><td>the lower bounds for the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_MAX </b> </td><td>the upper bounds for the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_BIN </b> </td><td>the number of bins for the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_SPACING </b> </td><td>the approximate grid spacing (to be used as an alternative or together with GRID_BIN)   </td></tr>
<tr>
<td width="15%"><b> GRID_WSTRIDE </b> </td><td>frequency for dumping the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_WFILES </b> </td><td>dump grid for the bias, default names are used if GRID_WSTRIDE is used without GRID_WFILES.   </td></tr>
<tr>
<td width="15%"><b> GRID_RFILES </b> </td><td>read grid for the bias   </td></tr>
<tr>
<td width="15%"><b> ADAPTIVE </b> </td><td>use a geometric (=GEOM) or diffusion (=DIFF) based hills width scheme. Sigma is one number that has distance units or timestep dimensions   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MAX </b> </td><td>the upper bounds for the sigmas (in CV units) when using adaptive hills. Negative number means no bounds   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MIN </b> </td><td>the lower bounds for the sigmas (in CV units) when using adaptive hills. Negative number means no bounds   </td></tr>
<tr>
<td width="15%"><b> PF </b> </td><td>specify which CVs belong in a partitioned family. Once a PF is specified, all CVs in ARG must be placed in a PF even if there is one CV per PF‚Äù. You can use multiple instances of this keyword i.e. PF1, PF2, PF3...   </td></tr>
<tr>
<td width="15%"><b> SELECTOR </b> </td><td>add forces and do update based on the value of SELECTOR   </td></tr>
<tr>
<td width="15%"><b> SELECTOR_ID </b> </td><td>value of SELECTOR   </td></tr>
<tr>
<td width="15%"><b> WALKERS_ID </b> </td><td>walker id   </td></tr>
<tr>
<td width="15%"><b> WALKERS_N </b> </td><td>number of walkers   </td></tr>
<tr>
<td width="15%"><b> WALKERS_DIR </b> </td><td>shared directory with the hills files from all the walkers   </td></tr>
<tr>
<td width="15%"><b> WALKERS_RSTRIDE </b> </td><td>stride for reading hills files   </td></tr>
<tr>
<td width="15%"><b> INTERVAL_MIN </b> </td><td>one dimensional lower limits, outside the limits the system will not feel the biasing force.   </td></tr>
<tr>
<td width="15%"><b> INTERVAL_MAX </b> </td><td>one dimensional upper limits, outside the limits the system will not feel the biasing force.   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
<tr>
<td width="15%"><b> UPDATE_FROM </b> </td><td>Only update this action from this time   </td></tr>
<tr>
<td width="15%"><b> UPDATE_UNTIL </b> </td><td>Only update this action until this time   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_bias.html">Bias</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
