<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: Groups and Virtual Atoms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_group.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Groups and Virtual Atoms </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="atomSpecs"></a>
Specifying Atoms</h1>
<p>The vast majority of the CVs implemented in PLUMED are calculated from a list of atom positions. Within PLUMED atoms are specified using their numerical indices in the molecular dynamics input file.</p>
<p>In PLUMED lists of atoms can be either provided directly inside the definition of each collective variable, or predefined as a <a class="el" href="_g_r_o_u_p.html">GROUP</a> that can be reused multiple times. Lists of atoms can be written as:</p>
<ul>
<li>comma separated lists of numbers (<code>GROUP ATOMS=10,11,15,20 LABEL=g1</code>)</li>
<li>numerical ranges. So <code>GROUP ATOMS=10-20 LABEL=g2</code> is equivalent to <code>GROUP ATOMS=10,11,12,13,14,15,16,17,18,19,20 LABEL=g2</code></li>
<li>numerical ranges with a stride. So <code>GROUP ATOMS=10-100:10 LABEL=g3 is equivalent to</code>GROUP ATOMS=10,20,30,40,50,60,70,80,90,100 LABEL=g3<code></code></li>
<li><code>atoms ranges with a negative stride. So</code>GROUP ATOMS=100-10:-10 LABEL=g4 is equivalent to <code>GROUP ATOMS=100,90,80,70,60,50,40,30,20,10 LABEL=g4</code></li>
</ul>
<p>In addition, there are a few shortcuts that can be used:</p>
<ul>
<li><code>@mdatoms</code> indicate all the physical atoms present in the MD engine (e.g. <code>DUMPATOMS ATOMS=@mdatoms</code>).</li>
<li><code>@allatoms</code> indicates all atoms, including <a class="el" href="_group.html#vatoms">those defined only in PLUMED</a> (e.g. <code>DUMPATOMS ATOMS=@allatoms</code>).</li>
<li><code>@ndx</code> uses a GROMACS index file. <code>@ndx:index.ndx</code> picks the first group in the file. <code>{@ndx:{index.ndx protein}}</code> picks the group named <code>protein</code>.</li>
</ul>
<p>The list of the virtual atoms defined in PLUMED can be obtained by using the command <code>GROUP ATOMS=@allatoms REMOVE=@mdatoms</code>.</p>
<p>Other shortcuts are available if you loaded the structure of the molecule using the <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> command.</p>
<p>All the above methods can be combined just putting one name after the other separated by a comma: </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1g5" onclick='showPath("eg1","eg1g5")'>g5: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_u_m_p_a_t_o_m_s.html" style="color:green">DUMPATOMS</a> <div class="tooltip">ATOMS<div class="right">the atom indices whose positions you would like to print out. <i></i></div></div>=1,2,10-20,40-60:5,100-70:-2 <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
file on which to output coordinates; extension is automatically detected <i></i></div></div>=test.xyz <span style="display:none;" id="eg1g5">The DUMPATOMS action with label <b>g5</b></span>
</pre>
<p>Some collective variable must accept a fixed number of atoms, for example a <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> is calculated using two atoms only, an <a class="el" href="_a_n_g_l_e.html">ANGLE</a> is calculated using either 3 or 4 atoms and <a class="el" href="_t_o_r_s_i_o_n.html">TORSION</a> is calculated using 4 atoms.</p>
<p>Additional material and examples can be also found in the tutorial belfast-1.</p>
<h2><a class="anchor" id="mols"></a>
Molecules</h2>
<p>In addition, for certain colvars, pdb files can be read in using the following keywords and used to select ATOMS:</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a>  </td><td>This command is used to provide information on the molecules that are present in your system.  </td></tr>
</table>
<h2><a class="anchor" id="pbc"></a>
Broken Molecules and PBC</h2>
<p>PLUMED is designed so that for the majority of the CVs implemented the periodic boundary conditions are treated in the same manner as they would be treated in the host code. In some codes this can be problematic when the colvars you are using involve some property of a molecule. These codes allow the atoms in the molecules to become separated by periodic boundaries, a fact which PLUMED could only deal with were the topology passed from the MD code to PLUMED. Making this work would involve a lot laborious programming and goes against our original aim of having a general patch that can be implemented in a wide variety of MD codes. Consequentially, we have implemented a more pragmatic solution to this problem - the user specifies in input any molecules (or parts of molecules) that must be kept in tact throughout the simulation run. In PLUMED 1 this was done using the ALIGN_ATOMS keyword. In PLUMED 2 the same effect can be achieved using the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> command.</p>
<p>The following input computes the end-to-end distance for a polymer of 100 atoms and keeps it at a value around 5.</p>

<div style="width: 80%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg2_button" onclick='swapInput("eg2")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg2"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg2Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg2Load);
}
function eg2Load(event) {
       swapInput("eg2");
}
</script>
<div style="display:none;" id="eg2short">
<pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-master/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=1-100 <span style="display:none;" id="eg2short">The WHOLEMOLECULES action with label <b></b></span>
<b name="eg2shorte2e" onclick='showPath("eg2","eg2shorte2e")'>e2e: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,100 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2shorte2e">The DISTANCE action with label <b>e2e</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_s_t_r_a_i_n_t.html" style="color:green">RESTRAINT</a> <div class="tooltip">ARG<div class="right">the values the harmonic restraint acts upon. <i></i></div></div>=<b name="eg2shorte2e">e2e</b> <div class="tooltip">KAPPA<div class="right"><b>compulsory keyword ( default=0.0 )</b>
specifies that the restraint is harmonic and what the values of the force constants
on each of the variables are <i></i></div></div>=1 <div class="tooltip">AT<div class="right"><b>compulsory keyword </b>
the position of the restraint <i></i></div></div>=5 <span style="display:none;" id="eg2short">The RESTRAINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg2long"><pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-master/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=1-100 <span style="display:none;" id="eg2long">The WHOLEMOLECULES action with label <b></b></span>
<b name="eg2longe2e" onclick='showPath("eg2","eg2longe2e")'>e2e: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,100 <div class="tooltip">NOPBC<div class="right">( default=off ) ignore the periodic boundary conditions when calculating distances
<i></i></div></div> <span style="display:none;" id="eg2longe2e">The DISTANCE action with label <b>e2e</b> calculates a single scalar value</span>
</pre>
</div>
<p>Notice that NOPBC is used to be sure in <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> that if the end-to-end distance is larger than half the simulation box the distance is compute properly. Also notice that, since many MD codes break molecules across cell boundary, it might be necessary to use the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> keyword (also notice that it should be before distance).</p>
<p>Notice that most expressions are invariant with respect to a change in the order of the atoms, but some of them depend on that order. E.g., with <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> it could be useful to specify atom lists in a reversed order.</p>

<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># to see the effect, one could dump the atoms as they were before molecule reconstruction:</span>
<span style="color:blue"># DUMPATOMS FILE=dump-broken.xyz ATOMS=1-20</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which molecules are reassembled. <i></i></div></div>=1 <div class="tooltip">ENTITY0<div class="right">the atoms that make up a molecule that you wish to align. <i></i></div></div>=1-20 <span style="display:none;" id="eg3">The WHOLEMOLECULES action with label <b></b></span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_d_u_m_p_a_t_o_m_s.html" style="color:green">DUMPATOMS</a> <div class="tooltip">FILE<div class="right"><b>compulsory keyword </b>
file on which to output coordinates; extension is automatically detected <i></i></div></div>=dump.xyz <div class="tooltip">ATOMS<div class="right">the atom indices whose positions you would like to print out. <i></i></div></div>=1-20 <span style="display:none;" id="eg3">The DUMPATOMS action with label <b></b></span>
</pre>
<p>Notice that there are other ways to manipulate the coordinates stored within PLUMED:</p><ul>
<li>Using the <a class="el" href="_f_i_t__t_o__t_e_m_p_l_a_t_e.html">FIT_TO_TEMPLATE</a> they can be aligned to a template structure.</li>
<li>Using <a class="el" href="_w_r_a_p_a_r_o_u_n_d.html">WRAPAROUND</a> you can bring a set of atom as close as possible to another set of atoms.</li>
<li>Using <a class="el" href="_r_e_s_e_t__c_e_l_l.html">RESET_CELL</a> you can rotate the periodic cell.</li>
</ul>
<h1><a class="anchor" id="vatoms"></a>
Virtual Atoms</h1>
<p>Sometimes, when calculating a colvar, you may not want to use the positions of a number of atoms directly. Instead you may wish to use the position of a virtual atom whose position is generated based on the positions of a collection of other atoms. For example you might want to use the center of mass of a group of atoms. Plumed has a number of routines for calculating the positions of these virtual atoms from lists of atoms:</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_a_r_g_s2_v_a_t_o_m.html">ARGS2VATOM</a>  </td><td>Create a virtual atom from the input scalars  </td></tr>
<tr>
<td width="5%"><a class="el" href="_c_e_n_t_e_r.html">CENTER</a>  </td><td>Calculate the center for a group of atoms, with arbitrary weights.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_c_e_n_t_e_r__f_a_s_t.html">CENTER_FAST</a>  </td><td>Calculate the center for a group of atoms, with arbitrary weights.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_c_o_m.html">COM</a>  </td><td>Calculate the center of mass for a group of atoms.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_f_i_x_e_d_a_t_o_m.html">FIXEDATOM</a>  </td><td>Add a virtual atom in a fixed position.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_g_h_o_s_t.html">GHOST</a>  </td><td>Calculate the absolute position of a ghost atom with fixed coordinates in the local reference frame formed by three atoms.  </td></tr>
</table>
<p>To specify to a colvar that you want to use the position of a virtual atom to calculate a colvar rather than one of the atoms in your system you simply use the label for your virtual atom in place of the usual numerical index. Virtual atoms and normal atoms can be mixed together in the input to colvars as shown below:</p>

<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg4com1" onclick='showPath("eg4","eg4com1")'>com1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m.html" style="color:green">COM</a> <div class="tooltip">ATOMS<div class="right">the list of atoms which are involved the virtual atom's definition. <i></i></div></div>=1,10 <span style="display:none;" id="eg4com1">The COM action with label <b>com1</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">com1.x</td><td>the x coordinate of the virtual atom</td></tr>
<tr><td width="5%%">com1.y</td><td>the y coordinate of the virtual atom</td></tr>
<tr><td width="5%%">com1.z</td><td>the z coordinate of the virtual atom</td></tr>
<tr><td width="5%%">com1.mass</td><td>the mass of the virtual atom</td></tr>
<tr><td width="5%%">com1.charge</td><td>the charge of the virtual atom</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=11,<b name="eg4com1">com1</b> <span style="display:none;" id="eg4">The DISTANCE action with label <b></b></span>
</pre>
<p>If you don't want to calculate CVs from the virtual atom. That is to say you just want to monitor the position of a virtual atom (or any set of atoms) over the course of your trajectory you can do this using <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
