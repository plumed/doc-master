<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: FIND_SPHERICAL_CONTOUR</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_f_i_n_d__s_p_h_e_r_i_c_a_l__c_o_n_t_o_u_r.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">FIND_SPHERICAL_CONTOUR </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the contour <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=contour . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Find an isocontour in a three dimensional grid by searching over a Fibonacci sphere.</p>
<p>As discussed in the part of the manual on <a class="el" href="_analysis.html">Analysis</a> PLUMED contains a number of tools that allow you to calculate a function on a grid. The function on this grid might be a <a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a> as a function of a few collective variables or it might be a phase field that has been calculated using <a class="el" href="_m_u_l_t_i_c_o_l_v_a_r_d_e_n_s.html">MULTICOLVARDENS</a>. If this function has one or two input arguments it is relatively straightforward to plot the function. If by contrast the data has a three dimensions it can be difficult to visualize.</p>
<p>This action provides one tool for visualizing these functions. It can be used to search for a set of points on a contour where the function takes a particular value. In other words, for the function \(f(x,y,z)\) this action would find a set of points \(\{x_c,y_c,z_c\}\) that have:</p>
<p class="formulaDsp">
\[ f(x_c,y_c,z_c) - c = 0 \]
</p>
<p>where \(c\) is some constant value that is specified by the user. The points on this contour are find by searching along a set of equally spaced radii of a sphere that centered at on particular, user-specified atom or virtual atom. To ensure that these search radii are equally spaced on the surface of the sphere the search directions are generated by using a Fibonacci spiral projected on a sphere. In other words, the search directions are given by:</p>
<p class="formulaDsp">
\[ \mathbf{r}_i = \left( \begin{matrix} \sqrt{1 - y^2} \cos(\phi) \\ \frac{2i}{n} - 1 + \frac{1}{n} \\ \sqrt{1 - y^2} \sin(\phi) \end{matrix} \right) \]
</p>
<p>where \(y\) is the quantity second component of the vector defined above, \(n\) is the number of directions to look in and \(\phi\) is</p>
<p class="formulaDsp">
\[ \phi = \mod(i + R, n) \pi ( 3 - \sqrt{5} ) \]
</p>
<p>where \(R\) is a random variable between 0 and \(n-1\) that is generated during the read in of the input file and that is fixed during the whole calculation.</p>
<p>It is important to note that this action can only be used to detect contours in three dimensional functions. In addition, this action will fail to find the full set of contour points if the contour does not have the same topology as a sphere. If you are uncertain that the isocontours in your function have a spherical topology you should use <a class="el" href="_f_i_n_d__c_o_n_t_o_u_r.html">FIND_CONTOUR</a> in place of <a class="el" href="_f_i_n_d__s_p_h_e_r_i_c_a_l__c_o_n_t_o_u_r.html">FIND_SPHERICAL_CONTOUR</a>.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input demonstrates how this action can be used. The input here is used to study the shape of a droplet that has been formed during the condensation of Lennard Jones from the vapor. The input below achieves this by calculating the coordination numbers of all the atoms within the gas. Obviously, those atoms within the droplet will have a large value for the coordination number while the isolated atoms in the gas will have a low value. As such we can detect the sizes of the droplets by constructing a <a class="el" href="_c_o_n_t_a_c_t__m_a_t_r_i_x.html">CONTACT_MATRIX</a> whose \(ij\) element tells us whether atom \(i\) and atom \(j\) have coordination number that is greater that two. The atoms within the various droplets within the system can then be found by performing a <a class="el" href="_d_f_s_c_l_u_s_t_e_r_i_n_g.html">DFSCLUSTERING</a> on this matrix to detect the connected components. We can take the largest of these connected components and find the center of the droplet by exploiting the functionality within CENTER_OF_MULTICOLVAR. We can then construct a phase field based on the positions of the atoms in the largest cluster and the values of the coordination numbers of these atoms. The final line in the input then finds the a set of points on the dividing surface that separates the droplet from the surrounding gas. The value of the phase field on this isocontour is equal to 0.75.</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># Calculate coordination numbers</span>
<b name="eg1c1" onclick='showPath("eg1","eg1c1")'>c1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n_n_u_m_b_e_r.html" style="color:green">COORDINATIONNUMBER</a> <div class="tooltip">SPECIES<div class="right">this keyword is used for colvars such as coordination number. <i></i></div></div>=1-512 <div class="tooltip">SWITCH<div class="right">the switching function that it used in the construction of the contact matrix <i></i></div></div>={EXP D_0=4.0 R_0=0.5 D_MAX=6.0}  <span style="display:none;" id="eg1c1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Select coordination numbers that are more than 2.0</span>
<b name="eg1cf" onclick='showPath("eg1","eg1cf")'>cf: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_f_i_l_t_e_r__m_o_r_e.html" style="color:green">MFILTER_MORE</a> <div class="tooltip">DATA<div class="right"><b>compulsory keyword </b>
the vector you wish to transform <i></i></div></div>=<b name="eg1c1">c1</b> <div class="tooltip">SWITCH<div class="right"><b>compulsory keyword </b>
the switching function that transform <i></i></div></div>={RATIONAL D_0=2.0 R_0=0.1}  <div class="tooltip">LOWMEM<div class="right">( default=off ) this flag does nothing and is present only to ensure back-compatibility
<i></i></div></div> <span style="display:none;" id="eg1cf"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Build a contact matrix</span>
<b name="eg1mat" onclick='showPath("eg1","eg1mat")'>mat: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_n_t_a_c_t__m_a_t_r_i_x.html" style="color:green">CONTACT_MATRIX</a> <div class="tooltip">ATOMS<div class="right">the atoms for which you would like to calculate the adjacency matrix. <i></i></div></div>=<b name="eg1cf">cf</b> <div class="tooltip">SWITCH<div class="right">specify the switching function to use between two sets of indistinguishable atoms.
<i></i></div></div>={EXP D_0=4.0 R_0=0.5 D_MAX=6.0}  <span style="display:none;" id="eg1mat"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Find largest cluster</span>
<b name="eg1dfs" onclick='showPath("eg1","eg1dfs")'>dfs: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_f_s_c_l_u_s_t_e_r_i_n_g.html" style="color:green">DFSCLUSTERING</a> <div class="tooltip">MATRIX<div class="right">the input matrix (can use ARG instead) <i></i></div></div>=<b name="eg1mat">mat</b> <div class="tooltip">LOWMEM<div class="right">( default=off ) this flag does nothing and is present only to ensure back-compatibility
<i></i></div></div> <span style="display:none;" id="eg1dfs"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1clust1" onclick='showPath("eg1","eg1clust1")'>clust1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_l_u_s_t_e_r__p_r_o_p_e_r_t_i_e_s.html" style="color:green">CLUSTER_PROPERTIES</a> <div class="tooltip">CLUSTERS<div class="right"><b>compulsory keyword </b>
the label of the action that does the clustering <i></i></div></div>=<b name="eg1dfs">dfs</b> <div class="tooltip">CLUSTER<div class="right"><b>compulsory keyword ( default=1 )</b>
which cluster would you like to look at 1 is the largest cluster, 2 is the second
largest, 3 is the the third largest and so on. <i></i></div></div>=1 <span style="display:none;" id="eg1clust1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Find center of largest cluster</span>
<b name="eg1trans1" onclick='showPath("eg1","eg1trans1")'>trans1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_t_r_a_n_s_f_o_r_m__m_o_r_e.html" style="color:green">MTRANSFORM_MORE</a> <div class="tooltip">DATA<div class="right"><b> could not find this keyword </b><i></i></div></div>=<b name="eg1clust1">clust1</b> <div class="tooltip">SWITCH<div class="right"><b> could not find this keyword </b><i></i></div></div>={RATIONAL D_0=2.0 R_0=0.1}  <div class="tooltip">LOWMEM<div class="right"><b> could not find this keyword </b><i></i></div></div> <span style="display:none;" id="eg1trans1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1cent" onclick='showPath("eg1","eg1cent")'>cent: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_e_n_t_e_r__o_f__m_u_l_t_i_c_o_l_v_a_r.html" style="color:green">CENTER_OF_MULTICOLVAR</a> <div class="tooltip">DATA<div class="right"><b> could not find this keyword </b><i></i></div></div>=<b name="eg1trans1">trans1</b> <span style="display:none;" id="eg1cent"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Calculate the phase field of the coordination</span>
<b name="eg1dens" onclick='showPath("eg1","eg1dens")'>dens: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_u_l_t_i_c_o_l_v_a_r_d_e_n_s.html" style="color:green">MULTICOLVARDENS</a> <div class="tooltip">DATA<div class="right">the multicolvar which you would like to calculate the density profile for <i></i></div></div>=<b name="eg1trans1">trans1</b> <div class="tooltip">ORIGIN<div class="right"><b>compulsory keyword </b>
we will use the position of this atom as the origin <i></i></div></div>=<b name="eg1cent">cent</b> <div class="tooltip">DIR<div class="right"><b>compulsory keyword </b>
the direction in which to calculate the density profile <i></i></div></div>=xyz <div class="tooltip">NBINS<div class="right">the number of bins to use in each direction (alternative to GRID_NBIN) <i></i></div></div>=30,30,30 <div class="tooltip">BANDWIDTH<div class="right">the bandwidths for kernel density esimtation <i></i></div></div>=2.0,2.0,2.0 <span style="display:none;" id="eg1dens"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># Find the isocontour around the nucleus</span>
<b name="eg1sc" onclick='showPath("eg1","eg1sc")'>sc: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_f_i_n_d__s_p_h_e_r_i_c_a_l__c_o_n_t_o_u_r.html" style="color:green">FIND_SPHERICAL_CONTOUR</a> <div class="tooltip">GRID<div class="right"><b> could not find this keyword </b><i></i></div></div>=<b name="eg1dens">dens</b> <div class="tooltip">CONTOUR<div class="right"><b>compulsory keyword </b>
the value we would like to draw the contour at in the space <i></i></div></div>=0.85 <div class="tooltip">INNER_RADIUS<div class="right"><b>compulsory keyword </b>
the minimum radius on which to look for the contour <i></i></div></div>=10.0 <div class="tooltip">OUTER_RADIUS<div class="right"><b>compulsory keyword </b>
the outer radius on which to look for the contour <i></i></div></div>=40.0 <div class="tooltip">NPOINTS<div class="right"><b>compulsory keyword </b>
the number of points for which we are looking for the contour <i></i></div></div>=100 <span style="display:none;" id="eg1sc"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># And print the grid to a file</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_i_d__t_o__x_y_z.html" style="color:green">GRID_TO_XYZ</a> <div class="tooltip">GRID<div class="right"><b> could not find this keyword </b><i></i></div></div>=<b name="eg1sc">sc</b> <div class="tooltip">FILE<div class="right"><b> could not find this keyword </b><i></i></div></div>=mysurface.xyz <div class="tooltip">UNITS<div class="right"><b> could not find this keyword </b><i></i></div></div>=A <span style="display:none;" id="eg1"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default the value of the calculated quantity can be referenced elsewhere in the input file by using the label of the action. Alternatively this Action can be used to calculate the following quantities by employing the keywords listed below. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> .#!value </b> </td><td>a grid on a Fibonacci sphere that describes the radial distance from the origin for the points on the Willard-Chandler surface   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the grid in which the contour will be found   </td></tr>
<tr>
<td width="15%"><b> CONTOUR </b> </td><td>the value we would like to draw the contour at in the space   </td></tr>
<tr>
<td width="15%"><b> INTERPOLATION_TYPE </b> </td><td>( default=spline ) the method to use for interpolation. Can be spline, linear, ceiling or floor.   </td></tr>
<tr>
<td width="15%"><b> NPOINTS </b> </td><td>the number of points for which we are looking for the contour   </td></tr>
<tr>
<td width="15%"><b> INNER_RADIUS </b> </td><td>the minimum radius on which to look for the contour   </td></tr>
<tr>
<td width="15%"><b> OUTER_RADIUS </b> </td><td>the outer radius on which to look for the contour   </td></tr>
<tr>
<td width="15%"><b> NBINS </b> </td><td>( default=1 ) the number of discrete sections in which to divide the distance between the inner and outer radius when searching for a contour   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not parallelize   </td></tr>
<tr>
<td width="15%"><b> ZERO_OUTSIDE_GRID_RANGE </b> </td><td><p class="starttd">( default=off ) if we are asked to evaluate the function for a number that is outside the range of the grid set it to zero  </p>
<p class="endtd"></p>
</td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_analysis.html">Analysis</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
