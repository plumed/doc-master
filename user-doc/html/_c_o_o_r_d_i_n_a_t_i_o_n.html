<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: COORDINATION</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_c_o_o_r_d_i_n_a_t_i_o_n.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">COORDINATION </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the colvar <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculate coordination numbers.</p>
<p>This keyword can be used to calculate the number of contacts between two groups of atoms and is defined as </p><p class="formulaDsp">
\[ \sum_{i\in A} \sum_{i\in B} s_{ij} \]
</p>
<p> where \(s_{ij}\) is 1 if the contact between atoms \(i\) and \(j\) is formed, zero otherwise. In actuality, \(s_{ij}\) is replaced with a switching function so as to ensure that the calculated CV has continuous derivatives. The default switching function is: </p><p class="formulaDsp">
\[ s_{ij} = \frac{ 1 - \left(\frac{{\bf r}_{ij}-d_0}{r_0}\right)^n } { 1 - \left(\frac{{\bf r}_{ij}-d_0}{r_0}\right)^m } \]
</p>
<p> but it can be changed using the optional SWITCH option.</p>
<p>To make your calculation faster you can use a neighbor list, which makes it that only a relevant subset of the pairwise distance are calculated at every step.</p>
<p>If GROUPB is empty, it will sum the \(\frac{N(N-1)}{2}\) pairs in GROUPA. This avoids computing twice permuted indexes (e.g. pair (i,j) and (j,i)) thus running at twice the speed.</p>
<p>Notice that if there are common atoms between GROUPA and GROUPB the switching function should be equal to one. These "self contacts" are discarded by plumed (since version 2.1), so that they actually count as "zero".</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following example instructs plumed to calculate the total coordination number of the atoms in group 1-10 with the atoms in group 20-100. For atoms 1-10 coordination numbers are calculated that count the number of atoms from the second group that are within 0.3 nm of the central atom. A neighbor list is used to make this calculation faster, this neighbor list is updated every 100 steps. </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> <div class="tooltip">GROUPA<div class="right">First list of atoms. <i></i></div></div>=1-10 <div class="tooltip">GROUPB<div class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted). <i></i></div></div>=20-100 <div class="tooltip">R_0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.3 <div class="tooltip">NLIST<div class="right">( default=off ) Use a neighbor list to speed up the calculation <i></i></div></div> <div class="tooltip">NL_CUTOFF<div class="right">The cutoff for the neighbor list <i></i></div></div>=0.5 <div class="tooltip">NL_STRIDE<div class="right">The frequency with which we are updating the atoms in the neighbor list <i></i></div></div>=100 <span style="display:none;" id="eg1">The COORDINATION action with label <b></b></span>
</pre>
<p>The following is a dummy example which should compute the value 0 because the self interaction of atom 1 is skipped. Notice that in plumed 2.0 "self interactions" were not skipped, and the same calculation should return 1. </p>
<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2c" onclick='showPath("eg2","eg2c")'>c: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> <div class="tooltip">GROUPA<div class="right">First list of atoms. <i></i></div></div>=1 <div class="tooltip">GROUPB<div class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted). <i></i></div></div>=1 <div class="tooltip">R_0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.3 <span style="display:none;" id="eg2c">The COORDINATION action with label <b>c</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2c">c</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
<p>Here's an example that shows what happens when providing COORDINATION with a single group: </p>
<div style="width: 80%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg3_button" onclick='swapInput("eg3")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg3"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg3Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg3Load);
}
function eg3Load(event) {
       swapInput("eg3");
}
</script>
<div style="display:none;" id="eg3short">
<pre style="width: 97%;" class="fragment">
<span style="color:blue"># define some huge group:</span>
<b name="eg3shortgroup" onclick='showPath("eg3","eg3shortgroup")'>group: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">ATOMS<div class="right">the numerical indexes for the set of atoms in the group. <i></i></div></div>=1-1000 <span style="display:none;" id="eg3shortgroup">The GROUP action with label <b>group</b> defines a group of atoms so that they can be referred to later in the input</span>
<span style="color:blue"># Here's coordination of a group against itself:</span>
<b name="eg3shortc1" onclick='showPath("eg3","eg3shortc1")'>c1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> <div class="tooltip">GROUPA<div class="right">First list of atoms. <i></i></div></div>=<b name="eg3shortgroup">group</b> <div class="tooltip">GROUPB<div class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted). <i></i></div></div>=<b name="eg3shortgroup">group</b> <div class="tooltip">R_0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.3 <span style="display:none;" id="eg3shortc1">The COORDINATION action with label <b>c1</b> calculates a single scalar value</span>
<span style="color:blue"># Here's coordination within a single group:</span>
<b name="eg3shortx" onclick='showPath("eg3","eg3shortx")'>x: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> <div class="tooltip">GROUPA<div class="right">First list of atoms. <i></i></div></div>=<b name="eg3shortgroup">group</b> <div class="tooltip">R_0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.3 <span style="display:none;" id="eg3shortx">The COORDINATION action with label <b>x</b> calculates a single scalar value</span>
<span style="color:blue"># This is just multiplying times 2 the variable x:</span>
<b name="eg3shortc2" onclick='showPath("eg3","eg3shortc2")'>c2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3shortx">x</b> <div class="tooltip">COEFFICIENTS<div class="right"><b>compulsory keyword ( default=1.0 )</b>
the coefficients of the arguments in your function <i></i></div></div>=2 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3shortc2">The COMBINE action with label <b>c2</b> calculates a single scalar value</span>
<span style="color:blue"># the two variables c1 and c2 should be identical, but the calculation of c2 is twice faster</span>
<span style="color:blue"># since it runs on half of the pairs.</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg3shortc1">c1</b>,<b name="eg3shortc2">c2</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <span style="display:none;" id="eg3short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg3long"><pre style="width: 97%;" class="fragment">
<span style="color:blue"># define some huge group:</span>
<b name="eg3longgroup" onclick='showPath("eg3","eg3longgroup")'>group: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_g_r_o_u_p.html" style="color:green">GROUP</a> <div class="tooltip">ATOMS<div class="right">the numerical indexes for the set of atoms in the group. <i></i></div></div>=1-1000 <span style="display:none;" id="eg3longgroup">The GROUP action with label <b>group</b> defines a group of atoms so that they can be referred to later in the input</span>
<span style="color:blue"># Here's coordination of a group against itself:</span>
<b name="eg3longc1" onclick='showPath("eg3","eg3longc1")'>c1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> <div class="tooltip">GROUPA<div class="right">First list of atoms. <i></i></div></div>=<b name="eg3longgroup">group</b> <div class="tooltip">GROUPB<div class="right">Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted). <i></i></div></div>=<b name="eg3longgroup">group</b> <div class="tooltip">R_0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.3 <span style="display:none;" id="eg3longc1">The COORDINATION action with label <b>c1</b> calculates a single scalar value</span>
<span style="color:blue"># Here's coordination within a single group:</span>
<b name="eg3longx" onclick='showPath("eg3","eg3longx")'>x: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> <div class="tooltip">GROUPA<div class="right">First list of atoms. <i></i></div></div>=<b name="eg3longgroup">group</b> <div class="tooltip">R_0<div class="right"><b> could not find this keyword </b><i></i></div></div>=0.3 <span style="display:none;" id="eg3longx">The COORDINATION action with label <b>x</b> calculates a single scalar value</span>
<span style="color:blue"># This is just multiplying times 2 the variable x:</span>
<span style="color:blue"># the two variables c1 and c2 should be identical, but the calculation of c2 is twice faster</span>
<span style="color:blue"># since it runs on half of the pairs.</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg3longc1">c1</b>,c2 <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=10 <span style="display:none;" id="eg3long">The PRINT action with label <b></b><dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default the value of the calculated quantity can be referenced elsewhere in the input file by using the label of the action. Alternatively this Action can be used to calculate the following quantities by employing the keywords listed below. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> .#!value </b> </td><td>the value of the coordination   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> GROUPA </b> </td><td>First list of atoms. For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
<tr>
<td width="15%"><b> GROUPB </b> </td><td>Second list of atoms (if empty, N*(N-1)/2 pairs in GROUPA are counted). For more information on how to specify lists of atoms see <a class="el" href="_group.html">Groups and Virtual Atoms</a>   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NN </b> </td><td>( default=6 ) The n parameter of the switching function   </td></tr>
<tr>
<td width="15%"><b> MM </b> </td><td>( default=0 ) The m parameter of the switching function; 0 implies 2*NN   </td></tr>
<tr>
<td width="15%"><b> D_0 </b> </td><td>( default=0.0 ) The d_0 parameter of the switching function   </td></tr>
<tr>
<td width="15%"><b> R_0 </b> </td><td>The r_0 parameter of the switching function   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) Perform the calculation in serial - for debug purpose   </td></tr>
<tr>
<td width="15%"><b> PAIR </b> </td><td>( default=off ) Pair only 1st element of the 1st group with 1st element in the second, etc   </td></tr>
<tr>
<td width="15%"><b> NLIST </b> </td><td><p class="starttd">( default=off ) Use a neighbor list to speed up the calculation  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> NL_CUTOFF </b> </td><td>The cutoff for the neighbor list   </td></tr>
<tr>
<td width="15%"><b> NL_STRIDE </b> </td><td>The frequency with which we are updating the atoms in the neighbor list   </td></tr>
<tr>
<td width="15%"><b> SWITCH </b> </td><td>This keyword is used if you want to employ an alternative to the continuous switching function defined above. The following provides information on the <a class="el" href="switchingfunction.html">switchingfunction</a> that are available. When this keyword is present you no longer need the NN, MM, D_0 and R_0 keywords.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="_colvar.html">CV Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
