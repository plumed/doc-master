<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: METAD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_m_e_t_a_d.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">METAD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the bias <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Used to performed metadynamics on one or more collective variables.</p>
<p>In a metadynamics simulations a history dependent bias composed of intermittently added Gaussian functions is added to the potential <a class="el" href="citelist.html#CITEREF_metad">[64]</a>.</p>
<p class="formulaDsp">
\[ V(\vec{s},t) = \sum_{ k \tau &lt; t} W(k \tau) \exp\left( -\sum_{i=1}^{d} \frac{(s_i-s_i^{(0)}(k \tau))^2}{2\sigma_i^2} \right). \]
</p>
<p>This potential forces the system away from the kinetic traps in the potential energy surface and out into the unexplored parts of the energy landscape. Information on the Gaussian functions from which this potential is composed is output to a file called HILLS, which is used both the restart the calculation and to reconstruct the free energy as a function of the CVs. The free energy can be reconstructed from a metadynamics calculation because the final bias is given by:</p>
<p class="formulaDsp">
\[ V(\vec{s}) = -F(\vec{s}) \]
</p>
<p>During post processing the free energy can be calculated in this way using the <a class="el" href="sum_hills.html">sum_hills</a> utility.</p>
<p>In the simplest possible implementation of a metadynamics calculation the expense of a metadynamics calculation increases with the length of the simulation as one has to, at every step, evaluate the values of a larger and larger number of Gaussian kernels. To avoid this issue you can store the bias on a grid. This approach is similar to that proposed in <a class="el" href="citelist.html#CITEREF_babi08jcp">[8]</a> but has the advantage that the grid spacing is independent on the Gaussian width. Notice that you should provide the grid boundaries (GRID_MIN and GRID_MAX) and either the number of bins for every collective variable (GRID_BIN) or the desired grid spacing (GRID_SPACING). In case you provide both PLUMED will use the most conservative choice (highest number of bins) for each dimension. In case you do not provide any information about bin size (neither GRID_BIN nor GRID_SPACING) PLUMED will use 1/5 of the Gaussian width (SIGMA) as grid spacing if the width is fixed or 1/5 of the minimum Gaussian width (SIGMA_MIN) if the width is variable. This default choice should be reasonable for most applications.</p>
<p>Alternatively to the use of grids, it is possible to use a neighbor list to decrease the cost of evaluating the bias, this can be enabled using NLIST. NLIST can be beneficial with more than 2 collective variables, where GRID becomes expensive and memory consuming. The neighbor list will be updated everytime the CVs go farther than a cut-off value from the position they were at last neighbor list update. Gaussians are added to the neigbhor list if their center is within 6.*DP2CUTOFF*sigma*sigma. While the list is updated if the CVs are farther from the center than 0.5 of the standard deviation of the Gaussian center distribution of the list. These parameters (6 and 0.5) can be modified using NLIST_PARAMETERS. Note that the use of neighbor list does not provide the exact bias.</p>
<p>Metadynamics can be restarted either from a HILLS file as well as from a GRID, in this second case one can first save a GRID using GRID_WFILE (and GRID_WSTRIDE) and at a later stage read it using GRID_RFILE.</p>
<p>The work performed by the METAD bias can be calculated using CALC_WORK, note that this is expensive when not using grids.</p>
<p>Another option that is available in plumed is well-tempered metadynamics <a class="el" href="citelist.html#CITEREF_Barducci:2008">[11]</a>. In this variant of metadynamics the heights of the Gaussian hills are scaled at each step so the bias is now given by:</p>
<p class="formulaDsp">
\[ V({s},t)= \sum_{t&#39;=0,\tau_G,2\tau_G,\dots}^{t&#39;&lt;t} W e^{-V({s}({q}(t&#39;),t&#39;)/\Delta T} \exp\left( -\sum_{i=1}^{d} \frac{(s_i({q})-s_i({q}(t&#39;))^2}{2\sigma_i^2} \right), \]
</p>
<p>This method ensures that the bias converges more smoothly. It should be noted that, in the case of well-tempered metadynamics, in the output printed the Gaussian height is re-scaled using the bias factor. Also notice that with well-tempered metadynamics the HILLS file does not contain the bias, but the negative of the free-energy estimate. This choice has the advantage that one can restart a simulation using a different value for the \(\Delta T\). The applied bias will be scaled accordingly.</p>
<p>Note that you can use here also the flexible Gaussian approach <a class="el" href="citelist.html#CITEREF_Branduardi:2012dl">[25]</a> in which you can adapt the Gaussian to the extent of Cartesian space covered by a variable or to the space in collective variable covered in a given time. In this case the width of the deposited Gaussian potential is denoted by one value only that is a Cartesian space (ADAPTIVE=GEOM) or a time (ADAPTIVE=DIFF). Note that a specific integration technique for the deposited Gaussian kernels should be used in this case. Check the documentation for utility sum_hills.</p>
<p>With the keyword INTERVAL one changes the metadynamics algorithm setting the bias force equal to zero outside boundary <a class="el" href="citelist.html#CITEREF_baftizadeh2012protein">[10]</a>. If, for example, metadynamics is performed on a CV s and one is interested only to the free energy for s &gt; boundary, the history dependent potential is still updated according to the above equations but the metadynamics force is set to zero for s &lt; boundary. Notice that Gaussian kernels are added also if s &lt; boundary, as the tails of these Gaussian kernels influence VG in the relevant region s &gt; boundary. In this way, the force on the system in the region s &gt; boundary comes from both metadynamics and the force field, in the region s &lt; boundary only from the latter. This approach allows obtaining a history-dependent bias potential VG that fluctuates around a stable estimator, equal to the negative of the free energy far enough from the boundaries. Note that:</p><ul>
<li>It works only for one-dimensional biases;</li>
<li>It works both with and without GRID;</li>
<li>The interval limit boundary in a region where the free energy derivative is not large;</li>
<li>If in the region outside the limit boundary the system has a free energy minimum, the INTERVAL keyword should be used together with a <a class="el" href="_u_p_p_e_r__w_a_l_l_s.html">UPPER_WALLS</a> or <a class="el" href="_l_o_w_e_r__w_a_l_l_s.html">LOWER_WALLS</a> at boundary.</li>
</ul>
<p>As a final note, since version 2.0.2 when the system is outside of the selected interval the force is set to zero and the bias value to the value at the corresponding boundary. This allows acceptances for replica exchange methods to be computed correctly.</p>
<p>Multiple walkers <a class="el" href="citelist.html#CITEREF_multiplewalkers">[95]</a> can also be used. See below the examples.</p>
<p>The \(c(t)\) reweighting factor can also be calculated on the fly using the equations presented in <a class="el" href="citelist.html#CITEREF_Tiwary_jp504920s">[104]</a>. The expression used to calculate \(c(t)\) follows directly from Eq. 3 in <a class="el" href="citelist.html#CITEREF_Tiwary_jp504920s">[104]</a>, where \(F(\vec{s})=-\gamma/(\gamma-1) V(\vec{s})\). This gives smoother results than equivalent Eqs. 13 and Eqs. 14 in that paper. The \(c(t)\) is given by the rct component while the bias normalized by \(c(t)\) is given by the rbias component (rbias=bias-rct) which can be used to obtain a reweighted histogram. The calculation of \(c(t)\) is enabled by using the keyword CALC_RCT. By default \(c(t)\) is updated every time the bias changes, but if this slows down the simulation the keyword RCT_USTRIDE can be set to a value higher than 1. This option requires that a grid is used.</p>
<p>Additional material and examples can be also found in the tutorials:</p>
<ul>
<li>lugano-3</li>
</ul>
<p>Concurrent metadynamics as done e.g. in Ref. <a class="el" href="citelist.html#CITEREF_gil2015enhanced">[43]</a> . This indeed can be obtained by using the METAD action multiple times in the same input file.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input is for a standard metadynamics calculation using as collective variables the distance between atoms 3 and 5 and the distance between atoms 2 and 4. The value of the CVs and the metadynamics bias potential are written to the COLVAR file every 100 steps. </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1d1" onclick='showPath("eg1","eg1d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg1d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg1d2" onclick='showPath("eg1","eg1d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg1d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg1restraint" onclick='showPath("eg1","eg1restraint")'>restraint: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg1d1">d1</b>,<b name="eg1d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.2,0.2 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=500 <span style="display:none;" id="eg1restraint">The METAD action with label <b>restraint</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg1d1">d1</b>,<b name="eg1d2">d2</b>,<b name="eg1restraint">restraint.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg1">The PRINT action with label <b></b></span>
</pre>
<p> (See also <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> <a class="el" href="_p_r_i_n_t.html">PRINT</a>).</p>
<dl class="section user"><dt></dt><dd>If you use adaptive Gaussian kernels, with diffusion scheme where you use a Gaussian that should cover the space of 20 time steps in collective variables. Note that in this case the histogram correction is needed when summing up hills. 
<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2d1" onclick='showPath("eg2","eg2d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg2d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg2d2" onclick='showPath("eg2","eg2d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg2d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg2restraint" onclick='showPath("eg2","eg2restraint")'>restraint: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2d1">d1</b>,<b name="eg2d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=20 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=500 <div class="tooltip">ADAPTIVE<div class="right">use a geometric (=GEOM) or diffusion (=DIFF) based hills width scheme. <i></i></div></div>=DIFF <span style="display:none;" id="eg2restraint">The METAD action with label <b>restraint</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2d1">d1</b>,<b name="eg2d2">d2</b>,<b name="eg2restraint">restraint.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg2">The PRINT action with label <b></b></span>
</pre>
</dd></dl>
<dl class="section user"><dt></dt><dd>If you use adaptive Gaussian kernels, with geometrical scheme where you use a Gaussian that should cover the space of 0.05 nm in Cartesian space. Note that in this case the histogram correction is needed when summing up hills. 
<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg3d1" onclick='showPath("eg3","eg3d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg3d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg3d2" onclick='showPath("eg3","eg3d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg3d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg3restraint" onclick='showPath("eg3","eg3restraint")'>restraint: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg3d1">d1</b>,<b name="eg3d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.05 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=500 <div class="tooltip">ADAPTIVE<div class="right">use a geometric (=GEOM) or diffusion (=DIFF) based hills width scheme. <i></i></div></div>=GEOM <span style="display:none;" id="eg3restraint">The METAD action with label <b>restraint</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg3d1">d1</b>,<b name="eg3d2">d2</b>,<b name="eg3restraint">restraint.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg3">The PRINT action with label <b></b></span>
</pre>
</dd></dl>
<dl class="section user"><dt></dt><dd>When using adaptive Gaussian kernels you might want to limit how the hills width can change. You can use SIGMA_MIN and SIGMA_MAX keywords. The sigmas should specified in terms of CV so you should use the CV units. Note that if you use a negative number, this means that the limit is not set. Note also that in this case the histogram correction is needed when summing up hills. 
<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg4d1" onclick='showPath("eg4","eg4d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg4d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg4d2" onclick='showPath("eg4","eg4d2")'>d2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=2,4 <span style="display:none;" id="eg4d2">The DISTANCE action with label <b>d2</b> calculates a single scalar value</span>
<b name="eg4restraint" onclick='showPath("eg4","eg4restraint")'>restraint: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg4d1">d1</b>,<b name="eg4d2">d2</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.05 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=500 <div class="tooltip">ADAPTIVE<div class="right">use a geometric (=GEOM) or diffusion (=DIFF) based hills width scheme. <i></i></div></div>=GEOM 
   <div class="tooltip">SIGMA_MIN<div class="right">the lower bounds for the sigmas (in CV units) when using adaptive hills. <i></i></div></div>=0.2,0.1 <div class="tooltip">SIGMA_MAX<div class="right">the upper bounds for the sigmas (in CV units) when using adaptive hills. <i></i></div></div>=0.5,1.0 
...<span style="display:none;" id="eg4restraint">The METAD action with label <b>restraint</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg4d1">d1</b>,<b name="eg4d2">d2</b>,<b name="eg4restraint">restraint.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg4">The PRINT action with label <b></b></span>
</pre>
</dd></dl>
<dl class="section user"><dt></dt><dd>Multiple walkers can be also use as in <a class="el" href="citelist.html#CITEREF_multiplewalkers">[95]</a> These are enabled by setting the number of walker used, the id of the current walker which interprets the input file, the directory where the hills containing files resides, and the frequency to read the other walkers. Here is an example 
<div style="width: 90%; float:left" id="value_details_eg5"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg5d1" onclick='showPath("eg5","eg5d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg5d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg5restraint" onclick='showPath("eg5","eg5restraint")'>restraint: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> ...
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg5d1">d1</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.05 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=500 
   <div class="tooltip">WALKERS_N<div class="right">number of walkers <i></i></div></div>=10 
   <div class="tooltip">WALKERS_ID<div class="right">walker id <i></i></div></div>=3 
   <div class="tooltip">WALKERS_DIR<div class="right">shared directory with the hills files from all the walkers <i></i></div></div>=../ 
   <div class="tooltip">WALKERS_RSTRIDE<div class="right">stride for reading hills files <i></i></div></div>=100 
...<span style="display:none;" id="eg5restraint">The METAD action with label <b>restraint</b> calculates a single scalar value</span>
</pre>
 where WALKERS_N is the total number of walkers, WALKERS_ID is the id of the present walker (starting from 0 ) and the WALKERS_DIR is the directory where all the walkers are located. WALKERS_RSTRIDE is the number of step between one update and the other. Since version 2.2.5, hills files are automatically flushed every WALKERS_RSTRIDE steps.</dd></dl>
<dl class="section user"><dt></dt><dd>The \(c(t)\) reweighting factor can be calculated on the fly using the equations presented in <a class="el" href="citelist.html#CITEREF_Tiwary_jp504920s">[104]</a> as described above. This is enabled by using the keyword CALC_RCT, and can be done only if the bias is defined on a grid. 
<div style="width: 90%; float:left" id="value_details_eg6"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg6phi" onclick='showPath("eg6","eg6phi")'>phi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=1,2,3,4 <span style="display:none;" id="eg6phi">The TORSION action with label <b>phi</b> calculates a single scalar value</span>
<b name="eg6psi" onclick='showPath("eg6","eg6psi")'>psi: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=5,6,7,8 <span style="display:none;" id="eg6psi">The TORSION action with label <b>psi</b> calculates a single scalar value</span>
<b name="eg6metad" onclick='showPath("eg6","eg6metad")'>metad: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> ...
   
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg6phi">phi</b>,<b name="eg6psi">psi</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.20,0.20 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=1.20 <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics and use this bias factor. <i></i></div></div>=5 <div class="tooltip">TEMP<div class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics
<i></i></div></div>=300.0 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=500 
   <div class="tooltip">GRID_MIN<div class="right">the lower bounds for the grid <i></i></div></div>=-pi,-pi <div class="tooltip">GRID_MAX<div class="right">the upper bounds for the grid <i></i></div></div>=pi,pi <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=150,150 
   <div class="tooltip">CALC_RCT<div class="right">( default=off ) calculate the c(t) reweighting factor and use that to obtain the
normalized bias [rbias=bias-rct].This <i></i></div></div> 
   <div class="tooltip">RCT_USTRIDE<div class="right">the update stride for calculating the c(t) reweighting factor.The <i></i></div></div>=10 
...<span style="display:none;" id="eg6metad">The METAD action with label <b>metad</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">metad.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">metad.rbias</td><td>the instantaneous value of the bias normalized using the c(t) reweighting factor [rbias=bias-rct].This component can be used to obtain a reweighted histogram.</td></tr>
<tr><td width="5%%">metad.rct</td><td>the reweighting factor c(t).</td></tr>
</table>
</span>
</pre>
 Here we have asked that the calculation is performed every 10 hills deposition by using RCT_USTRIDE keyword. If this keyword is not given, the calculation will by default be performed every time the bias changes. The \(c(t)\) reweighting factor will be given in the rct component while the instantaneous value of the bias potential normalized using the \(c(t)\) reweighting factor is given in the rbias component [rbias=bias-rct] which can be used to obtain a reweighted histogram or free energy surface using the <a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a> analysis.</dd></dl>
<dl class="section user"><dt></dt><dd>The kinetics of the transitions between basins can also be analyzed on the fly as in <a class="el" href="citelist.html#CITEREF_PRL230602">[103]</a>. The flag ACCELERATION turn on accumulation of the acceleration factor that can then be used to determine the rate. This method can be used together with <a class="el" href="_c_o_m_m_i_t_t_o_r.html">COMMITTOR</a> analysis to stop the simulation when the system get to the target basin. It must be used together with Well-Tempered Metadynamics. If restarting from a previous metadynamics you need to use the ACCELERATION_RFILE keyword to give the name of the data file from which the previous value of the acceleration factor should be read, otherwise the calculation of the acceleration factor will be wrong.</dd></dl>
<dl class="section user"><dt></dt><dd>By using the flag FREQUENCY_ADAPTIVE the frequency adaptive scheme introduced in <a class="el" href="citelist.html#CITEREF_Wang-JCP-2018">[112]</a> is turned on. The frequency for hill addition then changes dynamically based on the acceleration factor according to the following equation <p class="formulaDsp">
\[ \tau_{\mathrm{dep}}(t) = \min\left[ \tau_0 \cdot \max\left[\frac{\alpha(t)}{\theta},1\right] ,\tau_{c} \right] \]
</p>
 where \(\tau_0\) is the initial hill addition frequency given by the PACE keyword, \(\tau_{c}\) is the maximum allowed frequency given by the FA_MAX_PACE keyword, \(\alpha(t)\) is the instantaneous acceleration factor at time \(t\), and \(\theta\) is a threshold value that acceleration factor has to reach before triggering a change in the hill addition frequency given by the FA_MIN_ACCELERATION keyword. The frequency for updating the hill addition frequency according to this equation is given by the FA_UPDATE_FREQUENCY keyword, by default it is the same as the value given in PACE. The hill hill addition frequency increase monotonously such that if the instantaneous acceleration factor is lower than in the previous updating step the previous \(\tau_{\mathrm{dep}}\) is kept rather than updating it to a lower value. The instantaneous hill addition frequency \(\tau_{\mathrm{dep}}(t)\) is outputted to pace component. Note that if restarting from a previous metadynamics run you need to use the ACCELERATION_RFILE keyword to read in the acceleration factors from the previous run, otherwise the hill addition frequency will start from the initial frequency.</dd></dl>
<dl class="section user"><dt></dt><dd>You can also provide a target distribution using the keyword TARGET <a class="el" href="citelist.html#CITEREF_white2015designing">[115]</a> <a class="el" href="citelist.html#CITEREF_marinelli2015ensemble">[73]</a> <a class="el" href="citelist.html#CITEREF_gil2016empirical">[44]</a> The TARGET should be a grid containing a free-energy (i.e. the - \(k_B\)T*log of the desired target distribution). Gaussian kernels will then be scaled by a factor <p class="formulaDsp">
\[ e^{\beta(\tilde{F}(s)-\tilde{F}_{max})} \]
</p>
 Here \(\tilde{F}(s)\) is the free energy defined on the grid and \(\tilde{F}_{max}\) its maximum value. Notice that we here used the maximum value as in ref <a class="el" href="citelist.html#CITEREF_gil2016empirical">[44]</a> This choice allows to avoid exceedingly large Gaussian kernels to be added. However, it could make the Gaussian too small. You should always choose carefully the HEIGHT parameter in this case. The grid file should be similar to other PLUMED grid files in that it should contain both the target free-energy and its derivatives.</dd></dl>
<p>Notice that if you wish your simulation to converge to the target free energy you should use the DAMPFACTOR command to provide a global tempering <a class="el" href="citelist.html#CITEREF_dama2014well">[35]</a> Alternatively, if you use a BIASFACTOR your simulation will converge to a free energy that is a linear combination of the target free energy and of the intrinsic free energy determined by the original force field.</p>

<div style="width: 90%; float:left" id="value_details_eg7"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg7d1" onclick='showPath("eg7","eg7d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg7d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg7t1" onclick='showPath("eg7","eg7t1")'>t1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> ...
   
   <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg7d1">d1</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.05 <div class="tooltip">TAU<div class="right">in well tempered metadynamics, sets height to (k_B Delta T*pace*timestep)/tau <i></i></div></div>=200 <div class="tooltip">DAMPFACTOR<div class="right">damp hills with exp(-max(V)/(kT*DAMPFACTOR) <i></i></div></div>=100 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=250 
   <div class="tooltip">GRID_MIN<div class="right">the lower bounds for the grid <i></i></div></div>=1.14 <div class="tooltip">GRID_MAX<div class="right">the upper bounds for the grid <i></i></div></div>=1.32 <div class="tooltip">GRID_BIN<div class="right">the number of bins for the grid <i></i></div></div>=6 
   <div class="tooltip">TARGET<div class="right">target to a predefined distribution <i></i></div></div>=dist.grid 
...<span style="display:none;" id="eg7t1">The METAD action with label <b>t1</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg7d1">d1</b>,<b name="eg7t1">t1.bias</b> <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=COLVAR <span style="display:none;" id="eg7">The PRINT action with label <b></b></span>
</pre>
<p>The file dist.dat for this calculation would read:</p>
<pre class="fragment">#! FIELDS d1 t1.target der_d1
#! SET min_d1 1.14
#! SET max_d1 1.32
#! SET nbins_d1  6
#! SET periodic_d1 false
   1.1400   0.0031   0.1101
   1.1700   0.0086   0.2842
   1.2000   0.0222   0.6648
   1.2300   0.0521   1.4068
   1.2600   0.1120   2.6873
   1.2900   0.2199   4.6183
   1.3200   0.3948   7.1055
</pre><p>Notice that BIASFACTOR can also be chosen as equal to 1. In this case one will perform unbiased sampling. Instead of using HEIGHT, one should provide the TAU parameter. </p>
<div style="width: 90%; float:left" id="value_details_eg8"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg8d" onclick='showPath("eg8","eg8d")'>d: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg8d">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg8d">d</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.1 <div class="tooltip">TAU<div class="right">in well tempered metadynamics, sets height to (k_B Delta T*pace*timestep)/tau <i></i></div></div>=4.0 <div class="tooltip">TEMP<div class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics
<i></i></div></div>=300 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=100 <div class="tooltip">BIASFACTOR<div class="right">use well tempered metadynamics and use this bias factor. <i></i></div></div>=1.0 <span style="display:none;" id="eg8">The METAD action with label <b></b></span>
</pre>
<p> The HILLS file obtained will still work with <code>plumed sum_hills</code> so as to plot a free-energy. The case where this makes sense is probably that of RECT simulations.</p>
<p>Regarding RECT simulations, you can also use the RECT keyword so as to avoid using multiple input files. For instance, a single input file will be </p>
<div style="width: 90%; float:left" id="value_details_eg9"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg9d" onclick='showPath("eg9","eg9d")'>d: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=3,5 <span style="display:none;" id="eg9d">The DISTANCE action with label <b>d</b> calculates a single scalar value</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg9d">d</b> <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.1 <div class="tooltip">TAU<div class="right">in well tempered metadynamics, sets height to (k_B Delta T*pace*timestep)/tau <i></i></div></div>=4.0 <div class="tooltip">TEMP<div class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics
<i></i></div></div>=300 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=100 <div class="tooltip">RECT<div class="right">list of bias factors for all the replicas <i></i></div></div>=1.0,1.5,2.0,3.0 <span style="display:none;" id="eg9">The METAD action with label <b></b></span>
</pre>
<p> The number of elements in the RECT array should be equal to the number of replicas.</p>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
</table>
<p>In addition the following quantities can be calculated by employing the keywords listed below</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> rbias </b> </td><td width="10%"><b> CALC_RCT </b>  </td><td>the instantaneous value of the bias normalized using the c(t) reweighting factor [rbias=bias-rct].This component can be used to obtain a reweighted histogram.   </td></tr>
<tr>
<td width="5%"><b> rct </b> </td><td width="10%"><b> CALC_RCT </b>  </td><td>the reweighting factor c(t).   </td></tr>
<tr>
<td width="5%"><b> work </b> </td><td width="10%"><b> CALC_WORK </b>  </td><td>accumulator for work   </td></tr>
<tr>
<td width="5%"><b> acc </b> </td><td width="10%"><b> ACCELERATION </b>  </td><td>the metadynamics acceleration factor   </td></tr>
<tr>
<td width="5%"><b> maxbias </b> </td><td width="10%"><b> CALC_MAX_BIAS </b>  </td><td>the maximum of the metadynamics V(s, t)   </td></tr>
<tr>
<td width="5%"><b> transbias </b> </td><td width="10%"><b> CALC_TRANSITION_BIAS </b>  </td><td>the metadynamics transition bias V*(t)   </td></tr>
<tr>
<td width="5%"><b> pace </b> </td><td width="10%"><b> FREQUENCY_ADAPTIVE </b>  </td><td>the hill addition frequency when employing frequency adaptive metadynamics   </td></tr>
<tr>
<td width="5%"><b> nlker </b> </td><td width="10%"><b> NLIST </b>  </td><td>number of hills in the neighbor list   </td></tr>
<tr>
<td width="5%"><b> nlsteps </b> </td><td width="10%"><b> NLIST </b>  </td><td>number of steps from last neighbor list update   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> SIGMA </b> </td><td>the widths of the Gaussian hills   </td></tr>
<tr>
<td width="15%"><b> PACE </b> </td><td>the frequency for hill addition   </td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>( default=HILLS ) a file in which the list of added hills is stored   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> CALC_WORK </b> </td><td>( default=off ) calculate the total accumulated work done by the bias since last restart   </td></tr>
<tr>
<td width="15%"><b> CALC_RCT </b> </td><td>( default=off ) calculate the c(t) reweighting factor and use that to obtain the normalized bias [rbias=bias-rct].This method is not compatible with metadynamics not on a grid.   </td></tr>
<tr>
<td width="15%"><b> GRID_SPARSE </b> </td><td>( default=off ) use a sparse grid to store hills   </td></tr>
<tr>
<td width="15%"><b> GRID_NOSPLINE </b> </td><td>( default=off ) don't use spline interpolation with grids   </td></tr>
<tr>
<td width="15%"><b> STORE_GRIDS </b> </td><td>( default=off ) store all the grid files the calculation generates. They will be deleted if this keyword is not present   </td></tr>
<tr>
<td width="15%"><b> NLIST </b> </td><td>( default=off ) Use neighbor list for kernels summation, faster but experimental   </td></tr>
<tr>
<td width="15%"><b> WALKERS_MPI </b> </td><td>( default=off ) Switch on MPI version of multiple walkers - not compatible with WALKERS_* options other than WALKERS_DIR   </td></tr>
<tr>
<td width="15%"><b> FLYING_GAUSSIAN </b> </td><td>( default=off ) Switch on flying Gaussian method, must be used with WALKERS_MPI   </td></tr>
<tr>
<td width="15%"><b> ACCELERATION </b> </td><td>( default=off ) Set to TRUE if you want to compute the metadynamics acceleration factor.   </td></tr>
<tr>
<td width="15%"><b> CALC_MAX_BIAS </b> </td><td>( default=off ) Set to TRUE if you want to compute the maximum of the metadynamics V(s, t)   </td></tr>
<tr>
<td width="15%"><b> CALC_TRANSITION_BIAS </b> </td><td>( default=off ) Set to TRUE if you want to compute a metadynamics transition bias V*(t)   </td></tr>
<tr>
<td width="15%"><b> FREQUENCY_ADAPTIVE </b> </td><td><p class="starttd">( default=off ) Set to TRUE if you want to enable frequency adaptive metadynamics such that the frequency for hill addition to change dynamically based on the acceleration factor.  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> HEIGHT </b> </td><td>the heights of the Gaussian hills. Compulsory unless TAU and either BIASFACTOR or DAMPFACTOR are given   </td></tr>
<tr>
<td width="15%"><b> FMT </b> </td><td>specify format for HILLS files (useful for decrease the number of digits in regtests)   </td></tr>
<tr>
<td width="15%"><b> BIASFACTOR </b> </td><td>use well tempered metadynamics and use this bias factor. Please note you must also specify temp   </td></tr>
<tr>
<td width="15%"><b> RECT </b> </td><td>list of bias factors for all the replicas   </td></tr>
<tr>
<td width="15%"><b> DAMPFACTOR </b> </td><td>damp hills with exp(-max(V)/(kT*DAMPFACTOR)   </td></tr>
<tr>
<td width="15%"><b> TTBIASFACTOR </b> </td><td>use transition tempered metadynamics with this bias factor. Please note you must also specify temp   </td></tr>
<tr>
<td width="15%"><b> TTBIASTHRESHOLD </b> </td><td>use transition tempered metadynamics with this bias threshold. Please note you must also specify TTBIASFACTOR   </td></tr>
<tr>
<td width="15%"><b> TTALPHA </b> </td><td>use transition tempered metadynamics with this hill size decay exponent parameter. Please note you must also specify TTBIASFACTOR   </td></tr>
<tr>
<td width="15%"><b> TARGET </b> </td><td>target to a predefined distribution   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature - this is only needed if you are doing well-tempered metadynamics   </td></tr>
<tr>
<td width="15%"><b> TAU </b> </td><td>in well tempered metadynamics, sets height to (k_B Delta T*pace*timestep)/tau   </td></tr>
<tr>
<td width="15%"><b> RCT_USTRIDE </b> </td><td>the update stride for calculating the c(t) reweighting factor.The default 1, so c(t) is updated every time the bias is updated.   </td></tr>
<tr>
<td width="15%"><b> GRID_MIN </b> </td><td>the lower bounds for the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_MAX </b> </td><td>the upper bounds for the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_BIN </b> </td><td>the number of bins for the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_SPACING </b> </td><td>the approximate grid spacing (to be used as an alternative or together with GRID_BIN)   </td></tr>
<tr>
<td width="15%"><b> GRID_WSTRIDE </b> </td><td>write the grid to a file every N steps   </td></tr>
<tr>
<td width="15%"><b> GRID_WFILE </b> </td><td>the file on which to write the grid   </td></tr>
<tr>
<td width="15%"><b> GRID_RFILE </b> </td><td>a grid file from which the bias should be read at the initial step of the simulation   </td></tr>
<tr>
<td width="15%"><b> NLIST_PARAMETERS </b> </td><td>(default=6.,0.5) the two cutoff parameters for the Gaussians neighbor list   </td></tr>
<tr>
<td width="15%"><b> ADAPTIVE </b> </td><td>use a geometric (=GEOM) or diffusion (=DIFF) based hills width scheme. Sigma is one number that has distance units or time step dimensions   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MAX </b> </td><td>the upper bounds for the sigmas (in CV units) when using adaptive hills. Negative number means no bounds   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MIN </b> </td><td>the lower bounds for the sigmas (in CV units) when using adaptive hills. Negative number means no bounds   </td></tr>
<tr>
<td width="15%"><b> WALKERS_ID </b> </td><td>walker id   </td></tr>
<tr>
<td width="15%"><b> WALKERS_N </b> </td><td>number of walkers   </td></tr>
<tr>
<td width="15%"><b> WALKERS_DIR </b> </td><td>shared directory with the hills files from all the walkers   </td></tr>
<tr>
<td width="15%"><b> WALKERS_RSTRIDE </b> </td><td>stride for reading hills files   </td></tr>
<tr>
<td width="15%"><b> INTERVAL </b> </td><td>one dimensional lower and upper limits, outside the limits the system will not feel the biasing force.   </td></tr>
<tr>
<td width="15%"><b> ACCELERATION_RFILE </b> </td><td>a data file from which the acceleration should be read at the initial step of the simulation   </td></tr>
<tr>
<td width="15%"><b> TRANSITIONWELL </b> </td><td>This keyword appears multiple times as TRANSITIONWELL followed by an integer. Each specifies the coordinates for one well as in transition-tempered metadynamics. At least one must be provided.. You can use multiple instances of this keyword i.e. TRANSITIONWELL1, TRANSITIONWELL2, TRANSITIONWELL3...   </td></tr>
<tr>
<td width="15%"><b> FA_UPDATE_FREQUENCY </b> </td><td>the frequency for updating the hill addition pace in frequency adaptive metadynamics, by default this is equal to the value given in PACE   </td></tr>
<tr>
<td width="15%"><b> FA_MAX_PACE </b> </td><td>the maximum hill addition frequency allowed in frequency adaptive metadynamics. By default there is no maximum value.   </td></tr>
<tr>
<td width="15%"><b> FA_MIN_ACCELERATION </b> </td><td>only update the hill addition pace in frequency adaptive metadynamics after reaching the minimum acceleration factor given here. By default it is 1.0.   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
<tr>
<td width="15%"><b> UPDATE_FROM </b> </td><td>Only update this action from this time   </td></tr>
<tr>
<td width="15%"><b> UPDATE_UNTIL </b> </td><td>Only update this action until this time   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_bias.html">Bias</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
