<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: BF_WAVELETS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_b_f__w_a_v_e_l_e_t_s.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">BF_WAVELETS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the ves <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=ves . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Daubechies Wavelets basis functions.</p>
<p>Note: at the moment only bases with a single level of scaling functions are usable, as multiscale optimization is not yet implemented.</p>
<p>This basis set uses Daubechies Wavelets <a class="el" href="citelist.html#CITEREF_daubechies_ten_1992">[36]</a> to construct a complete and orthogonal basis. See <a class="el" href="citelist.html#CITEREF_ValssonPampel_Wavelets_2022">[83]</a> for full details.</p>
<p>The basis set is based on using a pair of functions, the scaling function (or father wavelet) \(\phi\) and the wavelet function (or mother wavelet) \(\psi\). They are defined via the two-scale relations for scale \(j\) and shift \(k\):</p>
<p class="formulaDsp">
\begin{align*} \phi_k^j \left(x\right) = 2^{-j/2} \phi \left( 2^{-j} x - k\right)\\ \psi_k^j \left(x\right) = 2^{-j/2} \psi \left( 2^{-j} x - k\right) \end{align*}
</p>
<p>The exact properties are set by choosing filter coefficients, e.g. choosing \(h_k\) for the father wavelet:</p>
<p class="formulaDsp">
\[ \phi\left(x\right) = \sqrt{2} \sum_k h_k\, \phi \left( 2 x - k\right) \]
</p>
<p>The filter coefficients by Daubechies result in an orthonormal basis of all integer shifted functions: </p><p class="formulaDsp">
\[ \int \phi(x+i) \phi(x+j) \mathop{}\!\mathrm{d}x = \delta_{ij} \quad \text{for} \quad i,j \in \mathbb{Z} \]
</p>
<p>Because no analytic formula for these wavelets exist, they are instead constructed iteratively on a grid. The method of construction is close to the "Vector cascade algorithm" described in <a class="el" href="citelist.html#CITEREF_strang_wavelets_1997">[101]</a> . The needed filter coefficients of the scaling function are hardcoded, and were previously generated via a python script. Currently the "maximum phase" type (Db) and the "least asymmetric" (Sym) type are implemented. We recommend to use Symlets.</p>
<p>As an example two adjacent basis functions of both Sym8 (ORDER=8, TYPE=SYMLET) and Db8 (ORDER=8, TYPE=DAUBECHIES) is shown in the figure. The full basis consists of shifted wavelets in the full specified interval.</p>
<div class="image">
<img src="ves_basisf-wavelets.png" alt=""/>
</div>
<dl class="section user"><dt>Specify the wavelet type</dt><dd></dd></dl>
<p>The TYPE keyword sets the type of Wavelet, at the moment "DAUBECHIES" and "SYMLETS" are available. The specified ORDER of the basis corresponds to the number of vanishing moments of the wavelet, i.e. if TYPE was specified as "DAUBECHIES" an order of 8 results in Db8 wavelets.</p>
<dl class="section user"><dt>Specify the number of functions</dt><dd></dd></dl>
<p>The resulting basis set consists of integer shifts of the wavelet with some scaling \(j\), </p><p class="formulaDsp">
\[ V(x) = \sum_i \alpha_i * \phi_i (x) = \sum_i \alpha_i * \phi(\frac{x+i}{j}) \]
</p>
<p> with the variational parameters \( \alpha \). Additionally a constant basis function is included.</p>
<p>There are two different ways to specify the number of used basis functions implemented. You can either specify the scale or alternatively a fixed number of basis function.</p>
<p>Coming from the multiresolution aspect of wavelets, you can set the scale of the father wavelets, i.e. the largest scale used for approximation. This can be done with the FUNCTION_LENGTH keyword. It should be given in the same units as the used CV and specifies the length (of the domain interval) of the individual father wavelet functions.</p>
<p>Alternatively a fixed number of basis functions for the bias expansion can be specified with the NUM_BF keyword, which will set the scale automatically to match the desired number of functions. Note that this also includes the constant function.</p>
<p>If you do not specify anything, it is assumed that the range of the bias should match the scale of the wavelet functions. More precise, the basis functions are scaled to match the specified size of the CV space (MINIMUM and MAXIMUM keywords). This has so far been a good initial choice.</p>
<p>If the wavelets are scaled to match the CV range exactly there would be \(4*\text{ORDER} -3\) basis functions whose domain is at least partially in this region. This number is adjusted if FUNCTION_LENGTH or NUM_BF is specified. Additionally, some of the shifted basis functions will not have significant contributions because of their function values being close to zero over the full range of the bias. These 'tail wavelets' can be omitted by using the TAILS_THRESHOLD keyword. This omits all shifted functions that have only function values smaller than a fraction of their maximum value inside the bias range. Using a value of e.g. 0.01 will already reduce the number of basis functions significantly. The default setting will not omit any tail wavelets (i.e. TAILS_THRESHOLD=0).</p>
<p>The number of basis functions is then not easily determinable a priori but will be given in the logfile. Additionally the starting point (leftmost defined point) of the individual basis functions is printed.</p>
<p>With the PERIODIC keyword the basis set can also be used to bias periodic CVs. Then the shift between the functions will be chosen such that the function at the left border and right border coincide. If the FUNCTION_LENGTH keyword is used together with PERIODIC, a smaller length might be chosen to satisfy this requirement.</p>
<dl class="section user"><dt>Grid</dt><dd></dd></dl>
<p>The values of the wavelet function are generated on a grid. Using the cascade algorithm results in doubling the grid values for each iteration. This means that the grid size will always be a power of two multiplied by the number of coefficients ( \( 2*\text{ORDER} -1\)) for the specified wavelet. Using the MIN_GRID_SIZE keyword a lower bound for the number of grid points can be specified. By default at least 1,000 grid points are used. Function values in between grid points are calculated by linear interpolation.</p>
<dl class="section user"><dt>Optimization notes</dt><dd></dd></dl>
<p>To avoid 'blind' optimization of the basis functions outside the currently sampled area, it is often beneficial to use the OPTIMIZATION_THRESHOLD keyword of the <a class="el" href="_v_e_s__l_i_n_e_a_r__e_x_p_a_n_s_i_o_n.html">VES_LINEAR_EXPANSION</a> (set it to a small value, e.g. 1e-6)</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>First a very simple example that relies on the default values. We want to bias some CV in the range of 0 to 4. The wavelets will therefore be scaled to match that range. Using Db8 wavelets this results in 30 basis functions (including the constant one), with their starting points given by \( -14*\frac{4}{15}, -13*\frac{4}{15}, \cdots , 0 , \cdots, 13*\frac{4}{15}, 14*\frac{4}{15} \). </p>
<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg1bf" onclick='showPath("eg1","eg1bf")'>bf: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__w_a_v_e_l_e_t_s.html" style="color:green">BF_WAVELETS</a> ...
   <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=8 
   <div class="tooltip">TYPE<div class="right"><b>compulsory keyword </b>
Specify the wavelet type. <i></i></div></div>=DAUBECHIES 
   <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=0.0 
   <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=4.0 
   
...<span style="display:none;" id="eg1bf">The BF_WAVELETS action with label <b>bf</b></span>
</pre>
<p>By omitting wavelets with only insignificant parts, we can reduce the number of basis functions. Using a threshold of 0.01 will in this example remove the 8 leftmost shifts, which we can check in the logfile. </p>
<div style="width: 90%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg2bf" onclick='showPath("eg2","eg2bf")'>bf: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__w_a_v_e_l_e_t_s.html" style="color:green">BF_WAVELETS</a> ...
   <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=8 
   <div class="tooltip">TYPE<div class="right"><b>compulsory keyword </b>
Specify the wavelet type. <i></i></div></div>=DAUBECHIES 
   <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=0.0 
   <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=4.0 
   <div class="tooltip">TAILS_THRESHOLD<div class="right">The threshold for cutting off tail wavelets as a fraction of the maximum value. <i></i></div></div>=0.01 
   
...<span style="display:none;" id="eg2bf">The BF_WAVELETS action with label <b>bf</b></span>
</pre>
<p>The length of the individual basis functions can also be adjusted to fit the specific problem. If for example the wavelets are instead scaled to length 3, there will be 35 basis functions, with leftmost points at \( -14*\frac{3}{15}, -13*\frac{3}{15}, \cdots, 0, \cdots, 18*\frac{3}{15}, 19*\frac{3}{15} \). </p>
<div style="width: 90%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg3bf" onclick='showPath("eg3","eg3bf")'>bf: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__w_a_v_e_l_e_t_s.html" style="color:green">BF_WAVELETS</a> ...
   <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=8 
   <div class="tooltip">TYPE<div class="right"><b>compulsory keyword </b>
Specify the wavelet type. <i></i></div></div>=DAUBECHIES 
   <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=0.0 
   <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=4.0 
   <div class="tooltip">FUNCTION_LENGTH<div class="right">The domain size of the individual basis functions. <i></i></div></div>=3 
   
...<span style="display:none;" id="eg3bf">The BF_WAVELETS action with label <b>bf</b></span>
</pre>
<p>Alternatively you can also specify the number of basis functions. Here we specify the usage of 40 Sym10 wavelet functions. We also used a custom minimum size for the grid and want it to be printed to a file with a specific numerical format. </p>
<div style="width: 90%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg4bf" onclick='showPath("eg4","eg4bf")'>bf: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_b_f__w_a_v_e_l_e_t_s.html" style="color:green">BF_WAVELETS</a> ...
   <div class="tooltip">ORDER<div class="right"><b>compulsory keyword </b>
The order of the basis function expansion. <i></i></div></div>=10 
   <div class="tooltip">TYPE<div class="right"><b>compulsory keyword </b>
Specify the wavelet type. <i></i></div></div>=SYMLETS 
   <div class="tooltip">MINIMUM<div class="right"><b>compulsory keyword </b>
The minimum of the interval on which the basis functions are defined. <i></i></div></div>=0.0 
   <div class="tooltip">MAXIMUM<div class="right"><b>compulsory keyword </b>
The maximum of the interval on which the basis functions are defined. <i></i></div></div>=4.0 
   <div class="tooltip">NUM_BF<div class="right">The number of basis functions that should be used. <i></i></div></div>=40 
   <div class="tooltip">MIN_GRID_SIZE<div class="right">The minimal number of grid bins of the Wavelet function. <i></i></div></div>=500 
   <div class="tooltip">DUMP_WAVELET_GRID<div class="right">( default=off ) If this flag is set the grid with the wavelet values will be written
to a file. <i></i></div></div> 
   <div class="tooltip">WAVELET_FILE_FMT<div class="right">The number format of the wavelet grid values and derivatives written to file. <i></i></div></div>=%11.4f 
   
...<span style="display:none;" id="eg4bf">The BF_WAVELETS action with label <b>bf</b></span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ORDER </b> </td><td>The order of the basis function expansion.   </td></tr>
<tr>
<td width="15%"><b> MINIMUM </b> </td><td>The minimum of the interval on which the basis functions are defined.   </td></tr>
<tr>
<td width="15%"><b> MAXIMUM </b> </td><td>The maximum of the interval on which the basis functions are defined.   </td></tr>
<tr>
<td width="15%"><b> TYPE </b> </td><td>Specify the wavelet type. Currently available are DAUBECHIES Wavelets with minimum phase and the more symmetric SYMLETS   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> DEBUG_INFO </b> </td><td>( default=off ) Print out more detailed information about the basis set. Useful for debugging.   </td></tr>
<tr>
<td width="15%"><b> MOTHER_WAVELET </b> </td><td>( default=off ) If this flag is set mother wavelets will be used instead of the scaling function (father wavelet). Makes only sense for multiresolution, which is at the moment not usable.   </td></tr>
<tr>
<td width="15%"><b> DUMP_WAVELET_GRID </b> </td><td>( default=off ) If this flag is set the grid with the wavelet values will be written to a file. This file is called wavelet_grid.data.   </td></tr>
<tr>
<td width="15%"><b> PERIODIC </b> </td><td><p class="starttd">( default=off ) Use periodic version of basis set.  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> FUNCTION_LENGTH </b> </td><td>The domain size of the individual basis functions. (length) This is used to alter the scaling of the basis functions. By default it is set to the total size of the interval. This also influences the number of actually used basis functions, as all shifted functions that are partially supported in the CV space are used.   </td></tr>
<tr>
<td width="15%"><b> NUM_BF </b> </td><td>The number of basis functions that should be used. Includes the constant one and N-1 shifted wavelets within the specified range. Cannot be used together with FUNCTION_LENGTH.   </td></tr>
<tr>
<td width="15%"><b> TAILS_THRESHOLD </b> </td><td>The threshold for cutting off tail wavelets as a fraction of the maximum value. All shifted wavelet functions that only have values smaller than the threshold in the bias range will be excluded from the basis set. Defaults to 0 (include all).   </td></tr>
<tr>
<td width="15%"><b> MIN_GRID_SIZE </b> </td><td>The minimal number of grid bins of the Wavelet function. The true number depends also on the used wavelet type and will probably be larger. Defaults to 1000.   </td></tr>
<tr>
<td width="15%"><b> WAVELET_FILE_FMT </b> </td><td>The number format of the wavelet grid values and derivatives written to file. By default it is %15.8f.   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_v_e_s.html">Variationally Enhanced Sampling (VES code)</a></li><li class="navelem"><a class="el" href="ves_basisf.html">Basis functions</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
