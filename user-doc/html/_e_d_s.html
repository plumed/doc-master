<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: EDS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
   var redpath = "";
   
   function showPath(eg,name) {
     var i; var y = document.getElementsByName(redpath);
     for (i=0; i < y.length; i++ ) { y[i].style.color="black"; }
     var x = document.getElementsByName(name); redpath=name;
     for (i = 0; i < x.length; i++) { x[i].style.color="red"; }
     var valid="value_details_".concat(eg);
     var valueField = document.getElementById(valid);
     var dataField = document.getElementById(name);
     valueField.innerHTML = dataField.innerHTML;
   }
   function swapInput(name) {
     var btn = document.getElementById(name + "_button");
     var mydiv = document.getElementById("input_" + name);
     if( btn.textContent=="expand shortcuts" ) {
         btn.textContent = "contract shortcuts";
         var dataField = document.getElementById(name + "long");
         mydiv.innerHTML = dataField.innerHTML;
     } else if( btn.textContent=="contract shortcuts" ) {
         btn.textContent = "expand shortcuts";
         var dataField = document.getElementById(name + "short");
         mydiv.innerHTML = dataField.innerHTML;
     }
   }
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_e_d_s.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EDS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the eds <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=eds . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Add a linear bias on a set of observables.</p>
<p>This force is the same as the linear part of the bias in <a class="el" href="_r_e_s_t_r_a_i_n_t.html">RESTRAINT</a>, but this bias has the ability to compute the prefactors adaptively using the scheme of White and Voth <a class="el" href="citelist.html#CITEREF_white2014efficient">[114]</a> in order to match target observable values for a set of CVs. Further updates to the algorithm are described in <a class="el" href="citelist.html#CITEREF_hocky2017cgds">[51]</a> and you can read a review on the method and its applications here: <a class="el" href="citelist.html#CITEREF_Amirkulova2019Recent">[2]</a>.</p>
<p>You can see a tutorial on EDS specifically for biasing coordination number at <a href="http://thewhitelab.org/blog/tutorial/2017/05/10/lammps-coordination-number-tutorial/">Andrew White's webpage</a>.</p>
<p>The addition to the potential is of the form </p><p class="formulaDsp">
\[ \sum_i \frac{\alpha_i}{s_i} x_i \]
</p>
<p>where for CV \(x_i\), a coupling constant \({\alpha}_i\) is determined adaptively or set by the user to match a target value for \(x_i\). \(s_i\) is a scale parameter, which by default is set to the target value. It may also be set separately.</p>
<dl class="section warning"><dt>Warning</dt><dd>It is not possible to set the target value of the observable to zero with the default value of \(s_i\) as this will cause a divide-by-zero error. Instead, set \(s_i=1\) or modify the CV so the desired target value is no longer zero.</dd></dl>
<p>Notice that a similar method is available as <a class="el" href="_m_a_x_e_n_t.html">MAXENT</a>, although with different features and using a different optimization algorithm.</p>
<dl class="section user"><dt>Virial</dt><dd></dd></dl>
<p>The bias forces modify the virial and this can change your simulation density if the bias is used in an NPT simulation. One way to avoid changing the virial contribution from the bias is to add the keyword VIRIAL=1.0, which changes how the bias is computed to minimize its contribution to the virial. This can also lead to smaller magnitude biases that are more robust if transferred to other systems. VIRIAL=1.0 can be a reasonable starting point and increasing the value changes the balance between matching the set-points and minimizing the virial. See <a class="el" href="citelist.html#CITEREF_Amirkulova2019Recent">[2]</a> for details on the equations. Since the coupling constants are unique with a single CV, VIRIAL is not applicable with a single CV. When used with multiple CVs, the CVs should be correlated which is almost always the case.</p>
<dl class="section user"><dt>Weighting</dt><dd></dd></dl>
<p>EDS computes means and variances as part of its algorithm. If you are also using a biasing method like metadynamics, you may wish to remove the effect of this bias in your EDS computations so that EDS works on the canonical values (reweighted to be unbiased). For example, you may be using metadynamics to bias a dihedral angle to enhance sampling and be using EDS to set the average distance between two particular atoms. Specifically:</p>

<div style="width: 90%; float:left" id="value_details_eg1"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-failed-red.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<span style="color:blue"># set-up metadynamics</span>
<b name="eg1t" onclick='showPath("eg1","eg1t")'>t: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> <div class="tooltip">ATOMS<div class="right">the four atoms involved in the torsional angle <i></i></div></div>=1,2,3,4 <span style="display:none;" id="eg1t"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1md" onclick='showPath("eg1","eg1md")'>md: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_m_e_t_a_d.html" style="color:green">METAD</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=d <div class="tooltip">SIGMA<div class="right"><b>compulsory keyword </b>
the widths of the Gaussian hills <i></i></div></div>=0.2 <div class="tooltip">HEIGHT<div class="right">the heights of the Gaussian hills. <i></i></div></div>=0.3 <div class="tooltip">PACE<div class="right"><b>compulsory keyword </b>
the frequency for hill addition <i></i></div></div>=500 <div class="tooltip">TEMP<div class="right">the system temperature - this is only needed if you are doing well-tempered metadynamics
<i></i></div></div>=300 <span style="display:none;" id="eg1md"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># compute bias weights</span>
<b name="eg1bias" onclick='showPath("eg1","eg1bias")'>bias: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_r_e_w_e_i_g_h_t__m_e_t_a_d.html" style="color:green">REWEIGHT_METAD</a> <div class="tooltip">TEMP<div class="right">the system temperature. <i></i></div></div>=300 <span style="display:none;" id="eg1bias"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<span style="color:blue"># now do EDS on distance while removing effect of metadynamics</span>
<b name="eg1d" onclick='showPath("eg1","eg1d")'>d: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=4,7 <span style="display:none;" id="eg1d"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
<b name="eg1eds" onclick='showPath("eg1","eg1eds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg1d">d</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=3.0 <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=100 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=300 <div class="tooltip">LOGWEIGHTS<div class="right">Add weights to use for computing statistics. <i></i></div></div>=<b name="eg1bias">bias</b> <span style="display:none;" id="eg1eds"> You cannot view the components that are calculated by each action for this input file. Sorry </span>
</pre>
<p>This is an approximation though because EDS uses a finite samples while running to get means/variances. At the end of a run, you should ensure this approach worked and indeed your reweighted CV matches the target value.</p>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input for a harmonic oscillator of two beads will adaptively find a linear bias to change the mean and variance to the target values. The PRINT line shows how to access the value of the coupling constants.</p>

<div style="width: 80%; float:left" id="value_details_eg2"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg2_button" onclick='swapInput("eg2")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg2"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg2Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg2Load);
}
function eg2Load(event) {
       swapInput("eg2");
}
</script>
<div style="display:none;" id="eg2short">
<pre style="width: 97%;" class="fragment">
<b name="eg2shortdist" onclick='showPath("eg2","eg2shortdist")'>dist: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg2shortdist">The DISTANCE action with label <b>dist</b> calculates a single scalar value</span>
<span style="color:blue"># this is the squared of the distance</span>
<b name="eg2shortdist2" onclick='showPath("eg2","eg2shortdist2")'>dist2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg2shortdist">dist</b> <div class="tooltip">POWERS<div class="right"><b>compulsory keyword ( default=1.0 )</b>
the powers to which you are raising each of the arguments in your function <i></i></div></div>=2 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg2shortdist2">The COMBINE action with label <b>dist2</b> calculates a single scalar value</span>
<span style="color:blue"># bias mean and variance</span>
<b name="eg2shorteds" onclick='showPath("eg2","eg2shorteds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2shortdist">dist</b>,<b name="eg2shortdist2">dist2</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0,1.0 <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=100 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <span style="display:none;" id="eg2shorteds">The EDS action with label <b>eds</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">eds.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">eds.force2</td><td>squared value of force from the bias</td></tr>
<tr><td width="5%%">eds.dist_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist</td></tr>
<tr><td width="5%%">eds.dist2_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist2</td></tr>
</table>
</span>
<a href="https://www.plumed.org/doc-master/user-doc/html/_p_r_i_n_t.html" style="color:green">PRINT</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the values that you would like to print to the file <i></i></div></div>=<b name="eg2shortdist">dist</b>,<b name="eg2shortdist2">dist2</b>,<b name="eg2shorteds">eds.dist_coupling</b>,<b name="eg2shorteds">eds.dist2_coupling</b>,<b name="eg2shorteds">eds.bias</b>,<b name="eg2shorteds">eds.force2</b> <div class="tooltip">FILE<div class="right">the name of the file on which to output these quantities <i></i></div></div>=colvars.dat <div class="tooltip">STRIDE<div class="right"><b>compulsory keyword ( default=1 )</b>
the frequency with which the quantities of interest should be output <i></i></div></div>=100 <span style="display:none;" id="eg2short">The PRINT action with label <b></b></span>
</pre>
</div>
<div style="display:none;" id="eg2long"><pre style="width: 97%;" class="fragment">
<b name="eg2longdist" onclick='showPath("eg2","eg2longdist")'>dist: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg2longdist">The DISTANCE action with label <b>dist</b> calculates a single scalar value</span>
<span style="color:blue"># this is the squared of the distance</span>
<span style="color:blue"># bias mean and variance</span>
<b name="eg2longeds" onclick='showPath("eg2","eg2longeds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg2longdist">dist</b>,dist2 <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0,1.0 <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=100 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <span style="display:none;" id="eg2longeds">The EDS action with label <b>eds</b><hr  />
<p>Rather than trying to find the coupling constants adaptively, one can ramp up to a constant value. </p>
<div style="width: 80%; float:left" id="value_details_eg3"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg3_button" onclick='swapInput("eg3")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg3"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg3Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg3Load);
}
function eg3Load(event) {
       swapInput("eg3");
}
</script>
<div style="display:none;" id="eg3short">
<pre style="width: 97%;" class="fragment">
<b name="eg3shortdist" onclick='showPath("eg3","eg3shortdist")'>dist: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg3shortdist">The DISTANCE action with label <b>dist</b> calculates a single scalar value</span>
<b name="eg3shortdist2" onclick='showPath("eg3","eg3shortdist2")'>dist2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg3shortdist">dist</b> <div class="tooltip">POWERS<div class="right"><b>compulsory keyword ( default=1.0 )</b>
the powers to which you are raising each of the arguments in your function <i></i></div></div>=2 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg3shortdist2">The COMBINE action with label <b>dist2</b> calculates a single scalar value</span>
<span style="color:blue"># ramp couplings from 0,0 to -1,1 over 50000 steps</span>
<b name="eg3shorteds" onclick='showPath("eg3","eg3shorteds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg3shortdist">dist</b>,<b name="eg3shortdist2">dist2</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0,1.0 <div class="tooltip">FIXED<div class="right"><b>compulsory keyword ( default=0 )</b>
Fixed target values for coupling constant. <i></i></div></div>=-1,1 <div class="tooltip">RAMP<div class="right">( default=off ) Slowly increase bias constant to a fixed value <i></i></div></div> <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=50000 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <span style="display:none;" id="eg3shorteds">The EDS action with label <b>eds</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">eds.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">eds.force2</td><td>squared value of force from the bias</td></tr>
<tr><td width="5%%">eds.dist_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist</td></tr>
<tr><td width="5%%">eds.dist2_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist2</td></tr>
</table>
</span>
<span style="color:blue"># same as above, except starting at -0.5,0.5 rather than default of 0,0</span>
<b name="eg3shorteds2" onclick='showPath("eg3","eg3shorteds2")'>eds2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg3shortdist">dist</b>,<b name="eg3shortdist2">dist2</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0,1.0 <div class="tooltip">FIXED<div class="right"><b>compulsory keyword ( default=0 )</b>
Fixed target values for coupling constant. <i></i></div></div>=-1,1 <div class="tooltip">INIT<div class="right"><b>compulsory keyword ( default=0 )</b>
Starting value for coupling constant <i></i></div></div>=-0.5,0.5 <div class="tooltip">RAMP<div class="right">( default=off ) Slowly increase bias constant to a fixed value <i></i></div></div> <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=50000 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <span style="display:none;" id="eg3shorteds2">The EDS action with label <b>eds2</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">eds2.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">eds2.force2</td><td>squared value of force from the bias</td></tr>
<tr><td width="5%%">eds2.dist_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist</td></tr>
<tr><td width="5%%">eds2.dist2_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist2</td></tr>
</table>
</span>
</pre>
</div>
<div style="display:none;" id="eg3long"><pre style="width: 97%;" class="fragment">
<b name="eg3longdist" onclick='showPath("eg3","eg3longdist")'>dist: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg3longdist">The DISTANCE action with label <b>dist</b> calculates a single scalar value</span>
<span style="color:blue"># ramp couplings from 0,0 to -1,1 over 50000 steps</span>
<b name="eg3longeds" onclick='showPath("eg3","eg3longeds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg3longdist">dist</b>,dist2 <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0,1.0 <div class="tooltip">FIXED<div class="right"><b>compulsory keyword ( default=0 )</b>
Fixed target values for coupling constant. <i></i></div></div>=-1,1 <div class="tooltip">RAMP<div class="right">( default=off ) Slowly increase bias constant to a fixed value <i></i></div></div> <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=50000 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <span style="display:none;" id="eg3longeds">The EDS action with label <b>eds</b><hr  />
<p> A restart file can be added to dump information needed to restart/continue simulation using these parameters every PERIOD. </p>
<div style="width: 80%; float:left" id="value_details_eg4"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><button type="button" id="eg4_button" onclick='swapInput("eg4")'>contract shortcuts</button></div><div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><div style="width: 100%; float:left" id="input_eg4"></div>
<pre style="width: 97%;" class="fragment"></pre>
<script type="text/javascript">
if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', eg4Load, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', eg4Load);
}
function eg4Load(event) {
       swapInput("eg4");
}
</script>
<div style="display:none;" id="eg4short">
<pre style="width: 97%;" class="fragment">
<b name="eg4shortdist" onclick='showPath("eg4","eg4shortdist")'>dist: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg4shortdist">The DISTANCE action with label <b>dist</b> calculates a single scalar value</span>
<b name="eg4shortdist2" onclick='showPath("eg4","eg4shortdist2")'>dist2: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_c_o_m_b_i_n_e.html" style="color:green">COMBINE</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the values input to this function <i></i></div></div>=<b name="eg4shortdist">dist</b> <div class="tooltip">POWERS<div class="right"><b>compulsory keyword ( default=1.0 )</b>
the powers to which you are raising each of the arguments in your function <i></i></div></div>=2 <div class="tooltip">PERIODIC<div class="right"><b>compulsory keyword </b>
if the output of your function is periodic then you should specify the periodicity
of the function. <i></i></div></div>=NO <span style="display:none;" id="eg4shortdist2">The COMBINE action with label <b>dist2</b> calculates a single scalar value</span>
<span style="color:blue"># add the option to write to a restart file</span>
<b name="eg4shorteds" onclick='showPath("eg4","eg4shorteds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg4shortdist">dist</b>,<b name="eg4shortdist2">dist2</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0,1.0 <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=100 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <div class="tooltip">OUT_RESTART<div class="right">Output file for all information needed to continue EDS simulation. <i></i></div></div>=checkpoint.eds <span style="display:none;" id="eg4shorteds">The EDS action with label <b>eds</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">eds.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">eds.force2</td><td>squared value of force from the bias</td></tr>
<tr><td width="5%%">eds.dist_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist</td></tr>
<tr><td width="5%%">eds.dist2_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named dist2</td></tr>
</table>
</span>
</pre>
</div>
<div style="display:none;" id="eg4long"><pre style="width: 97%;" class="fragment">
<b name="eg4longdist" onclick='showPath("eg4","eg4longdist")'>dist: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg4longdist">The DISTANCE action with label <b>dist</b> calculates a single scalar value</span>
<span style="color:blue"># add the option to write to a restart file</span>
<b name="eg4longeds" onclick='showPath("eg4","eg4longeds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg4longdist">dist</b>,dist2 <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0,1.0 <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=100 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <div class="tooltip">OUT_RESTART<div class="right">Output file for all information needed to continue EDS simulation. <i></i></div></div>=checkpoint.eds <span style="display:none;" id="eg4longeds">The EDS action with label <b>eds</b><p>The first few lines of the restart file that is output if we run a calculation with one CV will look something like this:</p>
<pre class="fragment">#! FIELDS time d1_center d1_set d1_target d1_coupling d1_maxrange d1_maxgrad d1_accum d1_mean d1_std
#! SET adaptive  1
#! SET update_period  1
#! SET seed  0
#! SET kbt    2.4943
   0.0000   1.0000   0.0000   0.0000   0.0000   7.4830   0.1497   0.0000   0.0000   0.0000
   1.0000   1.0000   0.0000   0.0000   0.0000   7.4830   0.1497   0.0000   0.0000   0.0000
   2.0000   1.0000  -7.4830   0.0000   0.0000   7.4830   0.1497   0.0224   0.0000   0.0000
   3.0000   1.0000  -7.4830   0.0000  -7.4830   7.4830   0.1497   0.0224   0.0000   0.0000
   4.0000   1.0000  -7.4830   0.0000  -7.4830   7.4830   0.1497   0.0224   0.0000   0.0000
</pre><hr  />
<p>Read in a previous restart file. Adding RESTART flag makes output append </p>
<div style="width: 90%; float:left" id="value_details_eg5"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg5d1" onclick='showPath("eg5","eg5d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg5d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg5eds" onclick='showPath("eg5","eg5eds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg5d1">d1</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0 <div class="tooltip">PERIOD<div class="right">Steps over which to adjust bias for adaptive or ramping <i></i></div></div>=100 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <div class="tooltip">IN_RESTART<div class="right">Read this file to continue an EDS simulation. <i></i></div></div>=restart.eds <div class="tooltip">RESTART<div class="right">allows per-action setting of restart (YES/NO/AUTO) <i></i></div></div>=YES <span style="display:none;" id="eg5eds">The EDS action with label <b>eds</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">eds.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">eds.force2</td><td>squared value of force from the bias</td></tr>
<tr><td width="5%%">eds.d1_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named d1</td></tr>
</table>
</span>
</pre>
<hr  />
<p>Read in a previous restart file and freeze the bias at the final level from the previous simulation </p>
<div style="width: 90%; float:left" id="value_details_eg6"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg6d1" onclick='showPath("eg6","eg6d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg6d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg6eds" onclick='showPath("eg6","eg6eds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg6d1">d1</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <div class="tooltip">IN_RESTART<div class="right">Read this file to continue an EDS simulation. <i></i></div></div>=restart.eds <div class="tooltip">FREEZE<div class="right">( default=off ) Fix bias at current level (only used for restarting). <i></i></div></div> <span style="display:none;" id="eg6eds">The EDS action with label <b>eds</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">eds.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">eds.force2</td><td>squared value of force from the bias</td></tr>
<tr><td width="5%%">eds.d1_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named d1</td></tr>
</table>
</span>
</pre>
<hr  />
<p>Read in a previous restart file and freeze the bias at the mean from the previous simulation </p>
<div style="width: 90%; float:left" id="value_details_eg7"> Click on the labels of the actions for more information on what each action computes </div>
<div style="width: 10%; float:left"><img src="https://img.shields.io/badge/master-passing-green.svg" alt="tested on master" /></div><pre style="width: 97%;" class="fragment">
<b name="eg7d1" onclick='showPath("eg7","eg7d1")'>d1: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> <div class="tooltip">ATOMS<div class="right">the pair of atom that we are calculating the distance between. <i></i></div></div>=1,2 <span style="display:none;" id="eg7d1">The DISTANCE action with label <b>d1</b> calculates a single scalar value</span>
<b name="eg7eds" onclick='showPath("eg7","eg7eds")'>eds: </b><a href="https://www.plumed.org/doc-master/user-doc/html/_e_d_s.html" style="color:green">EDS</a> <div class="tooltip">ARG<div class="right"><b>compulsory keyword </b>
the labels of the scalars on which the bias will act <i></i></div></div>=<b name="eg7d1">d1</b> <div class="tooltip">CENTER<div class="right">The desired centers (equilibrium values) which will be sought during the adaptive
linear biasing. <i></i></div></div>=2.0 <div class="tooltip">TEMP<div class="right">The system temperature. <i></i></div></div>=1.0 <div class="tooltip">IN_RESTART<div class="right">Read this file to continue an EDS simulation. <i></i></div></div>=restart.eds <div class="tooltip">FREEZE<div class="right">( default=off ) Fix bias at current level (only used for restarting). <i></i></div></div> <div class="tooltip">MEAN<div class="right">( default=off ) Instead of using final bias level from restart, use average. <i></i></div></div> <span style="display:none;" id="eg7eds">The EDS action with label <b>eds</b> calculates the following quantities:
<table  align="center" frame="void" width="95%%" cellpadding="5%%">
<tr><td width="5%%"><b> Quantity </b>  </td><td><b> Description </b> </td></tr>
<tr><td width="5%%">eds.bias</td><td>the instantaneous value of the bias potential</td></tr>
<tr><td width="5%%">eds.force2</td><td>squared value of force from the bias</td></tr>
<tr><td width="5%%">eds.d1_coupling</td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor. This particular component measures this quantity for the input CV named d1</td></tr>
</table>
</span>
</pre>
<dl class="section user"><dt>Glossary of keywords and components</dt><dd></dd></dl>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> force2 </b> </td><td>squared value of force from the bias   </td></tr>
<tr>
<td width="15%"><b> pressure </b> </td><td>If using virial keyword, this is the current sum of virial terms. It is in units of pressure (energy / vol^3)   </td></tr>
<tr>
<td width="15%"><b> _coupling </b> </td><td>For each named CV biased, there will be a corresponding output CV_coupling storing the current linear bias prefactor.   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ARG </b> </td><td>the labels of the scalars on which the bias will act   </td></tr>
<tr>
<td width="15%"><b> RANGE </b> </td><td>( default=25.0 ) The (starting) maximum increase in coupling constant per PERIOD (in k_B T/[BIAS_SCALE unit]) for each CV biased   </td></tr>
<tr>
<td width="15%"><b> SEED </b> </td><td>( default=0 ) Seed for random order of changing bias   </td></tr>
<tr>
<td width="15%"><b> INIT </b> </td><td>( default=0 ) Starting value for coupling constant   </td></tr>
<tr>
<td width="15%"><b> FIXED </b> </td><td>( default=0 ) Fixed target values for coupling constant. Non-adaptive.   </td></tr>
<tr>
<td width="15%"><b> LM_MIXING </b> </td><td>( default=1 ) Initial mixing parameter when using Levenberg-Marquadt minimization.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> LM </b> </td><td>( default=off ) Use Levenberg-Marquadt algorithm along with simultaneous keyword. Otherwise use gradient descent.   </td></tr>
<tr>
<td width="15%"><b> RAMP </b> </td><td>( default=off ) Slowly increase bias constant to a fixed value   </td></tr>
<tr>
<td width="15%"><b> COVAR </b> </td><td>( default=off ) Utilize the covariance matrix when updating the bias. Default Off, but may be enabled due to other options   </td></tr>
<tr>
<td width="15%"><b> FREEZE </b> </td><td>( default=off ) Fix bias at current level (only used for restarting).   </td></tr>
<tr>
<td width="15%"><b> MEAN </b> </td><td><p class="starttd">( default=off ) Instead of using final bias level from restart, use average. Can only be used in conjunction with FREEZE  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> CENTER </b> </td><td>The desired centers (equilibrium values) which will be sought during the adaptive linear biasing. This is for fixed centers   </td></tr>
<tr>
<td width="15%"><b> CENTER_ARG </b> </td><td>The desired centers (equilibrium values) which will be sought during the adaptive linear biasing. CENTER_ARG is for calculated centers, e.g. from a CV or analysis.   </td></tr>
<tr>
<td width="15%"><b> PERIOD </b> </td><td>Steps over which to adjust bias for adaptive or ramping   </td></tr>
<tr>
<td width="15%"><b> BIAS_SCALE </b> </td><td>A divisor to set the units of the bias. If not set, this will be the CENTER value by default (as is done in White and Voth 2014).   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>The system temperature. If not provided will be taken from MD code (if available)   </td></tr>
<tr>
<td width="15%"><b> MULTI_PROP </b> </td><td>What proportion of dimensions to update at each step. Must be in interval [1,0), where 1 indicates all and any other indicates a stochastic update. If not set, default is 1 / N, where N is the number of CVs.   </td></tr>
<tr>
<td width="15%"><b> VIRIAL </b> </td><td>Add an update penalty for having non-zero virial contributions. Only makes sense with multiple correlated CVs.   </td></tr>
<tr>
<td width="15%"><b> LOGWEIGHTS </b> </td><td>Add weights to use for computing statistics. For example, if biasing with metadynamics.   </td></tr>
<tr>
<td width="15%"><b> RESTART_FMT </b> </td><td>the format that should be used to output real numbers in EDS restarts   </td></tr>
<tr>
<td width="15%"><b> OUT_RESTART </b> </td><td>Output file for all information needed to continue EDS simulation. If you have the RESTART directive set (global or for EDS), this file will be appended to. Note that the header will be printed again if appending.   </td></tr>
<tr>
<td width="15%"><b> IN_RESTART </b> </td><td>Read this file to continue an EDS simulation. If same as OUT_RESTART and you have not set the RESTART directive, the file will be backed-up and overwritten with new output. If you do have the RESTART flag set and it is the same name as OUT_RESTART, this file will be appended.   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_e_d_s_m_o_d.html">Experiment Directed Simulation</a></li><li class="navelem"><a class="el" href="_e_d_s_m_o_d_bias.html">Biases Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
