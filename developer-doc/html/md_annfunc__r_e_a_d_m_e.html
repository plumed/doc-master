<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<title>PLUMED: ANN (Artificial Neural Network) function for plumed</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../user-doc/html/index.html"> <img src="developer-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ANN (Artificial Neural Network) function for plumed </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is plumed ANN function (annfunc) module. It implements <code>ANN</code> class, which is a subclass of <code>Function</code> class. <code>ANN</code> class takes multi-dimensional arrays as inputs for a fully-connected feedforward neural network with specified neural network weights and generates corresponding outputs. The <code>ANN</code> outputs can be used as collective variables, inputs for other collective variables, or inputs for data analysis tools. <br  />
</p>
<h1>Installation</h1>
<p>Enable compilation by adding the <code>--enable-modules=annfunc</code> to the configure command.</p>
<h1>Usage</h1>
<p>It is used in a similar way to <a href="https://www.plumed.org/doc-v2.5/user-doc/html/_function.html">other plumed functions</a>. To define an <code>ANN</code> function object, we need to define following keywords:</p>
<ul>
<li><code>ARG</code> (string array): input variable names for the fully-connected feedforward neural network</li>
<li><code>NUM_LAYERS</code> (int): number of layers for the neural network</li>
<li><code>NUM_NODES</code> (int array): number of nodes in all layers of the neural network</li>
<li><code>ACTIVATIONS</code> (string array): types of activation functions of layers, currently we have implemented "Linear", "Tanh", "Circular" layers, it should be straightforward to add other types as well</li>
<li><code>WEIGHTS</code> (numbered keyword, double array): this is a numbered keyword, <code>WEIGHTS0</code> represents flattened weight array connecting layer 0 and layer 1, <code>WEIGHTS1</code> represents flattened weight array connecting layer 1 and layer 2, ... An example is given in the next section.</li>
<li><code>BIASES</code> (numbered keyword, double array): this is a numbered keyword, BIASES0 represents bias array for layer 1, BIASES1 represents bias array for layer 2, ...</li>
</ul>
<p>Assuming we have an <code>ANN</code> function object named <code>ann</code>, we use <code>ann.node-0, ann.node-1, ...</code> to access component 0, 1, ... of its outputs (used as collective variables, inputs for other collective variables, or data analysis tools).</p>
<h1>Examples</h1>
<p>Assume we have an ANN with numbers of nodes being [2, 3, 1], and weights connecting layer 0 and 1 are</p>
<div class="fragment"><div class="line">[[1,2],</div>
<div class="line">[3,4],</div>
<div class="line">[5,6]]</div>
</div><!-- fragment --><p>weights connecting layer 1 and 2 are</p>
<div class="fragment"><div class="line">[[7,8,9]]</div>
</div><!-- fragment --><p>Bias for layer 1 and 2 are</p>
<div class="fragment"><div class="line">[10, 11, 12]</div>
</div><!-- fragment --><p>and</p>
<div class="fragment"><div class="line">[13]</div>
</div><!-- fragment --><p>respectively.</p>
<p>All activation functions are <code>Tanh</code>.</p>
<p>Then if input variables are <code>l_0_out_0, l_0_out_1</code>, the corresponding <code>ANN</code> function object can be defined using following plumed script:</p>
<div class="fragment"><div class="line">ann: ANN ARG=l_0_out_0,l_0_out_1 NUM_LAYERS=3 NUM_NODES=2,3,1 ACTIVATIONS=Tanh,Tanh  WEIGHTS0=1,2,3,4,5,6 WEIGHTS1=7,8,9  BIASES0=10,11,12 BIASES1=13</div>
</div><!-- fragment --><p>This plumed script can be generated with function <code>Plumed_helper.get_ANN_expression()</code> in <a href="https://github.com/weiHelloWorld/plumed_helper/blob/master/plumed_helper.py">this</a> repository. Following is the Python code using this function to generate the script above:</p>
<div class="fragment"><div class="line">from plumed_helper import Plumed_helper</div>
<div class="line">ANN_weights = [np.array([1,2,3,4,5,6]), np.array([7,8,9])]</div>
<div class="line">ANN_bias = [np.array([10, 11, 12]), np.array([13])]</div>
<div class="line">Plumed_helper.get_ANN_expression(&#39;ANN&#39;, node_num=[2, 3, 1], </div>
<div class="line">                                 ANN_weights=ANN_weights, ANN_bias=ANN_bias,</div>
<div class="line">                                 activation_list=[&#39;Tanh&#39;, &#39;Tanh&#39;])</div>
</div><!-- fragment --><h1>Authors</h1>
<p>Wei Chen (UIUC, <a href="#" onclick="location.href='mai'+'lto:'+'wei'+'ch'+'en9'+'@i'+'lli'+'no'+'is.'+'ed'+'u'; return false;">weich<span style="display: none;">.nosp@m.</span>en9@<span style="display: none;">.nosp@m.</span>illin<span style="display: none;">.nosp@m.</span>ois.<span style="display: none;">.nosp@m.</span>edu</a>) and Andrew Ferguson (University of Chicago, <a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'wfe'+'rg'+'uso'+'n@'+'uch'+'ic'+'ago'+'.e'+'du'; return false;">andre<span style="display: none;">.nosp@m.</span>wfer<span style="display: none;">.nosp@m.</span>guson<span style="display: none;">.nosp@m.</span>@uch<span style="display: none;">.nosp@m.</span>icago<span style="display: none;">.nosp@m.</span>.edu</a>)</p>
<h1>Copyright</h1>
<p>See ./COPYRIGHT </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<table align="center" frame="void" width="98%" cellpadding="2%">
<tr><td align="left" valign="center"> 
Hosted by GitHub &nbsp;
<a href="http://github.com"><img src="octocat.png" width="88" height="66"  alt="GitHub Logo" /></a>
<!--Generated by  &#160; --> <a href="http://www.doxygen.org/index.html">
</td><td width=90% align="right">
<img class="footer" src="doxygen.png" alt="doxygen" align="right"/>
</a> 1.8.17
</td> </tr> 
</table>
</small></address>
</body>
</html>
